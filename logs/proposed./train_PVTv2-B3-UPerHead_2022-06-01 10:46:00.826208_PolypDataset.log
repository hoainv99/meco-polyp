2022-06-01 10:46:00.830 | INFO     | __main__:main:47 - Load config from configs/proposed.yaml
2022-06-01 10:46:00.830 | INFO     | __main__:main:48 - {'dataset': {'data_path': '/home/admin_mcn/hungpv/polyps/dataset/KCECE', 'train_data_path': ['/home/admin_mcn/hungpv/polyps/dataset/KCECE/TrainDataset'], 'test_data_path': ['/home/admin_mcn/hungpv/polyps/dataset/KCECE/TestDataset/CVC-ClinicDB'], 'val_data_path': ['/home/admin_mcn/hungpv/polyps/dataset/KCECE/TestDataset/CVC-300']}, 'model': {'num_classes': 1, 'save_dir': '/mnt/data/hungpv/polyps/checkpoint/KCECE/proposed_v4', 'backbone': 'PVTv2-B3', 'head': 'UPerHead', 'pretrained': '/mnt/data/hungpv/polyps/pretrained-backbone/pvt_v2_b3.pth'}, 'optimizer': {'name': 'adam', 'lr': 0.0001, 'clip': 0.5, 'scheduler': 'cosine_warmup', 'loss': 'structure_ssim_loss'}, 'dev': 'cuda', 'train': {'start_from': 0, 'save_from': 79, 'num_epochs': 80, 'num_warmup_epoch': 10, 'is_val': False, 'size_rates': [0.75, 1, 1.25], 'dataloader': {'batchsize': 16, 'img_size': 352, 'shuffle': True, 'num_workers': 2, 'pin_memory': True, 'drop_last': True}, 'amp': False, 'ddp': False, 'augment': {'prob': 1, 'Flip_prob': 0.5, 'HueSaturationValue_prob': 0.5, 'RandomBrightnessContrast_prob': 0.5, 'crop_prob': 0.0, 'randomrotate90_prob': 0.5}}, 'test': {'dev': 'cuda', 'visualize': False, 'visualize_dir': '/mnt/data/hungpv/polyps/visualize', 'vis_x': 180, 'vis_overwrite': False, 'checkpoint_dir': '/mnt/data/hungpv/polyps/checkpoint/KCECE/proposed_v7/PVTv2-B3-UPerHead_80.pth', 'dataloader': {'batchsize': 1, 'img_size': 352, 'shuffle': True, 'num_workers': 2, 'pin_memory': True, 'drop_last': True}, 'augment': {'prob': 1, 'Flip_prob': 0, 'HueSaturationValue_prob': 0, 'RandomBrightnessContrast_prob': 0, 'crop_prob': 0, 'randomrotate90_prob': 0, 'elastictransform_prob': 0, 'gridistortion_prob': 0, 'opticaldistortion_prob': 0, 'verticalflip_prob': 0, 'horizontalflip_prob': 0, 'randomgamma_prob': 0, 'CoarseDropout_prob': 0, 'RGBShift_prob': 0, 'MotionBlur_prob': 0, 'MedianBlur_prob': 0, 'GaussianBlur_prob': 0, 'GaussNoise_prob': 0, 'ChannelShuffle_prob': 0}}}
2022-06-01 10:46:00.830 | INFO     | __main__:main:49 - Getting datapath
2022-06-01 10:46:00.835 | INFO     | __main__:main:63 - There are 1450 images to train
2022-06-01 10:46:00.835 | INFO     | __main__:main:82 - Train model with no valid dataset
2022-06-01 10:46:00.835 | INFO     | __main__:main:84 - Loading data
2022-06-01 10:46:01.218 | INFO     | __main__:main:98 - 90 batches to train
2022-06-01 10:46:01.234 | INFO     | __main__:main:111 - Loading model
2022-06-01 10:46:01.234 | INFO     | __main__:main:132 - Loading checkpoint from /mnt/data/hungpv/polyps/pretrained-backbone/pvt_v2_b3.pth ...
2022-06-01 10:46:05.780 | INFO     | __main__:main:175 - Training with FP32 ...
2022-06-01 10:50:04.314 | INFO     | tools.trainer:train_loop:103 - Epoch: [1/ 80] | Train loss: [3.00676159063975]
2022-06-01 10:54:18.887 | INFO     | tools.trainer:train_loop:103 - Epoch: [2/ 80] | Train loss: [1.0514275782638125]
2022-06-01 10:58:36.007 | INFO     | tools.trainer:train_loop:103 - Epoch: [3/ 80] | Train loss: [0.809331970082389]
2022-06-01 10:58:36.216 | INFO     | tools.trainer:train_loop:115 - [Saving Snapshot:]/mnt/data/hungpv/polyps/checkpoint/KCECE/proposed_v4/PVTv2-B3-UPerHead_3.pth
2022-06-01 11:02:51.909 | INFO     | tools.trainer:train_loop:103 - Epoch: [4/ 80] | Train loss: [0.6644936909278234]
2022-06-01 11:07:14.964 | INFO     | tools.trainer:train_loop:103 - Epoch: [5/ 80] | Train loss: [0.5372976505094105]
2022-06-01 11:11:34.721 | INFO     | tools.trainer:train_loop:103 - Epoch: [6/ 80] | Train loss: [0.4518570158216688]
2022-06-01 11:15:55.529 | INFO     | tools.trainer:train_loop:103 - Epoch: [7/ 80] | Train loss: [0.40158662762906816]
2022-06-01 11:20:13.562 | INFO     | tools.trainer:train_loop:103 - Epoch: [8/ 80] | Train loss: [0.35509502788384756]
2022-06-01 11:24:27.111 | INFO     | tools.trainer:train_loop:103 - Epoch: [9/ 80] | Train loss: [0.3282472516099612]
2022-06-01 11:28:39.808 | INFO     | tools.trainer:train_loop:103 - Epoch: [10/ 80] | Train loss: [0.4817848415838348]
2022-06-01 11:32:55.091 | INFO     | tools.trainer:train_loop:103 - Epoch: [11/ 80] | Train loss: [0.391976378692521]
2022-06-01 11:37:14.061 | INFO     | tools.trainer:train_loop:103 - Epoch: [12/ 80] | Train loss: [0.33792872544791963]
2022-06-01 11:41:30.445 | INFO     | tools.trainer:train_loop:103 - Epoch: [13/ 80] | Train loss: [0.3077601497371992]
2022-06-01 11:45:49.303 | INFO     | tools.trainer:train_loop:103 - Epoch: [14/ 80] | Train loss: [0.29117072456412846]
2022-06-01 11:50:08.381 | INFO     | tools.trainer:train_loop:103 - Epoch: [15/ 80] | Train loss: [0.2697649445798662]
2022-06-01 11:54:26.149 | INFO     | tools.trainer:train_loop:103 - Epoch: [16/ 80] | Train loss: [0.257807435757584]
2022-06-01 11:58:47.562 | INFO     | tools.trainer:train_loop:103 - Epoch: [17/ 80] | Train loss: [0.25437015609608754]
2022-06-01 12:03:08.116 | INFO     | tools.trainer:train_loop:103 - Epoch: [18/ 80] | Train loss: [0.2536851258741485]
2022-06-01 12:07:31.176 | INFO     | tools.trainer:train_loop:103 - Epoch: [19/ 80] | Train loss: [0.2467467521627744]
2022-06-01 12:11:54.685 | INFO     | tools.trainer:train_loop:103 - Epoch: [20/ 80] | Train loss: [0.2437547352578905]
2022-06-01 12:16:12.523 | INFO     | tools.trainer:train_loop:103 - Epoch: [21/ 80] | Train loss: [0.23838291350338195]
2022-06-01 12:20:33.987 | INFO     | tools.trainer:train_loop:103 - Epoch: [22/ 80] | Train loss: [0.21595841662751303]
2022-06-01 12:24:56.030 | INFO     | tools.trainer:train_loop:103 - Epoch: [23/ 80] | Train loss: [0.2310143286983172]
2022-06-01 12:29:19.054 | INFO     | tools.trainer:train_loop:103 - Epoch: [24/ 80] | Train loss: [0.21916218747695287]
2022-06-01 12:33:42.235 | INFO     | tools.trainer:train_loop:103 - Epoch: [25/ 80] | Train loss: [0.2046015022529496]
2022-06-01 12:38:06.446 | INFO     | tools.trainer:train_loop:103 - Epoch: [26/ 80] | Train loss: [0.1988676736752192]
2022-06-01 12:42:31.836 | INFO     | tools.trainer:train_loop:103 - Epoch: [27/ 80] | Train loss: [0.3758339234524303]
2022-06-01 12:46:54.329 | INFO     | tools.trainer:train_loop:103 - Epoch: [28/ 80] | Train loss: [0.2637599622209867]
2022-06-01 12:51:22.292 | INFO     | tools.trainer:train_loop:103 - Epoch: [29/ 80] | Train loss: [0.24015016622013516]
2022-06-01 12:55:40.956 | INFO     | tools.trainer:train_loop:103 - Epoch: [30/ 80] | Train loss: [0.22081169469488993]
2022-06-01 12:59:55.985 | INFO     | tools.trainer:train_loop:103 - Epoch: [31/ 80] | Train loss: [0.2132036084930102]
2022-06-01 13:04:12.875 | INFO     | tools.trainer:train_loop:103 - Epoch: [32/ 80] | Train loss: [0.21688972562551498]
2022-06-01 13:08:29.302 | INFO     | tools.trainer:train_loop:103 - Epoch: [33/ 80] | Train loss: [0.19921172360579173]
2022-06-01 13:12:50.918 | INFO     | tools.trainer:train_loop:103 - Epoch: [34/ 80] | Train loss: [0.20525578930974006]
2022-06-01 13:17:13.748 | INFO     | tools.trainer:train_loop:103 - Epoch: [35/ 80] | Train loss: [0.18876054767105316]
2022-06-01 13:21:40.263 | INFO     | tools.trainer:train_loop:103 - Epoch: [36/ 80] | Train loss: [0.19168942670027414]
2022-06-01 13:26:02.723 | INFO     | tools.trainer:train_loop:103 - Epoch: [37/ 80] | Train loss: [0.18694668196969563]
2022-06-01 13:30:23.109 | INFO     | tools.trainer:train_loop:103 - Epoch: [38/ 80] | Train loss: [0.18442706962426503]
2022-06-01 13:34:46.233 | INFO     | tools.trainer:train_loop:103 - Epoch: [39/ 80] | Train loss: [0.20524571223391427]
2022-06-01 13:39:09.968 | INFO     | tools.trainer:train_loop:103 - Epoch: [40/ 80] | Train loss: [0.1871338688664966]
2022-06-01 13:43:32.725 | INFO     | tools.trainer:train_loop:103 - Epoch: [41/ 80] | Train loss: [0.17872655441363652]
2022-06-01 13:47:50.290 | INFO     | tools.trainer:train_loop:103 - Epoch: [42/ 80] | Train loss: [0.20552679838405716]
2022-06-01 13:52:10.303 | INFO     | tools.trainer:train_loop:103 - Epoch: [43/ 80] | Train loss: [0.19425650752253001]
2022-06-01 13:56:27.575 | INFO     | tools.trainer:train_loop:103 - Epoch: [44/ 80] | Train loss: [0.17954508711894354]
2022-06-01 14:00:45.857 | INFO     | tools.trainer:train_loop:103 - Epoch: [45/ 80] | Train loss: [0.17454024387730493]
2022-06-01 14:05:09.594 | INFO     | tools.trainer:train_loop:103 - Epoch: [46/ 80] | Train loss: [0.1775175578892231]
2022-06-01 14:09:30.130 | INFO     | tools.trainer:train_loop:103 - Epoch: [47/ 80] | Train loss: [0.16735881260699695]
2022-06-01 14:13:49.511 | INFO     | tools.trainer:train_loop:103 - Epoch: [48/ 80] | Train loss: [0.16088692910141414]
2022-06-01 14:17:59.593 | INFO     | tools.trainer:train_loop:103 - Epoch: [49/ 80] | Train loss: [0.16737143165535398]
2022-06-01 14:22:17.236 | INFO     | tools.trainer:train_loop:103 - Epoch: [50/ 80] | Train loss: [0.1622786389456855]
2022-06-01 14:26:37.785 | INFO     | tools.trainer:train_loop:103 - Epoch: [51/ 80] | Train loss: [0.15672438393036525]
2022-06-01 14:30:50.901 | INFO     | tools.trainer:train_loop:103 - Epoch: [52/ 80] | Train loss: [0.15201648101210594]
2022-06-01 14:35:12.117 | INFO     | tools.trainer:train_loop:103 - Epoch: [53/ 80] | Train loss: [0.17647392079234123]
2022-06-01 14:39:28.963 | INFO     | tools.trainer:train_loop:103 - Epoch: [54/ 80] | Train loss: [0.21075999190409977]
2022-06-01 14:43:47.960 | INFO     | tools.trainer:train_loop:103 - Epoch: [55/ 80] | Train loss: [0.16710213058524662]
2022-06-01 14:47:59.658 | INFO     | tools.trainer:train_loop:103 - Epoch: [56/ 80] | Train loss: [0.16074303612113]
2022-06-01 14:52:10.923 | INFO     | tools.trainer:train_loop:103 - Epoch: [57/ 80] | Train loss: [0.1549050337738461]
2022-06-01 14:56:29.896 | INFO     | tools.trainer:train_loop:103 - Epoch: [58/ 80] | Train loss: [0.15490295878714985]
2022-06-01 15:00:50.296 | INFO     | tools.trainer:train_loop:103 - Epoch: [59/ 80] | Train loss: [0.14687599448694122]
2022-06-01 15:05:16.924 | INFO     | tools.trainer:train_loop:103 - Epoch: [60/ 80] | Train loss: [0.1459454237586922]
2022-06-01 15:09:40.609 | INFO     | tools.trainer:train_loop:103 - Epoch: [61/ 80] | Train loss: [0.1475502409040928]
2022-06-01 15:14:04.886 | INFO     | tools.trainer:train_loop:103 - Epoch: [62/ 80] | Train loss: [0.14364491270648108]
2022-06-01 15:18:20.016 | INFO     | tools.trainer:train_loop:103 - Epoch: [63/ 80] | Train loss: [0.14132735398080615]
2022-06-01 15:22:30.644 | INFO     | tools.trainer:train_loop:103 - Epoch: [64/ 80] | Train loss: [0.1423929903242323]
2022-06-01 15:26:45.780 | INFO     | tools.trainer:train_loop:103 - Epoch: [65/ 80] | Train loss: [0.1406744458609157]
2022-06-01 15:31:03.688 | INFO     | tools.trainer:train_loop:103 - Epoch: [66/ 80] | Train loss: [0.13796867214971117]
2022-06-01 15:35:20.359 | INFO     | tools.trainer:train_loop:103 - Epoch: [67/ 80] | Train loss: [0.13603070982628399]
2022-06-01 15:39:42.031 | INFO     | tools.trainer:train_loop:103 - Epoch: [68/ 80] | Train loss: [0.14321405068039894]
2022-06-01 15:44:05.269 | INFO     | tools.trainer:train_loop:103 - Epoch: [69/ 80] | Train loss: [0.13708170246746804]
2022-06-01 15:48:32.976 | INFO     | tools.trainer:train_loop:103 - Epoch: [70/ 80] | Train loss: [0.13527975529432296]
2022-06-01 15:53:02.189 | INFO     | tools.trainer:train_loop:103 - Epoch: [71/ 80] | Train loss: [0.13538626846339968]
2022-06-01 15:57:31.538 | INFO     | tools.trainer:train_loop:103 - Epoch: [72/ 80] | Train loss: [0.1326122298836708]
2022-06-01 16:01:54.388 | INFO     | tools.trainer:train_loop:103 - Epoch: [73/ 80] | Train loss: [0.13232388645410537]
2022-06-01 16:06:22.700 | INFO     | tools.trainer:train_loop:103 - Epoch: [74/ 80] | Train loss: [0.12993491921159955]
2022-06-01 16:10:54.351 | INFO     | tools.trainer:train_loop:103 - Epoch: [75/ 80] | Train loss: [0.13058952763676643]
2022-06-01 16:15:21.154 | INFO     | tools.trainer:train_loop:103 - Epoch: [76/ 80] | Train loss: [0.12867803929580582]
2022-06-01 16:19:50.123 | INFO     | tools.trainer:train_loop:103 - Epoch: [77/ 80] | Train loss: [0.12819810128874248]
2022-06-01 16:24:18.200 | INFO     | tools.trainer:train_loop:103 - Epoch: [78/ 80] | Train loss: [0.1281950725449456]
2022-06-01 16:28:46.133 | INFO     | tools.trainer:train_loop:103 - Epoch: [79/ 80] | Train loss: [0.1270873317288028]
2022-06-01 16:33:19.376 | INFO     | tools.trainer:train_loop:103 - Epoch: [80/ 80] | Train loss: [0.1270590058631367]
2022-06-01 16:33:19.580 | INFO     | tools.trainer:train_loop:115 - [Saving Snapshot:]/mnt/data/hungpv/polyps/checkpoint/KCECE/proposed_v4/PVTv2-B3-UPerHead_80.pth
2022-06-01 16:33:19.581 | INFO     | tools.trainer:train_loop:124 - Training cost: 20832.177623139927seconds
