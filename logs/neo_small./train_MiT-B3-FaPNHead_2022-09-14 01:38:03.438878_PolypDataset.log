2022-09-14 01:38:03.442 | INFO     | __main__:main:57 - Load config from configs/neo_small.yaml
2022-09-14 01:38:03.442 | INFO     | __main__:main:58 - {'dataset': {'data_path': '/home/s/hungpv/polyps/dataset', 'train_data_path': ['/home/s/hungpv/polyps/dataset/neo_small/train'], 'test_data_path': ['/home/s/hungpv/polyps/dataset/neo_small/test'], 'val_data_path': ['/home/s/hungpv/polyps/dataset/neo_small/test']}, 'model': {'num_classes': 3, 'save_dir': '/home/s/hungpv/polyps/checkpoint/neo/neo_small_v5', 'backbone': 'MiT-B3', 'head': 'FaPNHead', 'pretrained': '/home/s/hungpv/polyps/pretrained_models/mit_b3.pth'}, 'optimizer': {'name': 'adam', 'lr': 0.0001, 'clip': 0.5, 'scheduler': 'cosine_warmup', 'loss': 'multi_structure_loss'}, 'dev': 'cuda', 'train': {'start_from': 0, 'save_from': 79, 'num_epochs': 80, 'num_warmup_epoch': 8, 'is_val': False, 'size_rates': [0.75, 1, 1.25], 'dataloader': {'batchsize': 16, 'img_size': 384, 'shuffle': True, 'num_workers': 4, 'pin_memory': True, 'drop_last': True}, 'amp': False, 'ddp': False, 'augment': {'prob': 1, 'Flip_prob': 0.5, 'HueSaturationValue_prob': 0.5, 'RandomBrightnessContrast_prob': 0.5, 'crop_prob': 0.0, 'randomrotate90_prob': 0.5, 'ColorJitter_prob': 0.5}}, 'val': {'dataloader': {'batchsize': 8, 'img_size': 384, 'shuffle': True, 'num_workers': 4, 'pin_memory': True, 'drop_last': False}}, 'test': {'dev': 'cuda', 'visualize': True, 'visualize_dir': '/home/s/hungpv/polyps/neo_visualize', 'vis_x': 180, 'vis_overwrite': False, 'checkpoint_dir': '/home/s/hungpv/polyps/checkpoint/neo/neo_small_v4/MiT-B3-FaPNHead_80.pth', 'dataloader': {'batchsize': 1, 'img_size': 384, 'shuffle': True, 'num_workers': 4, 'pin_memory': True, 'drop_last': False}, 'augment': {'prob': 1, 'Flip_prob': 0, 'HueSaturationValue_prob': 0, 'RandomBrightnessContrast_prob': 0, 'crop_prob': 0, 'randomrotate90_prob': 0, 'elastictransform_prob': 0, 'gridistortion_prob': 0, 'opticaldistortion_prob': 0, 'verticalflip_prob': 0, 'horizontalflip_prob': 0, 'randomgamma_prob': 0, 'CoarseDropout_prob': 0, 'RGBShift_prob': 0, 'MotionBlur_prob': 0, 'MedianBlur_prob': 0, 'GaussianBlur_prob': 0, 'GaussNoise_prob': 0, 'ChannelShuffle_prob': 0}}}
2022-09-14 01:38:03.443 | INFO     | __main__:main:59 - Getting datapath
2022-09-14 01:38:03.448 | INFO     | __main__:main:74 - There are 1000 images to train
2022-09-14 01:38:03.449 | INFO     | __main__:main:93 - Train model with no valid dataset
2022-09-14 01:38:03.449 | INFO     | __main__:main:95 - Loading data
2022-09-14 01:38:03.531 | INFO     | __main__:main:109 - 62 batches to train
2022-09-14 01:38:03.531 | INFO     | __main__:main:122 - Loading model
2022-09-14 01:38:03.531 | INFO     | __main__:main:143 - Loading checkpoint from /home/s/hungpv/polyps/pretrained_models/mit_b3.pth ...
2022-09-14 01:38:06.702 | INFO     | __main__:main:187 - Training with FP32 ...
2022-09-14 01:39:38.672 | INFO     | tools.trainer:train_loop:126 - Epoch: [1/ 80] | Train loss: [2.3123945401560877]
2022-09-14 01:41:09.402 | INFO     | tools.trainer:train_loop:126 - Epoch: [2/ 80] | Train loss: [1.0105109666624377]
2022-09-14 01:42:40.378 | INFO     | tools.trainer:train_loop:126 - Epoch: [3/ 80] | Train loss: [0.7034079124850612]
2022-09-14 01:44:11.822 | INFO     | tools.trainer:train_loop:126 - Epoch: [4/ 80] | Train loss: [0.6135233861784781]
2022-09-14 01:45:45.207 | INFO     | tools.trainer:train_loop:126 - Epoch: [5/ 80] | Train loss: [0.5501150012977661]
2022-09-14 01:47:17.152 | INFO     | tools.trainer:train_loop:126 - Epoch: [6/ 80] | Train loss: [0.5231122667751005]
2022-09-14 01:48:48.686 | INFO     | tools.trainer:train_loop:126 - Epoch: [7/ 80] | Train loss: [0.4711937471743553]
2022-09-14 01:50:20.955 | INFO     | tools.trainer:train_loop:126 - Epoch: [8/ 80] | Train loss: [0.3542174367654708]
2022-09-14 01:51:54.856 | INFO     | tools.trainer:train_loop:126 - Epoch: [9/ 80] | Train loss: [0.32619861729683414]
2022-09-14 01:53:27.617 | INFO     | tools.trainer:train_loop:126 - Epoch: [10/ 80] | Train loss: [0.39393032774809866]
2022-09-14 01:55:01.130 | INFO     | tools.trainer:train_loop:126 - Epoch: [11/ 80] | Train loss: [0.31595224514603615]
2022-09-14 01:56:32.203 | INFO     | tools.trainer:train_loop:126 - Epoch: [12/ 80] | Train loss: [0.2965311391219016]
2022-09-14 01:58:05.860 | INFO     | tools.trainer:train_loop:126 - Epoch: [13/ 80] | Train loss: [0.2741346638048849]
2022-09-14 01:59:38.339 | INFO     | tools.trainer:train_loop:126 - Epoch: [14/ 80] | Train loss: [0.3629409032723596]
2022-09-14 02:01:10.579 | INFO     | tools.trainer:train_loop:126 - Epoch: [15/ 80] | Train loss: [0.3322865020844244]
2022-09-14 02:02:43.633 | INFO     | tools.trainer:train_loop:126 - Epoch: [16/ 80] | Train loss: [0.299855116153917]
2022-09-14 02:04:15.957 | INFO     | tools.trainer:train_loop:126 - Epoch: [17/ 80] | Train loss: [0.2869798598750945]
2022-09-14 02:05:48.218 | INFO     | tools.trainer:train_loop:126 - Epoch: [18/ 80] | Train loss: [0.26629171808881147]
2022-09-14 02:07:22.078 | INFO     | tools.trainer:train_loop:126 - Epoch: [19/ 80] | Train loss: [0.2688916072009071]
2022-09-14 02:08:56.070 | INFO     | tools.trainer:train_loop:126 - Epoch: [20/ 80] | Train loss: [0.2372425976059129]
2022-09-14 02:10:30.068 | INFO     | tools.trainer:train_loop:126 - Epoch: [21/ 80] | Train loss: [0.25710548448466486]
2022-09-14 02:12:03.585 | INFO     | tools.trainer:train_loop:126 - Epoch: [22/ 80] | Train loss: [0.22568555368531135]
2022-09-14 02:13:37.121 | INFO     | tools.trainer:train_loop:126 - Epoch: [23/ 80] | Train loss: [0.2260483093559742]
2022-09-14 02:15:09.493 | INFO     | tools.trainer:train_loop:126 - Epoch: [24/ 80] | Train loss: [0.19264337492565956]
2022-09-14 02:16:43.448 | INFO     | tools.trainer:train_loop:126 - Epoch: [25/ 80] | Train loss: [0.20396344435791816]
2022-09-14 02:18:16.599 | INFO     | tools.trainer:train_loop:126 - Epoch: [26/ 80] | Train loss: [0.2009810485666798]
2022-09-14 02:19:49.018 | INFO     | tools.trainer:train_loop:126 - Epoch: [27/ 80] | Train loss: [0.20741001636751236]
2022-09-14 02:21:21.257 | INFO     | tools.trainer:train_loop:126 - Epoch: [28/ 80] | Train loss: [0.1977464372832929]
2022-09-14 02:22:55.115 | INFO     | tools.trainer:train_loop:126 - Epoch: [29/ 80] | Train loss: [0.19330698431980226]
2022-09-14 02:24:28.735 | INFO     | tools.trainer:train_loop:126 - Epoch: [30/ 80] | Train loss: [0.17994669464326674]
2022-09-14 02:26:01.515 | INFO     | tools.trainer:train_loop:126 - Epoch: [31/ 80] | Train loss: [0.19503240719918283]
2022-09-14 02:27:34.908 | INFO     | tools.trainer:train_loop:126 - Epoch: [32/ 80] | Train loss: [0.18045749467226765]
2022-09-14 02:29:08.357 | INFO     | tools.trainer:train_loop:126 - Epoch: [33/ 80] | Train loss: [0.16983556158600316]
2022-09-14 02:30:41.550 | INFO     | tools.trainer:train_loop:126 - Epoch: [34/ 80] | Train loss: [0.16008737965697242]
2022-09-14 02:32:14.531 | INFO     | tools.trainer:train_loop:126 - Epoch: [35/ 80] | Train loss: [0.16847425404815905]
2022-09-14 02:33:49.028 | INFO     | tools.trainer:train_loop:126 - Epoch: [36/ 80] | Train loss: [0.17350013061396538]
2022-09-14 02:35:21.124 | INFO     | tools.trainer:train_loop:126 - Epoch: [37/ 80] | Train loss: [0.16403794919531192]
2022-09-14 02:36:55.289 | INFO     | tools.trainer:train_loop:126 - Epoch: [38/ 80] | Train loss: [0.15251623586781562]
2022-09-14 02:38:27.486 | INFO     | tools.trainer:train_loop:126 - Epoch: [39/ 80] | Train loss: [0.15472557203423593]
2022-09-14 02:40:01.311 | INFO     | tools.trainer:train_loop:126 - Epoch: [40/ 80] | Train loss: [0.15724707250633546]
2022-09-14 02:41:35.304 | INFO     | tools.trainer:train_loop:126 - Epoch: [41/ 80] | Train loss: [0.1474074575329019]
2022-09-14 02:43:07.248 | INFO     | tools.trainer:train_loop:126 - Epoch: [42/ 80] | Train loss: [0.14725155497510586]
2022-09-14 02:44:41.632 | INFO     | tools.trainer:train_loop:126 - Epoch: [43/ 80] | Train loss: [0.15965318163075753]
2022-09-14 02:46:15.014 | INFO     | tools.trainer:train_loop:126 - Epoch: [44/ 80] | Train loss: [0.14962796656595123]
2022-09-14 02:47:47.767 | INFO     | tools.trainer:train_loop:126 - Epoch: [45/ 80] | Train loss: [0.14250590405877558]
2022-09-14 02:49:22.084 | INFO     | tools.trainer:train_loop:126 - Epoch: [46/ 80] | Train loss: [0.13565995351922128]
2022-09-14 02:50:56.386 | INFO     | tools.trainer:train_loop:126 - Epoch: [47/ 80] | Train loss: [0.12223275522551229]
2022-09-14 02:52:29.957 | INFO     | tools.trainer:train_loop:126 - Epoch: [48/ 80] | Train loss: [0.12697840439936808]
2022-09-14 02:54:04.097 | INFO     | tools.trainer:train_loop:126 - Epoch: [49/ 80] | Train loss: [0.12823324253962887]
2022-09-14 02:55:38.023 | INFO     | tools.trainer:train_loop:126 - Epoch: [50/ 80] | Train loss: [0.1363582710825628]
2022-09-14 02:57:11.369 | INFO     | tools.trainer:train_loop:126 - Epoch: [51/ 80] | Train loss: [0.12393416260038653]
2022-09-14 02:58:44.894 | INFO     | tools.trainer:train_loop:126 - Epoch: [52/ 80] | Train loss: [0.11358104279685405]
2022-09-14 03:00:17.642 | INFO     | tools.trainer:train_loop:126 - Epoch: [53/ 80] | Train loss: [0.11846923888210327]
2022-09-14 03:01:52.690 | INFO     | tools.trainer:train_loop:126 - Epoch: [54/ 80] | Train loss: [0.11267001968958686]
2022-09-14 03:03:25.163 | INFO     | tools.trainer:train_loop:126 - Epoch: [55/ 80] | Train loss: [0.11087152265733288]
2022-09-14 03:04:58.357 | INFO     | tools.trainer:train_loop:126 - Epoch: [56/ 80] | Train loss: [0.10154992780618129]
2022-09-14 03:06:31.438 | INFO     | tools.trainer:train_loop:126 - Epoch: [57/ 80] | Train loss: [0.08988437308899817]
2022-09-14 03:08:04.217 | INFO     | tools.trainer:train_loop:126 - Epoch: [58/ 80] | Train loss: [0.09829398677233726]
2022-09-14 03:09:36.891 | INFO     | tools.trainer:train_loop:126 - Epoch: [59/ 80] | Train loss: [0.10833922118669556]
2022-09-14 03:11:10.695 | INFO     | tools.trainer:train_loop:126 - Epoch: [60/ 80] | Train loss: [0.10314864130510439]
2022-09-14 03:12:43.739 | INFO     | tools.trainer:train_loop:126 - Epoch: [61/ 80] | Train loss: [0.0917591834741254]
2022-09-14 03:14:15.888 | INFO     | tools.trainer:train_loop:126 - Epoch: [62/ 80] | Train loss: [0.10750586485430118]
2022-09-14 03:15:48.954 | INFO     | tools.trainer:train_loop:126 - Epoch: [63/ 80] | Train loss: [0.10973176570428957]
2022-09-14 03:17:21.433 | INFO     | tools.trainer:train_loop:126 - Epoch: [64/ 80] | Train loss: [0.08614614942381459]
2022-09-14 03:18:56.641 | INFO     | tools.trainer:train_loop:126 - Epoch: [65/ 80] | Train loss: [0.08750986361936215]
2022-09-14 03:20:29.211 | INFO     | tools.trainer:train_loop:126 - Epoch: [66/ 80] | Train loss: [0.09479243200152151]
2022-09-14 03:22:03.089 | INFO     | tools.trainer:train_loop:126 - Epoch: [67/ 80] | Train loss: [0.08361833915114403]
2022-09-14 03:23:36.950 | INFO     | tools.trainer:train_loop:126 - Epoch: [68/ 80] | Train loss: [0.08710790798068047]
2022-09-14 03:25:10.991 | INFO     | tools.trainer:train_loop:126 - Epoch: [69/ 80] | Train loss: [0.07980068178186493]
2022-09-14 03:26:44.017 | INFO     | tools.trainer:train_loop:126 - Epoch: [70/ 80] | Train loss: [0.07401460841778786]
2022-09-14 03:28:17.505 | INFO     | tools.trainer:train_loop:126 - Epoch: [71/ 80] | Train loss: [0.08349028914686173]
2022-09-14 03:29:51.074 | INFO     | tools.trainer:train_loop:126 - Epoch: [72/ 80] | Train loss: [0.08500123342439052]
2022-09-14 03:31:23.301 | INFO     | tools.trainer:train_loop:126 - Epoch: [73/ 80] | Train loss: [0.07143710469526629]
2022-09-14 03:32:57.264 | INFO     | tools.trainer:train_loop:126 - Epoch: [74/ 80] | Train loss: [0.07705388031899929]
2022-09-14 03:34:29.634 | INFO     | tools.trainer:train_loop:126 - Epoch: [75/ 80] | Train loss: [0.0736364081742302]
2022-09-14 03:36:02.127 | INFO     | tools.trainer:train_loop:126 - Epoch: [76/ 80] | Train loss: [0.07462561743394021]
2022-09-14 03:37:34.610 | INFO     | tools.trainer:train_loop:126 - Epoch: [77/ 80] | Train loss: [0.06653760382605176]
2022-09-14 03:39:08.876 | INFO     | tools.trainer:train_loop:126 - Epoch: [78/ 80] | Train loss: [0.07078227947556204]
2022-09-14 03:40:41.273 | INFO     | tools.trainer:train_loop:126 - Epoch: [79/ 80] | Train loss: [0.06945261311146521]
2022-09-14 03:42:14.556 | INFO     | tools.trainer:train_loop:126 - Epoch: [80/ 80] | Train loss: [0.07346046770051602]
2022-09-14 03:42:14.962 | INFO     | tools.trainer:train_loop:138 - [Saving Snapshot:]/home/s/hungpv/polyps/checkpoint/neo/neo_small_v5/MiT-B3-FaPNHead_80.pth
2022-09-14 03:42:14.962 | INFO     | tools.trainer:train_loop:147 - Training cost: 7447.312851051334seconds
