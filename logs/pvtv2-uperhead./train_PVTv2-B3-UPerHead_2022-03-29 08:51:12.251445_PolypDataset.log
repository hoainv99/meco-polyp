2022-03-29 08:51:12.253 | INFO     | __main__:main:45 - Load config from configs/pvtv2-uperhead.yaml
2022-03-29 08:51:12.253 | INFO     | __main__:main:46 - {'dataset': {'data_path': '/home/admin_mcn/hungpv/polyps/dataset/KCECE', 'train_data_path': ['/home/admin_mcn/hungpv/polyps/dataset/KCECE/TrainDataset'], 'test_data_path': ['/home/admin_mcn/hungpv/polyps/dataset/KCECE/TestDataset/Kvasir'], 'val_data_path': ['/home/admin_mcn/hungpv/polyps/dataset/KCECE/TestDataset/CVC-300']}, 'model': {'num_classes': 1, 'save_dir': '/mnt/data/hungpv/polyps/checkpoint/KCECE/pvtv2-uperhead_v9', 'backbone': 'PVTv2-B3', 'head': 'UPerHead', 'pretrained': '/mnt/data/hungpv/polyps/pretrained-backbone/pvt_v2_b3.pth'}, 'optimizer': {'name': 'adam', 'lr': 0.0001, 'clip': 0.5, 'scheduler': 'cosine_warmup', 'loss': 'structure_loss'}, 'dev': 'cuda', 'train': {'start_from': 0, 'save_from': 78, 'num_epochs': 80, 'num_warmup_epoch': 10, 'is_val': False, 'size_rates': [0.75, 1, 1.25], 'dataloader': {'batchsize': 16, 'img_size': 352, 'shuffle': True, 'num_workers': 2, 'pin_memory': True, 'drop_last': True}, 'amp': False, 'ddp': False, 'augment': {'prob': 1, 'Flip_prob': 0.7, 'HueSaturationValue_prob': 0.7, 'RandomBrightnessContrast_prob': 0.5, 'crop_prob': 0.0, 'randomrotate90_prob': 0.7}}, 'test': {'dev': 'cuda', 'visualize': False, 'visualize_dir': '/mnt/data/hungpv/polyps/visualize', 'vis_x': 180, 'vis_overwrite': False, 'checkpoint_dir': '/mnt/data/hungpv/polyps/checkpoint/KCECE/pvtv2-uperhead_v8/PVTv2-B3-UPerHead_80.pth', 'dataloader': {'batchsize': 1, 'img_size': 352, 'shuffle': True, 'num_workers': 2, 'pin_memory': True, 'drop_last': True}, 'augment': {'prob': 1, 'Flip_prob': 0, 'HueSaturationValue_prob': 0, 'RandomBrightnessContrast_prob': 0, 'crop_prob': 0, 'randomrotate90_prob': 0, 'elastictransform_prob': 0, 'gridistortion_prob': 0, 'opticaldistortion_prob': 0, 'verticalflip_prob': 0, 'horizontalflip_prob': 0, 'randomgamma_prob': 0, 'CoarseDropout_prob': 0, 'RGBShift_prob': 0, 'MotionBlur_prob': 0, 'MedianBlur_prob': 0, 'GaussianBlur_prob': 0, 'GaussNoise_prob': 0, 'ChannelShuffle_prob': 0}}}
2022-03-29 08:51:12.253 | INFO     | __main__:main:47 - Getting datapath
2022-03-29 08:51:12.259 | INFO     | __main__:main:61 - There are 1450 images to train
2022-03-29 08:51:12.259 | INFO     | __main__:main:80 - Train model with no valid dataset
2022-03-29 08:51:12.259 | INFO     | __main__:main:82 - Loading data
2022-03-29 08:51:12.347 | INFO     | __main__:main:96 - 90 batches to train
2022-03-29 08:51:12.351 | INFO     | __main__:main:109 - Loading model
2022-03-29 08:51:12.351 | INFO     | __main__:main:126 - Loading checkpoint from /mnt/data/hungpv/polyps/pretrained-backbone/pvt_v2_b3.pth ...
2022-03-29 08:51:14.932 | INFO     | __main__:main:164 - Training with FP32 ...
2022-03-29 08:55:10.255 | INFO     | tools.trainer:train_loop:89 - Epoch: [1/ 80] | Train loss: [1.8037886367903815]
2022-03-29 08:59:05.376 | INFO     | tools.trainer:train_loop:89 - Epoch: [2/ 80] | Train loss: [0.7736106057961781]
2022-03-29 09:03:00.735 | INFO     | tools.trainer:train_loop:89 - Epoch: [3/ 80] | Train loss: [0.5518268962701162]
2022-03-29 09:03:00.942 | INFO     | tools.trainer:train_loop:104 - [Saving Snapshot:]/mnt/data/hungpv/polyps/checkpoint/KCECE/pvtv2-uperhead_v9/PVTv2-B3-UPerHead_3.pth
2022-03-29 09:06:56.897 | INFO     | tools.trainer:train_loop:89 - Epoch: [4/ 80] | Train loss: [0.4351755205127928]
2022-03-29 09:10:52.862 | INFO     | tools.trainer:train_loop:89 - Epoch: [5/ 80] | Train loss: [0.3747156610091527]
2022-03-29 09:14:49.362 | INFO     | tools.trainer:train_loop:89 - Epoch: [6/ 80] | Train loss: [0.31800773011313543]
2022-03-29 09:18:45.604 | INFO     | tools.trainer:train_loop:89 - Epoch: [7/ 80] | Train loss: [0.28069854428370794]
2022-03-29 09:22:41.864 | INFO     | tools.trainer:train_loop:89 - Epoch: [8/ 80] | Train loss: [0.24677815818124346]
2022-03-29 09:26:38.014 | INFO     | tools.trainer:train_loop:89 - Epoch: [9/ 80] | Train loss: [0.23026857591337627]
2022-03-29 09:30:34.230 | INFO     | tools.trainer:train_loop:89 - Epoch: [10/ 80] | Train loss: [0.2078978470630116]
2022-03-29 09:34:30.840 | INFO     | tools.trainer:train_loop:89 - Epoch: [11/ 80] | Train loss: [0.2037259398235215]
2022-03-29 09:38:27.778 | INFO     | tools.trainer:train_loop:89 - Epoch: [12/ 80] | Train loss: [0.19773757110039394]
2022-03-29 09:42:24.565 | INFO     | tools.trainer:train_loop:89 - Epoch: [13/ 80] | Train loss: [0.19127622296412786]
2022-03-29 09:46:21.569 | INFO     | tools.trainer:train_loop:89 - Epoch: [14/ 80] | Train loss: [0.17832990056938594]
2022-03-29 09:50:19.493 | INFO     | tools.trainer:train_loop:89 - Epoch: [15/ 80] | Train loss: [0.18264235738250945]
2022-03-29 09:54:16.573 | INFO     | tools.trainer:train_loop:89 - Epoch: [16/ 80] | Train loss: [0.16344760962658458]
2022-03-29 09:58:13.954 | INFO     | tools.trainer:train_loop:89 - Epoch: [17/ 80] | Train loss: [0.16340944783555136]
2022-03-29 10:02:10.580 | INFO     | tools.trainer:train_loop:89 - Epoch: [18/ 80] | Train loss: [0.15976637204488117]
2022-03-29 10:06:06.912 | INFO     | tools.trainer:train_loop:89 - Epoch: [19/ 80] | Train loss: [0.1503411806292004]
2022-03-29 10:10:02.848 | INFO     | tools.trainer:train_loop:89 - Epoch: [20/ 80] | Train loss: [0.14900784293810526]
2022-03-29 10:13:58.506 | INFO     | tools.trainer:train_loop:89 - Epoch: [21/ 80] | Train loss: [0.14787332481808133]
2022-03-29 10:17:54.408 | INFO     | tools.trainer:train_loop:89 - Epoch: [22/ 80] | Train loss: [0.1480844156609641]
2022-03-29 10:21:50.033 | INFO     | tools.trainer:train_loop:89 - Epoch: [23/ 80] | Train loss: [0.1353133697476652]
2022-03-29 10:25:45.825 | INFO     | tools.trainer:train_loop:89 - Epoch: [24/ 80] | Train loss: [0.13166977829403348]
2022-03-29 10:29:42.055 | INFO     | tools.trainer:train_loop:89 - Epoch: [25/ 80] | Train loss: [0.13219846677449015]
2022-03-29 10:33:39.237 | INFO     | tools.trainer:train_loop:89 - Epoch: [26/ 80] | Train loss: [0.12741456768578954]
2022-03-29 10:37:36.645 | INFO     | tools.trainer:train_loop:89 - Epoch: [27/ 80] | Train loss: [0.12394405288828744]
2022-03-29 10:41:33.641 | INFO     | tools.trainer:train_loop:89 - Epoch: [28/ 80] | Train loss: [0.12409861120912764]
2022-03-29 10:45:30.934 | INFO     | tools.trainer:train_loop:89 - Epoch: [29/ 80] | Train loss: [0.13305676157275836]
2022-03-29 10:49:27.951 | INFO     | tools.trainer:train_loop:89 - Epoch: [30/ 80] | Train loss: [0.1256410932375325]
2022-03-29 10:53:25.165 | INFO     | tools.trainer:train_loop:89 - Epoch: [31/ 80] | Train loss: [0.11935448323686917]
2022-03-29 10:57:21.893 | INFO     | tools.trainer:train_loop:89 - Epoch: [32/ 80] | Train loss: [0.11537588172488743]
2022-03-29 11:01:18.184 | INFO     | tools.trainer:train_loop:89 - Epoch: [33/ 80] | Train loss: [0.11058502909209993]
2022-03-29 11:05:13.986 | INFO     | tools.trainer:train_loop:89 - Epoch: [34/ 80] | Train loss: [0.11782180095712344]
2022-03-29 11:09:10.076 | INFO     | tools.trainer:train_loop:89 - Epoch: [35/ 80] | Train loss: [0.10934088337752554]
2022-03-29 11:13:05.618 | INFO     | tools.trainer:train_loop:89 - Epoch: [36/ 80] | Train loss: [0.10979946065280173]
2022-03-29 11:17:01.509 | INFO     | tools.trainer:train_loop:89 - Epoch: [37/ 80] | Train loss: [0.1057554729282856]
2022-03-29 11:20:58.264 | INFO     | tools.trainer:train_loop:89 - Epoch: [38/ 80] | Train loss: [0.10454880098501841]
2022-03-29 11:24:54.371 | INFO     | tools.trainer:train_loop:89 - Epoch: [39/ 80] | Train loss: [0.10396892411841287]
2022-03-29 11:28:50.827 | INFO     | tools.trainer:train_loop:89 - Epoch: [40/ 80] | Train loss: [0.10208610213465161]
2022-03-29 11:32:47.788 | INFO     | tools.trainer:train_loop:89 - Epoch: [41/ 80] | Train loss: [0.09995370813541943]
2022-03-29 11:36:44.677 | INFO     | tools.trainer:train_loop:89 - Epoch: [42/ 80] | Train loss: [0.09838223258654276]
2022-03-29 11:40:41.481 | INFO     | tools.trainer:train_loop:89 - Epoch: [43/ 80] | Train loss: [0.09855243886510531]
2022-03-29 11:44:38.415 | INFO     | tools.trainer:train_loop:89 - Epoch: [44/ 80] | Train loss: [0.09660462389389673]
2022-03-29 11:48:35.262 | INFO     | tools.trainer:train_loop:89 - Epoch: [45/ 80] | Train loss: [0.11149131158987681]
2022-03-29 11:52:32.160 | INFO     | tools.trainer:train_loop:89 - Epoch: [46/ 80] | Train loss: [0.09694609766205152]
2022-03-29 11:56:29.030 | INFO     | tools.trainer:train_loop:89 - Epoch: [47/ 80] | Train loss: [0.09425894576642248]
2022-03-29 12:00:25.888 | INFO     | tools.trainer:train_loop:89 - Epoch: [48/ 80] | Train loss: [0.09347635209560394]
2022-03-29 12:04:22.108 | INFO     | tools.trainer:train_loop:89 - Epoch: [49/ 80] | Train loss: [0.08892801801363627]
2022-03-29 12:08:17.745 | INFO     | tools.trainer:train_loop:89 - Epoch: [50/ 80] | Train loss: [0.088919554816352]
2022-03-29 12:12:13.457 | INFO     | tools.trainer:train_loop:89 - Epoch: [51/ 80] | Train loss: [0.08879172992375162]
2022-03-29 12:16:09.568 | INFO     | tools.trainer:train_loop:89 - Epoch: [52/ 80] | Train loss: [0.08835022664732403]
2022-03-29 12:20:05.224 | INFO     | tools.trainer:train_loop:89 - Epoch: [53/ 80] | Train loss: [0.08545303063260185]
2022-03-29 12:24:01.856 | INFO     | tools.trainer:train_loop:89 - Epoch: [54/ 80] | Train loss: [0.08781527967916594]
2022-03-29 12:27:58.540 | INFO     | tools.trainer:train_loop:89 - Epoch: [55/ 80] | Train loss: [0.08416322163409656]
2022-03-29 12:31:55.392 | INFO     | tools.trainer:train_loop:89 - Epoch: [56/ 80] | Train loss: [0.08211282615860303]
2022-03-29 12:35:52.286 | INFO     | tools.trainer:train_loop:89 - Epoch: [57/ 80] | Train loss: [0.08154111529390017]
2022-03-29 12:39:48.786 | INFO     | tools.trainer:train_loop:89 - Epoch: [58/ 80] | Train loss: [0.0804939611090554]
2022-03-29 12:43:44.867 | INFO     | tools.trainer:train_loop:89 - Epoch: [59/ 80] | Train loss: [0.07920360664526621]
2022-03-29 12:47:41.123 | INFO     | tools.trainer:train_loop:89 - Epoch: [60/ 80] | Train loss: [0.08132539060380724]
2022-03-29 12:51:36.848 | INFO     | tools.trainer:train_loop:89 - Epoch: [61/ 80] | Train loss: [0.07999299748076333]
2022-03-29 12:55:33.014 | INFO     | tools.trainer:train_loop:89 - Epoch: [62/ 80] | Train loss: [0.07799664636452992]
2022-03-29 12:59:28.905 | INFO     | tools.trainer:train_loop:89 - Epoch: [63/ 80] | Train loss: [0.07735236485799153]
2022-03-29 13:03:25.802 | INFO     | tools.trainer:train_loop:89 - Epoch: [64/ 80] | Train loss: [0.07506465692487028]
2022-03-29 13:07:22.397 | INFO     | tools.trainer:train_loop:89 - Epoch: [65/ 80] | Train loss: [0.07448717057704926]
2022-03-29 13:11:19.192 | INFO     | tools.trainer:train_loop:89 - Epoch: [66/ 80] | Train loss: [0.07496264461014006]
2022-03-29 13:15:15.995 | INFO     | tools.trainer:train_loop:89 - Epoch: [67/ 80] | Train loss: [0.07406550463702943]
2022-03-29 13:19:12.755 | INFO     | tools.trainer:train_loop:89 - Epoch: [68/ 80] | Train loss: [0.07293777581718233]
2022-03-29 13:23:09.714 | INFO     | tools.trainer:train_loop:89 - Epoch: [69/ 80] | Train loss: [0.07200144703189532]
2022-03-29 13:27:07.099 | INFO     | tools.trainer:train_loop:89 - Epoch: [70/ 80] | Train loss: [0.07199955752326383]
2022-03-29 13:31:04.146 | INFO     | tools.trainer:train_loop:89 - Epoch: [71/ 80] | Train loss: [0.07016750114659469]
2022-03-29 13:35:00.611 | INFO     | tools.trainer:train_loop:89 - Epoch: [72/ 80] | Train loss: [0.06985253257056077]
2022-03-29 13:38:56.972 | INFO     | tools.trainer:train_loop:89 - Epoch: [73/ 80] | Train loss: [0.07039242183996572]
2022-03-29 13:42:52.727 | INFO     | tools.trainer:train_loop:89 - Epoch: [74/ 80] | Train loss: [0.0690596264683538]
2022-03-29 13:46:49.079 | INFO     | tools.trainer:train_loop:89 - Epoch: [75/ 80] | Train loss: [0.06857430798312028]
2022-03-29 13:50:45.776 | INFO     | tools.trainer:train_loop:89 - Epoch: [76/ 80] | Train loss: [0.06805594431029426]
2022-03-29 13:54:42.635 | INFO     | tools.trainer:train_loop:89 - Epoch: [77/ 80] | Train loss: [0.06805759726299179]
2022-03-29 13:58:39.478 | INFO     | tools.trainer:train_loop:89 - Epoch: [78/ 80] | Train loss: [0.06708902012970712]
2022-03-29 14:02:37.079 | INFO     | tools.trainer:train_loop:89 - Epoch: [79/ 80] | Train loss: [0.06702167495257325]
2022-03-29 14:02:37.281 | INFO     | tools.trainer:train_loop:104 - [Saving Snapshot:]/mnt/data/hungpv/polyps/checkpoint/KCECE/pvtv2-uperhead_v9/PVTv2-B3-UPerHead_79.pth
2022-03-29 14:06:34.470 | INFO     | tools.trainer:train_loop:89 - Epoch: [80/ 80] | Train loss: [0.06646589247716797]
2022-03-29 14:06:34.667 | INFO     | tools.trainer:train_loop:104 - [Saving Snapshot:]/mnt/data/hungpv/polyps/checkpoint/KCECE/pvtv2-uperhead_v9/PVTv2-B3-UPerHead_80.pth
2022-03-29 14:06:34.667 | INFO     | tools.trainer:train_loop:110 - Training cost: 18918.74558823998seconds
