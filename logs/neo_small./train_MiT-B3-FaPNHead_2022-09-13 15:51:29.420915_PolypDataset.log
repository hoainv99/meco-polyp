2022-09-13 15:51:29.424 | INFO     | __main__:main:57 - Load config from configs/neo_small.yaml
2022-09-13 15:51:29.424 | INFO     | __main__:main:58 - {'dataset': {'data_path': '/home/s/hungpv/polyps/dataset', 'train_data_path': ['/home/s/hungpv/polyps/dataset/neo_small/train'], 'test_data_path': ['/home/s/hungpv/polyps/dataset/neo_small/test'], 'val_data_path': ['/home/s/hungpv/polyps/dataset/neo_small/test']}, 'model': {'num_classes': 3, 'save_dir': '/home/s/hungpv/polyps/checkpoint/neo/neo_small_v3', 'backbone': 'MiT-B3', 'head': 'FaPNHead', 'pretrained': '/home/s/hungpv/polyps/pretrained_models/mit_b3.pth'}, 'optimizer': {'name': 'adam', 'lr': 0.0001, 'clip': 0.5, 'scheduler': 'cosine_warmup', 'loss': 'multi_structure_loss'}, 'dev': 'cuda', 'train': {'start_from': 0, 'save_from': 79, 'num_epochs': 80, 'num_warmup_epoch': 8, 'is_val': False, 'size_rates': [0.75, 1, 1.25], 'dataloader': {'batchsize': 16, 'img_size': 384, 'shuffle': True, 'num_workers': 4, 'pin_memory': True, 'drop_last': True}, 'amp': False, 'ddp': False, 'augment': {'prob': 1, 'Flip_prob': 0.5, 'HueSaturationValue_prob': 0.5, 'RandomBrightnessContrast_prob': 0.5, 'crop_prob': 0.0, 'randomrotate90_prob': 0.5, 'ColorJitter_prob': 0.5}}, 'val': {'dataloader': {'batchsize': 8, 'img_size': 384, 'shuffle': True, 'num_workers': 4, 'pin_memory': True, 'drop_last': False}}, 'test': {'dev': 'cuda', 'visualize': True, 'visualize_dir': '/home/s/hungpv/polyps/neo_visualize', 'vis_x': 180, 'vis_overwrite': False, 'checkpoint_dir': '/home/s/hungpv/polyps/checkpoint/neo/neo_small_v3/MiT-B3-FaPNHead_60.pth', 'dataloader': {'batchsize': 1, 'img_size': 384, 'shuffle': True, 'num_workers': 4, 'pin_memory': True, 'drop_last': False}, 'augment': {'prob': 1, 'Flip_prob': 0, 'HueSaturationValue_prob': 0, 'RandomBrightnessContrast_prob': 0, 'crop_prob': 0, 'randomrotate90_prob': 0, 'elastictransform_prob': 0, 'gridistortion_prob': 0, 'opticaldistortion_prob': 0, 'verticalflip_prob': 0, 'horizontalflip_prob': 0, 'randomgamma_prob': 0, 'CoarseDropout_prob': 0, 'RGBShift_prob': 0, 'MotionBlur_prob': 0, 'MedianBlur_prob': 0, 'GaussianBlur_prob': 0, 'GaussNoise_prob': 0, 'ChannelShuffle_prob': 0}}}
2022-09-13 15:51:29.425 | INFO     | __main__:main:59 - Getting datapath
2022-09-13 15:51:29.430 | INFO     | __main__:main:74 - There are 1000 images to train
2022-09-13 15:51:29.431 | INFO     | __main__:main:93 - Train model with no valid dataset
2022-09-13 15:51:29.431 | INFO     | __main__:main:95 - Loading data
2022-09-13 15:51:29.513 | INFO     | __main__:main:109 - 62 batches to train
2022-09-13 15:51:29.513 | INFO     | __main__:main:122 - Loading model
2022-09-13 15:51:29.514 | INFO     | __main__:main:143 - Loading checkpoint from /home/s/hungpv/polyps/pretrained_models/mit_b3.pth ...
2022-09-13 15:51:32.695 | INFO     | __main__:main:187 - Training with FP32 ...
2022-09-13 15:53:04.635 | INFO     | tools.trainer:train_loop:126 - Epoch: [1/ 80] | Train loss: [2.1762494483301715]
2022-09-13 15:54:35.404 | INFO     | tools.trainer:train_loop:126 - Epoch: [2/ 80] | Train loss: [1.0280409157276154]
2022-09-13 15:56:06.426 | INFO     | tools.trainer:train_loop:126 - Epoch: [3/ 80] | Train loss: [0.7889308121896559]
2022-09-13 15:57:37.475 | INFO     | tools.trainer:train_loop:126 - Epoch: [4/ 80] | Train loss: [0.6607046290751426]
2022-09-13 15:59:08.417 | INFO     | tools.trainer:train_loop:126 - Epoch: [5/ 80] | Train loss: [0.5910585392867366]
2022-09-13 16:00:41.145 | INFO     | tools.trainer:train_loop:126 - Epoch: [6/ 80] | Train loss: [0.5522220173189717]
2022-09-13 16:02:12.772 | INFO     | tools.trainer:train_loop:126 - Epoch: [7/ 80] | Train loss: [0.5294240833290161]
2022-09-13 16:03:44.411 | INFO     | tools.trainer:train_loop:126 - Epoch: [8/ 80] | Train loss: [0.547128384632449]
2022-09-13 16:05:16.529 | INFO     | tools.trainer:train_loop:126 - Epoch: [9/ 80] | Train loss: [0.4939341660468809]
2022-09-13 16:06:50.031 | INFO     | tools.trainer:train_loop:126 - Epoch: [10/ 80] | Train loss: [0.36500807010358377]
2022-09-13 16:08:22.079 | INFO     | tools.trainer:train_loop:126 - Epoch: [11/ 80] | Train loss: [0.3012617558481232]
2022-09-13 16:09:56.443 | INFO     | tools.trainer:train_loop:126 - Epoch: [12/ 80] | Train loss: [0.2940029054880142]
2022-09-13 16:11:28.530 | INFO     | tools.trainer:train_loop:126 - Epoch: [13/ 80] | Train loss: [0.29369087445159114]
2022-09-13 16:13:00.873 | INFO     | tools.trainer:train_loop:126 - Epoch: [14/ 80] | Train loss: [0.2536212434211085]
2022-09-13 16:14:33.527 | INFO     | tools.trainer:train_loop:126 - Epoch: [15/ 80] | Train loss: [0.31788504916814064]
2022-09-13 16:16:05.628 | INFO     | tools.trainer:train_loop:126 - Epoch: [16/ 80] | Train loss: [0.2450011755910612]
2022-09-13 16:17:37.805 | INFO     | tools.trainer:train_loop:126 - Epoch: [17/ 80] | Train loss: [0.2282304381651263]
2022-09-13 16:19:10.513 | INFO     | tools.trainer:train_loop:126 - Epoch: [18/ 80] | Train loss: [0.21681239912586828]
2022-09-13 16:20:42.865 | INFO     | tools.trainer:train_loop:126 - Epoch: [19/ 80] | Train loss: [0.23172647313725564]
2022-09-13 16:22:15.599 | INFO     | tools.trainer:train_loop:126 - Epoch: [20/ 80] | Train loss: [0.2324017632392145]
2022-09-13 16:23:49.644 | INFO     | tools.trainer:train_loop:126 - Epoch: [21/ 80] | Train loss: [0.19134626465459023]
2022-09-13 16:25:21.899 | INFO     | tools.trainer:train_loop:126 - Epoch: [22/ 80] | Train loss: [0.19744683201274565]
2022-09-13 16:26:55.249 | INFO     | tools.trainer:train_loop:126 - Epoch: [23/ 80] | Train loss: [0.20636718071276142]
2022-09-13 16:28:27.009 | INFO     | tools.trainer:train_loop:126 - Epoch: [24/ 80] | Train loss: [0.19800289491972617]
2022-09-13 16:29:59.642 | INFO     | tools.trainer:train_loop:126 - Epoch: [25/ 80] | Train loss: [0.18007306237855264]
2022-09-13 16:31:33.343 | INFO     | tools.trainer:train_loop:126 - Epoch: [26/ 80] | Train loss: [0.1757955531319303]
2022-09-13 16:33:05.241 | INFO     | tools.trainer:train_loop:126 - Epoch: [27/ 80] | Train loss: [0.17560626374137017]
2022-09-13 16:34:38.234 | INFO     | tools.trainer:train_loop:126 - Epoch: [28/ 80] | Train loss: [0.1654799848554596]
2022-09-13 16:36:10.161 | INFO     | tools.trainer:train_loop:126 - Epoch: [29/ 80] | Train loss: [0.1761467294587243]
2022-09-13 16:37:44.513 | INFO     | tools.trainer:train_loop:126 - Epoch: [30/ 80] | Train loss: [0.1648512805902189]
2022-09-13 16:39:18.153 | INFO     | tools.trainer:train_loop:126 - Epoch: [31/ 80] | Train loss: [0.20754958418828826]
2022-09-13 16:40:51.079 | INFO     | tools.trainer:train_loop:126 - Epoch: [32/ 80] | Train loss: [0.16746000837414496]
2022-09-13 16:42:23.259 | INFO     | tools.trainer:train_loop:126 - Epoch: [33/ 80] | Train loss: [0.16320404055858811]
2022-09-13 16:43:55.571 | INFO     | tools.trainer:train_loop:126 - Epoch: [34/ 80] | Train loss: [0.15071937459851464]
2022-09-13 16:45:27.734 | INFO     | tools.trainer:train_loop:126 - Epoch: [35/ 80] | Train loss: [0.14688158618105995]
2022-09-13 16:47:02.501 | INFO     | tools.trainer:train_loop:126 - Epoch: [36/ 80] | Train loss: [0.1722150467216007]
2022-09-13 16:48:34.185 | INFO     | tools.trainer:train_loop:126 - Epoch: [37/ 80] | Train loss: [0.14442405435106448]
2022-09-13 16:50:08.168 | INFO     | tools.trainer:train_loop:126 - Epoch: [38/ 80] | Train loss: [0.14622831218425306]
2022-09-13 16:51:41.160 | INFO     | tools.trainer:train_loop:126 - Epoch: [39/ 80] | Train loss: [0.13720304002204248]
2022-09-13 16:53:13.634 | INFO     | tools.trainer:train_loop:126 - Epoch: [40/ 80] | Train loss: [0.14595140883278462]
2022-09-13 16:54:46.135 | INFO     | tools.trainer:train_loop:126 - Epoch: [41/ 80] | Train loss: [0.1359632590845708]
2022-09-13 16:56:20.273 | INFO     | tools.trainer:train_loop:126 - Epoch: [42/ 80] | Train loss: [0.12646467316775553]
2022-09-13 16:57:53.090 | INFO     | tools.trainer:train_loop:126 - Epoch: [43/ 80] | Train loss: [0.11320507231979601]
2022-09-13 16:59:25.306 | INFO     | tools.trainer:train_loop:126 - Epoch: [44/ 80] | Train loss: [0.12849480298257643]
2022-09-13 17:00:59.908 | INFO     | tools.trainer:train_loop:126 - Epoch: [45/ 80] | Train loss: [0.13419951438423125]
2022-09-13 17:02:33.851 | INFO     | tools.trainer:train_loop:126 - Epoch: [46/ 80] | Train loss: [0.12210076626750731]
2022-09-13 17:04:05.872 | INFO     | tools.trainer:train_loop:126 - Epoch: [47/ 80] | Train loss: [0.12729642101593555]
2022-09-13 17:05:39.106 | INFO     | tools.trainer:train_loop:126 - Epoch: [48/ 80] | Train loss: [0.10395465773199836]
2022-09-13 17:07:13.070 | INFO     | tools.trainer:train_loop:126 - Epoch: [49/ 80] | Train loss: [0.09942329482686135]
2022-09-13 17:08:45.757 | INFO     | tools.trainer:train_loop:126 - Epoch: [50/ 80] | Train loss: [0.09600574282869216]
2022-09-13 17:10:19.368 | INFO     | tools.trainer:train_loop:126 - Epoch: [51/ 80] | Train loss: [0.0893819854865151]
2022-09-13 17:11:51.521 | INFO     | tools.trainer:train_loop:126 - Epoch: [52/ 80] | Train loss: [0.09359471872448921]
2022-09-13 17:13:24.910 | INFO     | tools.trainer:train_loop:126 - Epoch: [53/ 80] | Train loss: [0.08372049093727142]
2022-09-13 17:14:58.337 | INFO     | tools.trainer:train_loop:126 - Epoch: [54/ 80] | Train loss: [0.08515195512483197]
2022-09-13 17:16:30.111 | INFO     | tools.trainer:train_loop:126 - Epoch: [55/ 80] | Train loss: [0.0833994064239725]
2022-09-13 17:18:03.573 | INFO     | tools.trainer:train_loop:126 - Epoch: [56/ 80] | Train loss: [0.08318752434945875]
2022-09-13 17:19:37.131 | INFO     | tools.trainer:train_loop:126 - Epoch: [57/ 80] | Train loss: [0.08483191450396853]
2022-09-13 17:21:09.207 | INFO     | tools.trainer:train_loop:126 - Epoch: [58/ 80] | Train loss: [0.08109863607152816]
2022-09-13 17:22:42.084 | INFO     | tools.trainer:train_loop:126 - Epoch: [59/ 80] | Train loss: [0.06975058568341116]
2022-09-13 17:24:14.456 | INFO     | tools.trainer:train_loop:126 - Epoch: [60/ 80] | Train loss: [0.07906146960393075]
2022-09-13 17:25:46.805 | INFO     | tools.trainer:train_loop:126 - Epoch: [61/ 80] | Train loss: [0.09273221457917843]
2022-09-13 17:27:20.284 | INFO     | tools.trainer:train_loop:126 - Epoch: [62/ 80] | Train loss: [0.07329924765133089]
2022-09-13 17:28:52.701 | INFO     | tools.trainer:train_loop:126 - Epoch: [63/ 80] | Train loss: [0.07657123381091703]
2022-09-13 17:30:25.413 | INFO     | tools.trainer:train_loop:126 - Epoch: [64/ 80] | Train loss: [0.06503555521128639]
2022-09-13 17:31:57.188 | INFO     | tools.trainer:train_loop:126 - Epoch: [65/ 80] | Train loss: [0.07653013610791776]
2022-09-13 17:33:31.942 | INFO     | tools.trainer:train_loop:126 - Epoch: [66/ 80] | Train loss: [0.07386612258250674]
2022-09-13 17:35:04.600 | INFO     | tools.trainer:train_loop:126 - Epoch: [67/ 80] | Train loss: [0.07084431415123324]
2022-09-13 17:36:37.155 | INFO     | tools.trainer:train_loop:126 - Epoch: [68/ 80] | Train loss: [0.06718010190994508]
2022-09-13 17:38:09.434 | INFO     | tools.trainer:train_loop:126 - Epoch: [69/ 80] | Train loss: [0.06943792026610143]
2022-09-13 17:39:43.201 | INFO     | tools.trainer:train_loop:126 - Epoch: [70/ 80] | Train loss: [0.06196467440214849]
2022-09-13 17:41:15.892 | INFO     | tools.trainer:train_loop:126 - Epoch: [71/ 80] | Train loss: [0.06556559399130844]
2022-09-13 17:42:48.351 | INFO     | tools.trainer:train_loop:126 - Epoch: [72/ 80] | Train loss: [0.06669638714482708]
2022-09-13 17:44:21.230 | INFO     | tools.trainer:train_loop:126 - Epoch: [73/ 80] | Train loss: [0.060167183709000385]
2022-09-13 17:45:54.280 | INFO     | tools.trainer:train_loop:126 - Epoch: [74/ 80] | Train loss: [0.05904506891965866]
2022-09-13 17:47:26.083 | INFO     | tools.trainer:train_loop:126 - Epoch: [75/ 80] | Train loss: [0.060029315131325874]
2022-09-13 17:48:59.388 | INFO     | tools.trainer:train_loop:126 - Epoch: [76/ 80] | Train loss: [0.05914014935373298]
2022-09-13 17:50:32.544 | INFO     | tools.trainer:train_loop:126 - Epoch: [77/ 80] | Train loss: [0.06056455411617794]
2022-09-13 17:52:04.506 | INFO     | tools.trainer:train_loop:126 - Epoch: [78/ 80] | Train loss: [0.06024873707323305]
2022-09-13 17:53:38.415 | INFO     | tools.trainer:train_loop:126 - Epoch: [79/ 80] | Train loss: [0.05667621044502143]
2022-09-13 17:55:10.937 | INFO     | tools.trainer:train_loop:126 - Epoch: [80/ 80] | Train loss: [0.05914145678041443]
2022-09-13 17:55:11.353 | INFO     | tools.trainer:train_loop:138 - [Saving Snapshot:]/home/s/hungpv/polyps/checkpoint/neo/neo_small_v3/MiT-B3-FaPNHead_80.pth
2022-09-13 17:55:11.354 | INFO     | tools.trainer:train_loop:147 - Training cost: 7417.725897546858seconds
