2022-03-28 08:46:51.145 | INFO     | __main__:main:45 - Load config from configs/pvtv2-uperhead.yaml
2022-03-28 08:46:51.145 | INFO     | __main__:main:46 - {'dataset': {'data_path': '/home/admin_mcn/hungpv/polyps/dataset/KCECE', 'train_data_path': ['/home/admin_mcn/hungpv/polyps/dataset/KCECE/TrainDataset'], 'test_data_path': ['/home/admin_mcn/hungpv/polyps/dataset/KCECE/TestDataset/Kvasir'], 'val_data_path': ['/home/admin_mcn/hungpv/polyps/dataset/KCECE/TestDataset/CVC-300']}, 'model': {'num_classes': 1, 'save_dir': '/mnt/data/hungpv/polyps/checkpoint/KCECE/pvtv2-uperhead_v8', 'backbone': 'PVTv2-B3', 'head': 'UPerHead', 'pretrained': '/mnt/data/hungpv/polyps/pretrained-backbone/pvt_v2_b3.pth'}, 'optimizer': {'name': 'adam', 'lr': 0.0001, 'clip': 0.5, 'scheduler': 'cosine_warmup', 'loss': 'structure_loss'}, 'dev': 'cuda', 'train': {'start_from': 0, 'save_from': 78, 'num_epochs': 80, 'num_warmup_epoch': 10, 'is_val': False, 'size_rates': [0.75, 1, 1.25], 'dataloader': {'batchsize': 16, 'img_size': 352, 'shuffle': True, 'num_workers': 2, 'pin_memory': True, 'drop_last': True}, 'amp': False, 'ddp': False, 'augment': {'prob': 1, 'Flip_prob': 0.7, 'HueSaturationValue_prob': 0.7, 'RandomBrightnessContrast_prob': 0.5, 'crop_prob': 0.2, 'randomrotate90_prob': 0.7}}, 'test': {'dev': 'cuda', 'visualize': False, 'visualize_dir': '/mnt/data/hungpv/polyps/visualize', 'vis_x': 180, 'vis_overwrite': False, 'checkpoint_dir': '/mnt/data/hungpv/polyps/checkpoint/KCECE/pvtv2-uperhead_v8/PVTv2-B3-UPerHead_80.pth', 'dataloader': {'batchsize': 1, 'img_size': 352, 'shuffle': True, 'num_workers': 2, 'pin_memory': True, 'drop_last': True}, 'augment': {'prob': 1, 'Flip_prob': 0, 'HueSaturationValue_prob': 0, 'RandomBrightnessContrast_prob': 0, 'crop_prob': 0, 'randomrotate90_prob': 0, 'elastictransform_prob': 0, 'gridistortion_prob': 0, 'opticaldistortion_prob': 0, 'verticalflip_prob': 0, 'horizontalflip_prob': 0, 'randomgamma_prob': 0, 'CoarseDropout_prob': 0, 'RGBShift_prob': 0, 'MotionBlur_prob': 0, 'MedianBlur_prob': 0, 'GaussianBlur_prob': 0, 'GaussNoise_prob': 0, 'ChannelShuffle_prob': 0}}}
2022-03-28 08:46:51.145 | INFO     | __main__:main:47 - Getting datapath
2022-03-28 08:46:51.151 | INFO     | __main__:main:61 - There are 1450 images to train
2022-03-28 08:46:51.151 | INFO     | __main__:main:80 - Train model with no valid dataset
2022-03-28 08:46:51.152 | INFO     | __main__:main:82 - Loading data
2022-03-28 08:46:51.239 | INFO     | __main__:main:96 - 90 batches to train
2022-03-28 08:46:51.243 | INFO     | __main__:main:109 - Loading model
2022-03-28 08:46:51.243 | INFO     | __main__:main:126 - Loading checkpoint from /mnt/data/hungpv/polyps/pretrained-backbone/pvt_v2_b3.pth ...
2022-03-28 08:46:53.852 | INFO     | __main__:main:164 - Training with FP32 ...
2022-03-28 08:50:49.367 | INFO     | tools.trainer:train_loop:89 - Epoch: [1/ 80] | Train loss: [2.6467611306243475]
2022-03-28 08:54:44.012 | INFO     | tools.trainer:train_loop:89 - Epoch: [2/ 80] | Train loss: [0.8853161931037903]
2022-03-28 08:58:39.160 | INFO     | tools.trainer:train_loop:89 - Epoch: [3/ 80] | Train loss: [0.6666819804244571]
2022-03-28 08:58:39.364 | INFO     | tools.trainer:train_loop:104 - [Saving Snapshot:]/mnt/data/hungpv/polyps/checkpoint/KCECE/pvtv2-uperhead_v8/PVTv2-B3-UPerHead_3.pth
2022-03-28 09:02:35.195 | INFO     | tools.trainer:train_loop:89 - Epoch: [4/ 80] | Train loss: [0.5392318854729334]
2022-03-28 09:06:31.219 | INFO     | tools.trainer:train_loop:89 - Epoch: [5/ 80] | Train loss: [0.45701197534799576]
2022-03-28 09:10:27.185 | INFO     | tools.trainer:train_loop:89 - Epoch: [6/ 80] | Train loss: [0.40576204657554626]
2022-03-28 09:14:23.019 | INFO     | tools.trainer:train_loop:89 - Epoch: [7/ 80] | Train loss: [0.3797123710314433]
2022-03-28 09:18:19.660 | INFO     | tools.trainer:train_loop:89 - Epoch: [8/ 80] | Train loss: [0.3327226253019439]
2022-03-28 09:22:15.774 | INFO     | tools.trainer:train_loop:89 - Epoch: [9/ 80] | Train loss: [0.2903975271516376]
2022-03-28 09:26:12.352 | INFO     | tools.trainer:train_loop:89 - Epoch: [10/ 80] | Train loss: [0.2953498928083314]
2022-03-28 09:30:08.369 | INFO     | tools.trainer:train_loop:89 - Epoch: [11/ 80] | Train loss: [0.29246854997343485]
2022-03-28 09:34:04.527 | INFO     | tools.trainer:train_loop:89 - Epoch: [12/ 80] | Train loss: [0.26850554413265654]
2022-03-28 09:38:01.558 | INFO     | tools.trainer:train_loop:89 - Epoch: [13/ 80] | Train loss: [0.2774493642979198]
2022-03-28 09:41:58.650 | INFO     | tools.trainer:train_loop:89 - Epoch: [14/ 80] | Train loss: [0.23277862038877276]
2022-03-28 09:45:54.784 | INFO     | tools.trainer:train_loop:89 - Epoch: [15/ 80] | Train loss: [0.23466818183660507]
2022-03-28 09:49:51.266 | INFO     | tools.trainer:train_loop:89 - Epoch: [16/ 80] | Train loss: [0.21956315040588378]
2022-03-28 09:53:47.759 | INFO     | tools.trainer:train_loop:89 - Epoch: [17/ 80] | Train loss: [0.22546935098038778]
2022-03-28 09:57:44.419 | INFO     | tools.trainer:train_loop:89 - Epoch: [18/ 80] | Train loss: [0.2196469253136052]
2022-03-28 10:01:40.829 | INFO     | tools.trainer:train_loop:89 - Epoch: [19/ 80] | Train loss: [0.21276474230819278]
2022-03-28 10:05:36.928 | INFO     | tools.trainer:train_loop:89 - Epoch: [20/ 80] | Train loss: [0.1997550282213423]
2022-03-28 10:09:33.659 | INFO     | tools.trainer:train_loop:89 - Epoch: [21/ 80] | Train loss: [0.2009011992977725]
2022-03-28 10:13:30.377 | INFO     | tools.trainer:train_loop:89 - Epoch: [22/ 80] | Train loss: [0.20463226346506014]
2022-03-28 10:17:26.956 | INFO     | tools.trainer:train_loop:89 - Epoch: [23/ 80] | Train loss: [0.2051547015706698]
2022-03-28 10:21:23.465 | INFO     | tools.trainer:train_loop:89 - Epoch: [24/ 80] | Train loss: [0.195310075663858]
2022-03-28 10:25:20.303 | INFO     | tools.trainer:train_loop:89 - Epoch: [25/ 80] | Train loss: [0.18943057763907645]
2022-03-28 10:29:17.359 | INFO     | tools.trainer:train_loop:89 - Epoch: [26/ 80] | Train loss: [0.18513610909382502]
2022-03-28 10:33:14.004 | INFO     | tools.trainer:train_loop:89 - Epoch: [27/ 80] | Train loss: [0.18065130917562378]
2022-03-28 10:37:10.227 | INFO     | tools.trainer:train_loop:89 - Epoch: [28/ 80] | Train loss: [0.18893959836827384]
2022-03-28 10:41:06.534 | INFO     | tools.trainer:train_loop:89 - Epoch: [29/ 80] | Train loss: [0.18620277833607463]
2022-03-28 10:45:03.132 | INFO     | tools.trainer:train_loop:89 - Epoch: [30/ 80] | Train loss: [0.19620075590080685]
2022-03-28 10:49:00.568 | INFO     | tools.trainer:train_loop:89 - Epoch: [31/ 80] | Train loss: [0.18933079234427877]
2022-03-28 10:52:57.150 | INFO     | tools.trainer:train_loop:89 - Epoch: [32/ 80] | Train loss: [0.17691322126322323]
2022-03-28 10:56:53.212 | INFO     | tools.trainer:train_loop:89 - Epoch: [33/ 80] | Train loss: [0.19084709369473987]
2022-03-28 11:00:49.063 | INFO     | tools.trainer:train_loop:89 - Epoch: [34/ 80] | Train loss: [0.17718811929225922]
2022-03-28 11:04:44.925 | INFO     | tools.trainer:train_loop:89 - Epoch: [35/ 80] | Train loss: [0.17737821911772092]
2022-03-28 11:08:41.078 | INFO     | tools.trainer:train_loop:89 - Epoch: [36/ 80] | Train loss: [0.16732529948155087]
2022-03-28 11:12:37.291 | INFO     | tools.trainer:train_loop:89 - Epoch: [37/ 80] | Train loss: [0.17114063898722331]
2022-03-28 11:16:33.663 | INFO     | tools.trainer:train_loop:89 - Epoch: [38/ 80] | Train loss: [0.16311411236723264]
2022-03-28 11:20:30.409 | INFO     | tools.trainer:train_loop:89 - Epoch: [39/ 80] | Train loss: [0.16210208675927587]
2022-03-28 11:24:27.940 | INFO     | tools.trainer:train_loop:89 - Epoch: [40/ 80] | Train loss: [0.155235848410262]
2022-03-28 11:28:25.004 | INFO     | tools.trainer:train_loop:89 - Epoch: [41/ 80] | Train loss: [0.14595936818255317]
2022-03-28 11:32:21.535 | INFO     | tools.trainer:train_loop:89 - Epoch: [42/ 80] | Train loss: [0.16235929504036903]
2022-03-28 11:36:17.027 | INFO     | tools.trainer:train_loop:89 - Epoch: [43/ 80] | Train loss: [0.15493425933851135]
2022-03-28 11:40:12.874 | INFO     | tools.trainer:train_loop:89 - Epoch: [44/ 80] | Train loss: [0.15293393077121842]
2022-03-28 11:44:08.321 | INFO     | tools.trainer:train_loop:89 - Epoch: [45/ 80] | Train loss: [0.14753529470827845]
2022-03-28 11:48:03.576 | INFO     | tools.trainer:train_loop:89 - Epoch: [46/ 80] | Train loss: [0.15083000577158398]
2022-03-28 11:51:59.031 | INFO     | tools.trainer:train_loop:89 - Epoch: [47/ 80] | Train loss: [0.14520377094546955]
2022-03-28 11:55:55.409 | INFO     | tools.trainer:train_loop:89 - Epoch: [48/ 80] | Train loss: [0.1695109979973899]
2022-03-28 11:59:51.865 | INFO     | tools.trainer:train_loop:89 - Epoch: [49/ 80] | Train loss: [0.16073613514502844]
2022-03-28 12:03:48.698 | INFO     | tools.trainer:train_loop:89 - Epoch: [50/ 80] | Train loss: [0.14345741636223264]
2022-03-28 12:07:45.916 | INFO     | tools.trainer:train_loop:89 - Epoch: [51/ 80] | Train loss: [0.15274774481852849]
2022-03-28 12:11:42.885 | INFO     | tools.trainer:train_loop:89 - Epoch: [52/ 80] | Train loss: [0.13772675899995698]
2022-03-28 12:15:39.987 | INFO     | tools.trainer:train_loop:89 - Epoch: [53/ 80] | Train loss: [0.13054964707957373]
2022-03-28 12:19:37.391 | INFO     | tools.trainer:train_loop:89 - Epoch: [54/ 80] | Train loss: [0.13112364982565244]
2022-03-28 12:23:33.671 | INFO     | tools.trainer:train_loop:89 - Epoch: [55/ 80] | Train loss: [0.13284059291084607]
2022-03-28 12:27:29.485 | INFO     | tools.trainer:train_loop:89 - Epoch: [56/ 80] | Train loss: [0.13409308468302092]
2022-03-28 12:31:24.985 | INFO     | tools.trainer:train_loop:89 - Epoch: [57/ 80] | Train loss: [0.13608724632196956]
2022-03-28 12:35:20.550 | INFO     | tools.trainer:train_loop:89 - Epoch: [58/ 80] | Train loss: [0.1280125456551711]
2022-03-28 12:39:16.171 | INFO     | tools.trainer:train_loop:89 - Epoch: [59/ 80] | Train loss: [0.12269023938311471]
2022-03-28 12:43:11.850 | INFO     | tools.trainer:train_loop:89 - Epoch: [60/ 80] | Train loss: [0.13193577950199445]
2022-03-28 12:47:07.730 | INFO     | tools.trainer:train_loop:89 - Epoch: [61/ 80] | Train loss: [0.12580163321561283]
2022-03-28 12:51:02.909 | INFO     | tools.trainer:train_loop:89 - Epoch: [62/ 80] | Train loss: [0.1254412729707029]
2022-03-28 12:54:58.227 | INFO     | tools.trainer:train_loop:89 - Epoch: [63/ 80] | Train loss: [0.1407449822458956]
2022-03-28 12:58:53.442 | INFO     | tools.trainer:train_loop:89 - Epoch: [64/ 80] | Train loss: [0.12408176586031913]
2022-03-28 13:02:49.213 | INFO     | tools.trainer:train_loop:89 - Epoch: [65/ 80] | Train loss: [0.11826447852783734]
2022-03-28 13:06:44.899 | INFO     | tools.trainer:train_loop:89 - Epoch: [66/ 80] | Train loss: [0.11934242753518952]
2022-03-28 13:10:40.702 | INFO     | tools.trainer:train_loop:89 - Epoch: [67/ 80] | Train loss: [0.11809369673331578]
2022-03-28 13:14:35.937 | INFO     | tools.trainer:train_loop:89 - Epoch: [68/ 80] | Train loss: [0.11472070001893574]
2022-03-28 13:18:31.298 | INFO     | tools.trainer:train_loop:89 - Epoch: [69/ 80] | Train loss: [0.11846827723913722]
2022-03-28 13:22:26.688 | INFO     | tools.trainer:train_loop:89 - Epoch: [70/ 80] | Train loss: [0.10839085032542546]
2022-03-28 13:26:22.901 | INFO     | tools.trainer:train_loop:89 - Epoch: [71/ 80] | Train loss: [0.11637297670046488]
2022-03-28 13:30:18.617 | INFO     | tools.trainer:train_loop:89 - Epoch: [72/ 80] | Train loss: [0.11618475781546699]
2022-03-28 13:34:14.276 | INFO     | tools.trainer:train_loop:89 - Epoch: [73/ 80] | Train loss: [0.11799769807193014]
2022-03-28 13:38:09.630 | INFO     | tools.trainer:train_loop:89 - Epoch: [74/ 80] | Train loss: [0.11266838179694282]
2022-03-28 13:42:05.257 | INFO     | tools.trainer:train_loop:89 - Epoch: [75/ 80] | Train loss: [0.11596852218111356]
2022-03-28 13:46:00.602 | INFO     | tools.trainer:train_loop:89 - Epoch: [76/ 80] | Train loss: [0.11158394258883264]
2022-03-28 13:49:56.220 | INFO     | tools.trainer:train_loop:89 - Epoch: [77/ 80] | Train loss: [0.11333838750918707]
2022-03-28 13:53:51.499 | INFO     | tools.trainer:train_loop:89 - Epoch: [78/ 80] | Train loss: [0.11205972275800175]
2022-03-28 13:57:46.689 | INFO     | tools.trainer:train_loop:89 - Epoch: [79/ 80] | Train loss: [0.10828205744425455]
2022-03-28 13:57:46.885 | INFO     | tools.trainer:train_loop:104 - [Saving Snapshot:]/mnt/data/hungpv/polyps/checkpoint/KCECE/pvtv2-uperhead_v8/PVTv2-B3-UPerHead_79.pth
2022-03-28 14:01:42.474 | INFO     | tools.trainer:train_loop:89 - Epoch: [80/ 80] | Train loss: [0.11329385058747397]
2022-03-28 14:01:42.668 | INFO     | tools.trainer:train_loop:104 - [Saving Snapshot:]/mnt/data/hungpv/polyps/checkpoint/KCECE/pvtv2-uperhead_v8/PVTv2-B3-UPerHead_80.pth
2022-03-28 14:01:42.668 | INFO     | tools.trainer:train_loop:110 - Training cost: 18887.826931043004seconds
