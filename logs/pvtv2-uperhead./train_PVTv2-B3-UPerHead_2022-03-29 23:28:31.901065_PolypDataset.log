2022-03-29 23:28:31.902 | INFO     | __main__:main:45 - Load config from configs/pvtv2-uperhead.yaml
2022-03-29 23:28:31.902 | INFO     | __main__:main:46 - {'dataset': {'data_path': '/home/admin_mcn/hungpv/polyps/dataset/KCECE', 'train_data_path': ['/home/admin_mcn/hungpv/polyps/dataset/KCECE/TrainDataset'], 'test_data_path': ['/home/admin_mcn/hungpv/polyps/dataset/KCECE/TestDataset/Kvasir'], 'val_data_path': ['/home/admin_mcn/hungpv/polyps/dataset/KCECE/TestDataset/CVC-300']}, 'model': {'num_classes': 1, 'save_dir': '/mnt/data/hungpv/polyps/checkpoint/KCECE/pvtv2-uperhead_v9', 'backbone': 'PVTv2-B3', 'head': 'UPerHead', 'pretrained': '/mnt/data/hungpv/polyps/pretrained-backbone/pvt_v2_b3.pth'}, 'optimizer': {'name': 'adam', 'lr': 0.0001, 'clip': 0.5, 'scheduler': 'cosine_warmup', 'loss': 'structure_loss'}, 'dev': 'cuda', 'train': {'start_from': 0, 'save_from': 78, 'num_epochs': 80, 'num_warmup_epoch': 10, 'is_val': False, 'size_rates': [0.75, 1, 1.25], 'dataloader': {'batchsize': 16, 'img_size': 352, 'shuffle': True, 'num_workers': 2, 'pin_memory': True, 'drop_last': True}, 'amp': False, 'ddp': False, 'augment': {'prob': 1, 'Flip_prob': 0.7, 'HueSaturationValue_prob': 0.7, 'RandomBrightnessContrast_prob': 0.5, 'crop_prob': 0.0, 'randomrotate90_prob': 0.7}}, 'test': {'dev': 'cuda', 'visualize': False, 'visualize_dir': '/mnt/data/hungpv/polyps/visualize', 'vis_x': 180, 'vis_overwrite': False, 'checkpoint_dir': '/mnt/data/hungpv/polyps/checkpoint/KCECE/pvtv2-uperhead_v9/PVTv2-B3-UPerHead_80.pth', 'dataloader': {'batchsize': 1, 'img_size': 352, 'shuffle': True, 'num_workers': 2, 'pin_memory': True, 'drop_last': True}, 'augment': {'prob': 1, 'Flip_prob': 0, 'HueSaturationValue_prob': 0, 'RandomBrightnessContrast_prob': 0, 'crop_prob': 0, 'randomrotate90_prob': 0, 'elastictransform_prob': 0, 'gridistortion_prob': 0, 'opticaldistortion_prob': 0, 'verticalflip_prob': 0, 'horizontalflip_prob': 0, 'randomgamma_prob': 0, 'CoarseDropout_prob': 0, 'RGBShift_prob': 0, 'MotionBlur_prob': 0, 'MedianBlur_prob': 0, 'GaussianBlur_prob': 0, 'GaussNoise_prob': 0, 'ChannelShuffle_prob': 0}}}
2022-03-29 23:28:31.903 | INFO     | __main__:main:47 - Getting datapath
2022-03-29 23:28:31.909 | INFO     | __main__:main:61 - There are 1450 images to train
2022-03-29 23:28:31.909 | INFO     | __main__:main:80 - Train model with no valid dataset
2022-03-29 23:28:31.909 | INFO     | __main__:main:82 - Loading data
2022-03-29 23:28:32.000 | INFO     | __main__:main:96 - 90 batches to train
2022-03-29 23:28:32.004 | INFO     | __main__:main:109 - Loading model
2022-03-29 23:28:32.004 | INFO     | __main__:main:126 - Loading checkpoint from /mnt/data/hungpv/polyps/pretrained-backbone/pvt_v2_b3.pth ...
2022-03-29 23:28:34.585 | INFO     | __main__:main:164 - Training with FP32 ...
2022-03-29 23:32:37.191 | INFO     | tools.trainer:train_loop:89 - Epoch: [1/ 80] | Train loss: [1.5107041908635033]
2022-03-29 23:36:52.110 | INFO     | tools.trainer:train_loop:89 - Epoch: [2/ 80] | Train loss: [0.7409443825483322]
2022-03-29 23:41:12.403 | INFO     | tools.trainer:train_loop:89 - Epoch: [3/ 80] | Train loss: [0.5410343160231909]
2022-03-29 23:41:12.607 | INFO     | tools.trainer:train_loop:104 - [Saving Snapshot:]/mnt/data/hungpv/polyps/checkpoint/KCECE/pvtv2-uperhead_v9/PVTv2-B3-UPerHead_3.pth
2022-03-29 23:45:34.091 | INFO     | tools.trainer:train_loop:89 - Epoch: [4/ 80] | Train loss: [0.41992477542824214]
2022-03-29 23:49:55.213 | INFO     | tools.trainer:train_loop:89 - Epoch: [5/ 80] | Train loss: [0.3514879056149059]
2022-03-29 23:54:17.414 | INFO     | tools.trainer:train_loop:89 - Epoch: [6/ 80] | Train loss: [0.3029659872253736]
2022-03-29 23:58:38.286 | INFO     | tools.trainer:train_loop:89 - Epoch: [7/ 80] | Train loss: [0.27162476678689323]
2022-03-30 00:02:58.895 | INFO     | tools.trainer:train_loop:89 - Epoch: [8/ 80] | Train loss: [0.24327210005786684]
2022-03-30 00:07:20.357 | INFO     | tools.trainer:train_loop:89 - Epoch: [9/ 80] | Train loss: [0.23023261775573095]
2022-03-30 00:11:41.513 | INFO     | tools.trainer:train_loop:89 - Epoch: [10/ 80] | Train loss: [0.20563016947772766]
2022-03-30 00:16:02.767 | INFO     | tools.trainer:train_loop:89 - Epoch: [11/ 80] | Train loss: [0.20011997107002472]
2022-03-30 00:20:24.165 | INFO     | tools.trainer:train_loop:89 - Epoch: [12/ 80] | Train loss: [0.1955539738966359]
2022-03-30 00:24:44.270 | INFO     | tools.trainer:train_loop:89 - Epoch: [13/ 80] | Train loss: [0.1781288533575005]
2022-03-30 00:29:05.916 | INFO     | tools.trainer:train_loop:89 - Epoch: [14/ 80] | Train loss: [0.17319823991921213]
2022-03-30 00:33:24.715 | INFO     | tools.trainer:train_loop:89 - Epoch: [15/ 80] | Train loss: [0.1668495361175802]
2022-03-30 00:37:44.229 | INFO     | tools.trainer:train_loop:89 - Epoch: [16/ 80] | Train loss: [0.16962122337685692]
2022-03-30 00:42:04.026 | INFO     | tools.trainer:train_loop:89 - Epoch: [17/ 80] | Train loss: [0.16140684518549178]
2022-03-30 00:46:26.266 | INFO     | tools.trainer:train_loop:89 - Epoch: [18/ 80] | Train loss: [0.15600692191057736]
2022-03-30 00:50:45.795 | INFO     | tools.trainer:train_loop:89 - Epoch: [19/ 80] | Train loss: [0.14706360788808928]
2022-03-30 00:55:07.070 | INFO     | tools.trainer:train_loop:89 - Epoch: [20/ 80] | Train loss: [0.1446182246837351]
2022-03-30 00:59:27.202 | INFO     | tools.trainer:train_loop:89 - Epoch: [21/ 80] | Train loss: [0.1410969738331106]
2022-03-30 01:03:47.572 | INFO     | tools.trainer:train_loop:89 - Epoch: [22/ 80] | Train loss: [0.14443066087034012]
2022-03-30 01:08:08.288 | INFO     | tools.trainer:train_loop:89 - Epoch: [23/ 80] | Train loss: [0.1327866579923365]
2022-03-30 01:12:27.717 | INFO     | tools.trainer:train_loop:89 - Epoch: [24/ 80] | Train loss: [0.12986065207256212]
2022-03-30 01:16:47.023 | INFO     | tools.trainer:train_loop:89 - Epoch: [25/ 80] | Train loss: [0.12692104023363854]
2022-03-30 01:21:08.049 | INFO     | tools.trainer:train_loop:89 - Epoch: [26/ 80] | Train loss: [0.133656421634886]
2022-03-30 01:25:27.862 | INFO     | tools.trainer:train_loop:89 - Epoch: [27/ 80] | Train loss: [0.13079134970903397]
2022-03-30 01:29:49.835 | INFO     | tools.trainer:train_loop:89 - Epoch: [28/ 80] | Train loss: [0.1420798314942254]
2022-03-30 01:34:11.708 | INFO     | tools.trainer:train_loop:89 - Epoch: [29/ 80] | Train loss: [0.12514793756935333]
2022-03-30 01:38:32.149 | INFO     | tools.trainer:train_loop:89 - Epoch: [30/ 80] | Train loss: [0.1177244909107685]
2022-03-30 01:42:51.549 | INFO     | tools.trainer:train_loop:89 - Epoch: [31/ 80] | Train loss: [0.12076305680804783]
2022-03-30 01:47:11.629 | INFO     | tools.trainer:train_loop:89 - Epoch: [32/ 80] | Train loss: [0.11193511436382929]
2022-03-30 01:51:32.248 | INFO     | tools.trainer:train_loop:89 - Epoch: [33/ 80] | Train loss: [0.11061541206306881]
2022-03-30 01:55:51.470 | INFO     | tools.trainer:train_loop:89 - Epoch: [34/ 80] | Train loss: [0.1112257916894224]
2022-03-30 02:00:11.398 | INFO     | tools.trainer:train_loop:89 - Epoch: [35/ 80] | Train loss: [0.11676627786623107]
2022-03-30 02:04:31.257 | INFO     | tools.trainer:train_loop:89 - Epoch: [36/ 80] | Train loss: [0.11328345437844595]
2022-03-30 02:08:51.402 | INFO     | tools.trainer:train_loop:89 - Epoch: [37/ 80] | Train loss: [0.11350268431835704]
2022-03-30 02:13:09.739 | INFO     | tools.trainer:train_loop:89 - Epoch: [38/ 80] | Train loss: [0.10866194226675563]
2022-03-30 02:17:29.033 | INFO     | tools.trainer:train_loop:89 - Epoch: [39/ 80] | Train loss: [0.10546758613652653]
2022-03-30 02:21:48.010 | INFO     | tools.trainer:train_loop:89 - Epoch: [40/ 80] | Train loss: [0.10228908616635535]
2022-03-30 02:26:08.820 | INFO     | tools.trainer:train_loop:89 - Epoch: [41/ 80] | Train loss: [0.1006185913251506]
2022-03-30 02:30:28.133 | INFO     | tools.trainer:train_loop:89 - Epoch: [42/ 80] | Train loss: [0.10034888320498997]
2022-03-30 02:34:47.563 | INFO     | tools.trainer:train_loop:89 - Epoch: [43/ 80] | Train loss: [0.10865181510647139]
2022-03-30 02:39:07.912 | INFO     | tools.trainer:train_loop:89 - Epoch: [44/ 80] | Train loss: [0.1038565499915017]
2022-03-30 02:43:29.479 | INFO     | tools.trainer:train_loop:89 - Epoch: [45/ 80] | Train loss: [0.09940472584631709]
2022-03-30 02:47:52.026 | INFO     | tools.trainer:train_loop:89 - Epoch: [46/ 80] | Train loss: [0.0989766721924146]
2022-03-30 02:52:14.770 | INFO     | tools.trainer:train_loop:89 - Epoch: [47/ 80] | Train loss: [0.10607724181479877]
2022-03-30 02:56:37.061 | INFO     | tools.trainer:train_loop:89 - Epoch: [48/ 80] | Train loss: [0.0959874899023109]
2022-03-30 03:00:58.345 | INFO     | tools.trainer:train_loop:89 - Epoch: [49/ 80] | Train loss: [0.09218525985876719]
2022-03-30 03:05:18.784 | INFO     | tools.trainer:train_loop:89 - Epoch: [50/ 80] | Train loss: [0.08960160480605231]
2022-03-30 03:09:40.935 | INFO     | tools.trainer:train_loop:89 - Epoch: [51/ 80] | Train loss: [0.08979275839196312]
2022-03-30 03:14:00.687 | INFO     | tools.trainer:train_loop:89 - Epoch: [52/ 80] | Train loss: [0.09125401965445942]
2022-03-30 03:18:23.256 | INFO     | tools.trainer:train_loop:89 - Epoch: [53/ 80] | Train loss: [0.0870901420712471]
2022-03-30 03:22:48.813 | INFO     | tools.trainer:train_loop:89 - Epoch: [54/ 80] | Train loss: [0.08720499641365476]
2022-03-30 03:27:10.922 | INFO     | tools.trainer:train_loop:89 - Epoch: [55/ 80] | Train loss: [0.08588460824555821]
2022-03-30 03:31:33.922 | INFO     | tools.trainer:train_loop:89 - Epoch: [56/ 80] | Train loss: [0.08928291267818875]
2022-03-30 03:35:55.223 | INFO     | tools.trainer:train_loop:89 - Epoch: [57/ 80] | Train loss: [0.08509432259533141]
2022-03-30 03:40:16.199 | INFO     | tools.trainer:train_loop:89 - Epoch: [58/ 80] | Train loss: [0.081735859811306]
2022-03-30 03:44:38.097 | INFO     | tools.trainer:train_loop:89 - Epoch: [59/ 80] | Train loss: [0.08060238634546597]
2022-03-30 03:48:59.399 | INFO     | tools.trainer:train_loop:89 - Epoch: [60/ 80] | Train loss: [0.08011405641833941]
2022-03-30 03:53:19.412 | INFO     | tools.trainer:train_loop:89 - Epoch: [61/ 80] | Train loss: [0.07941586698095003]
2022-03-30 03:57:40.190 | INFO     | tools.trainer:train_loop:89 - Epoch: [62/ 80] | Train loss: [0.07920361227459377]
2022-03-30 04:02:03.533 | INFO     | tools.trainer:train_loop:89 - Epoch: [63/ 80] | Train loss: [0.07711885939869616]
2022-03-30 04:06:28.051 | INFO     | tools.trainer:train_loop:89 - Epoch: [64/ 80] | Train loss: [0.07630658273895581]
2022-03-30 04:10:51.237 | INFO     | tools.trainer:train_loop:89 - Epoch: [65/ 80] | Train loss: [0.07602946137388547]
2022-03-30 04:15:12.884 | INFO     | tools.trainer:train_loop:89 - Epoch: [66/ 80] | Train loss: [0.07638915441930294]
2022-03-30 04:19:34.433 | INFO     | tools.trainer:train_loop:89 - Epoch: [67/ 80] | Train loss: [0.07532685543927882]
2022-03-30 04:23:57.228 | INFO     | tools.trainer:train_loop:89 - Epoch: [68/ 80] | Train loss: [0.07427400172584586]
2022-03-30 04:28:16.300 | INFO     | tools.trainer:train_loop:89 - Epoch: [69/ 80] | Train loss: [0.07305622390574878]
2022-03-30 04:32:38.484 | INFO     | tools.trainer:train_loop:89 - Epoch: [70/ 80] | Train loss: [0.07261989720993572]
2022-03-30 04:36:46.311 | INFO     | tools.trainer:train_loop:89 - Epoch: [71/ 80] | Train loss: [0.07135677221748564]
2022-03-30 04:40:43.677 | INFO     | tools.trainer:train_loop:89 - Epoch: [72/ 80] | Train loss: [0.07131053304506672]
2022-03-30 04:44:39.738 | INFO     | tools.trainer:train_loop:89 - Epoch: [73/ 80] | Train loss: [0.07014661841094494]
2022-03-30 04:48:36.365 | INFO     | tools.trainer:train_loop:89 - Epoch: [74/ 80] | Train loss: [0.07063308383027712]
2022-03-30 04:52:32.529 | INFO     | tools.trainer:train_loop:89 - Epoch: [75/ 80] | Train loss: [0.06991621574593915]
2022-03-30 04:56:28.277 | INFO     | tools.trainer:train_loop:89 - Epoch: [76/ 80] | Train loss: [0.06880425252020358]
2022-03-30 05:00:23.376 | INFO     | tools.trainer:train_loop:89 - Epoch: [77/ 80] | Train loss: [0.06852673271463977]
2022-03-30 05:04:18.885 | INFO     | tools.trainer:train_loop:89 - Epoch: [78/ 80] | Train loss: [0.06786064596639739]
2022-03-30 05:08:14.731 | INFO     | tools.trainer:train_loop:89 - Epoch: [79/ 80] | Train loss: [0.06768057880302271]
2022-03-30 05:08:14.935 | INFO     | tools.trainer:train_loop:104 - [Saving Snapshot:]/mnt/data/hungpv/polyps/checkpoint/KCECE/pvtv2-uperhead_v9/PVTv2-B3-UPerHead_79.pth
2022-03-30 05:12:11.058 | INFO     | tools.trainer:train_loop:89 - Epoch: [80/ 80] | Train loss: [0.06708523788385921]
2022-03-30 05:12:11.258 | INFO     | tools.trainer:train_loop:104 - [Saving Snapshot:]/mnt/data/hungpv/polyps/checkpoint/KCECE/pvtv2-uperhead_v9/PVTv2-B3-UPerHead_80.pth
2022-03-30 05:12:11.259 | INFO     | tools.trainer:train_loop:110 - Training cost: 20615.679518869seconds
