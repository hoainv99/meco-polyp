2023-06-04 20:05:22.342 | INFO     | __main__:main:57 - Load config from configs/neo_small.yaml
2023-06-04 20:05:22.342 | INFO     | __main__:main:58 - {'dataset': {'data_path': '/root/neo_code_reco/bkai-igh-neopolyp', 'train_data_path': ['/root/neo_code_reco/bkai-igh-neopolyp'], 'test_data_path': ['/root/neo_code/bkai-igh-neopolyp/test/test'], 'val_data_path': ['/root/neo_code_reco/bkai-igh-neopolyp']}, 'model': {'num_classes': 3, 'save_dir': '/root/neo_code_reco/configs/checkpoint_0406', 'backbone': 'MiT-B3', 'head': 'FaPNHead', 'pretrained': 'mit_b3.pth'}, 'optimizer': {'name': 'adam', 'lr': 0.0001, 'clip': 0.5, 'scheduler': 'cosine_warmup', 'loss': 'multi_structure_loss'}, 'dev': 'cuda', 'train': {'start_from': 0, 'save_from': 99, 'num_epochs': 100, 'num_warmup_epoch': 8, 'is_val': False, 'size_rates': [0.75, 1, 1.25], 'dataloader': {'batchsize': 8, 'img_size': 384, 'shuffle': True, 'num_workers': 4, 'pin_memory': True, 'drop_last': True}, 'amp': False, 'ddp': False, 'augment': {'prob': 1, 'Flip_prob': 0.5, 'HueSaturationValue_prob': 0.5, 'RandomBrightnessContrast_prob': 0.5, 'crop_prob': 0.0, 'randomrotate90_prob': 0.5, 'ColorJitter_prob': 0.5}, 'augment_weak': {'prob': 1, 'Flip_prob': 0.5}}, 'val': {'dataloader': {'batchsize': 8, 'img_size': 384, 'shuffle': True, 'num_workers': 4, 'pin_memory': True, 'drop_last': False}}, 'test': {'dev': 'cuda', 'visualize': True, 'visualize_dir': '/root/neo_code_reco/neo_visualize', 'vis_x': 180, 'vis_overwrite': False, 'checkpoint_dir': '/root/neo_code_reco/configs/checkpoint_mb_with_local/MiT-B3-FaPNHead_100.pth', 'dataloader': {'batchsize': 1, 'img_size': 384, 'shuffle': True, 'num_workers': 4, 'pin_memory': True, 'drop_last': False}, 'augment': {'prob': 1, 'Flip_prob': 0, 'HueSaturationValue_prob': 0, 'RandomBrightnessContrast_prob': 0, 'crop_prob': 0, 'randomrotate90_prob': 0, 'elastictransform_prob': 0, 'gridistortion_prob': 0, 'opticaldistortion_prob': 0, 'verticalflip_prob': 0, 'horizontalflip_prob': 0, 'randomgamma_prob': 0, 'CoarseDropout_prob': 0, 'RGBShift_prob': 0, 'MotionBlur_prob': 0, 'MedianBlur_prob': 0, 'GaussianBlur_prob': 0, 'GaussNoise_prob': 0, 'ChannelShuffle_prob': 0}}}
2023-06-04 20:05:22.342 | INFO     | __main__:main:59 - Getting datapath
2023-06-04 20:05:22.350 | INFO     | __main__:main:74 - There are 1000 images to train
2023-06-04 20:05:22.351 | INFO     | __main__:main:93 - Train model with no valid dataset
2023-06-04 20:05:22.351 | INFO     | __main__:main:95 - Loading data
2023-06-04 20:05:22.728 | INFO     | __main__:main:112 - 125 batches to train
2023-06-04 20:05:22.729 | INFO     | __main__:main:125 - Loading model
2023-06-04 20:05:22.729 | INFO     | __main__:main:146 - Loading checkpoint from mit_b3.pth ...
2023-06-04 20:05:27.700 | INFO     | __main__:main:190 - Training with FP32 ...
2023-06-04 20:10:35.045 | INFO     | trainer:train_loop:185 - Epoch: [1/ 100] | Train loss: [1.627892264842987]
2023-06-04 20:15:43.746 | INFO     | trainer:train_loop:185 - Epoch: [2/ 100] | Train loss: [0.6803486070632935]
2023-06-04 20:20:54.859 | INFO     | trainer:train_loop:185 - Epoch: [3/ 100] | Train loss: [0.5909727084636688]
2023-06-04 20:26:05.290 | INFO     | trainer:train_loop:185 - Epoch: [4/ 100] | Train loss: [0.4044445358514786]
2023-06-04 20:31:15.605 | INFO     | trainer:train_loop:185 - Epoch: [5/ 100] | Train loss: [0.36496676874160766]
2023-06-04 20:36:27.003 | INFO     | trainer:train_loop:185 - Epoch: [6/ 100] | Train loss: [0.3312282326221466]
2023-06-04 20:41:37.604 | INFO     | trainer:train_loop:185 - Epoch: [7/ 100] | Train loss: [0.2814275265932083]
2023-06-04 20:46:49.514 | INFO     | trainer:train_loop:185 - Epoch: [8/ 100] | Train loss: [0.23771934533119202]
2023-06-04 20:52:02.526 | INFO     | trainer:train_loop:185 - Epoch: [9/ 100] | Train loss: [0.23108106648921967]
2023-06-04 20:57:14.051 | INFO     | trainer:train_loop:185 - Epoch: [10/ 100] | Train loss: [0.22668137913942338]
2023-06-04 21:02:26.556 | INFO     | trainer:train_loop:185 - Epoch: [11/ 100] | Train loss: [0.2079131652712822]
2023-06-04 21:07:38.551 | INFO     | trainer:train_loop:185 - Epoch: [12/ 100] | Train loss: [0.20274042463302613]
2023-06-04 21:12:50.807 | INFO     | trainer:train_loop:185 - Epoch: [13/ 100] | Train loss: [0.1702419212758541]
2023-06-04 21:18:03.084 | INFO     | trainer:train_loop:185 - Epoch: [14/ 100] | Train loss: [0.1603807006776333]
2023-06-04 21:23:15.642 | INFO     | trainer:train_loop:185 - Epoch: [15/ 100] | Train loss: [0.1526658700108528]
2023-06-04 21:28:26.509 | INFO     | trainer:train_loop:185 - Epoch: [16/ 100] | Train loss: [0.13935996505618095]
2023-06-04 21:33:37.984 | INFO     | trainer:train_loop:185 - Epoch: [17/ 100] | Train loss: [0.135284997433424]
2023-06-04 21:38:48.954 | INFO     | trainer:train_loop:185 - Epoch: [18/ 100] | Train loss: [0.12833291164040567]
2023-06-04 21:44:01.815 | INFO     | trainer:train_loop:185 - Epoch: [19/ 100] | Train loss: [0.11637009701132775]
2023-06-04 21:49:14.962 | INFO     | trainer:train_loop:185 - Epoch: [20/ 100] | Train loss: [0.11557356548309326]
2023-06-04 21:54:27.042 | INFO     | trainer:train_loop:185 - Epoch: [21/ 100] | Train loss: [0.10660279300808907]
2023-06-04 21:59:39.111 | INFO     | trainer:train_loop:185 - Epoch: [22/ 100] | Train loss: [0.1072327241897583]
2023-06-04 22:04:51.942 | INFO     | trainer:train_loop:185 - Epoch: [23/ 100] | Train loss: [0.10276138290762901]
2023-06-04 22:10:05.770 | INFO     | trainer:train_loop:185 - Epoch: [24/ 100] | Train loss: [0.10325003853440284]
2023-06-04 22:15:17.817 | INFO     | trainer:train_loop:185 - Epoch: [25/ 100] | Train loss: [0.09085789555311204]
2023-06-04 22:20:29.961 | INFO     | trainer:train_loop:185 - Epoch: [26/ 100] | Train loss: [0.10240472754836083]
2023-06-04 22:25:41.775 | INFO     | trainer:train_loop:185 - Epoch: [27/ 100] | Train loss: [0.09755422151088715]
2023-06-04 22:30:54.449 | INFO     | trainer:train_loop:185 - Epoch: [28/ 100] | Train loss: [0.0967156631052494]
2023-06-04 22:36:06.590 | INFO     | trainer:train_loop:185 - Epoch: [29/ 100] | Train loss: [0.09068785777688027]
2023-06-04 22:41:20.007 | INFO     | trainer:train_loop:185 - Epoch: [30/ 100] | Train loss: [0.08515496379137039]
2023-06-04 22:46:32.179 | INFO     | trainer:train_loop:185 - Epoch: [31/ 100] | Train loss: [0.08240676632523537]
2023-06-04 22:51:45.954 | INFO     | trainer:train_loop:185 - Epoch: [32/ 100] | Train loss: [0.08647787126898765]
2023-06-04 22:57:00.091 | INFO     | trainer:train_loop:185 - Epoch: [33/ 100] | Train loss: [0.09180834853649139]
2023-06-04 23:02:15.772 | INFO     | trainer:train_loop:185 - Epoch: [34/ 100] | Train loss: [0.07405155947804451]
2023-06-04 23:07:27.116 | INFO     | trainer:train_loop:185 - Epoch: [35/ 100] | Train loss: [0.08168586480617523]
2023-06-04 23:12:38.579 | INFO     | trainer:train_loop:185 - Epoch: [36/ 100] | Train loss: [0.07694246533513069]
2023-06-04 23:17:53.120 | INFO     | trainer:train_loop:185 - Epoch: [37/ 100] | Train loss: [0.07438347896933556]
2023-06-04 23:23:05.219 | INFO     | trainer:train_loop:185 - Epoch: [38/ 100] | Train loss: [0.06954456874728203]
2023-06-04 23:28:18.849 | INFO     | trainer:train_loop:185 - Epoch: [39/ 100] | Train loss: [0.07182087868452072]
2023-06-04 23:33:33.048 | INFO     | trainer:train_loop:185 - Epoch: [40/ 100] | Train loss: [0.06815721797943115]
2023-06-04 23:38:44.880 | INFO     | trainer:train_loop:185 - Epoch: [41/ 100] | Train loss: [0.05918704915046692]
2023-06-04 23:43:57.907 | INFO     | trainer:train_loop:185 - Epoch: [42/ 100] | Train loss: [0.07967625242471695]
2023-06-04 23:49:11.307 | INFO     | trainer:train_loop:185 - Epoch: [43/ 100] | Train loss: [0.067914271697402]
2023-06-04 23:54:24.428 | INFO     | trainer:train_loop:185 - Epoch: [44/ 100] | Train loss: [0.06037313559651375]
2023-06-04 23:59:37.044 | INFO     | trainer:train_loop:185 - Epoch: [45/ 100] | Train loss: [0.0607982003390789]
2023-06-05 00:04:49.282 | INFO     | trainer:train_loop:185 - Epoch: [46/ 100] | Train loss: [0.060438247069716455]
2023-06-05 00:10:03.118 | INFO     | trainer:train_loop:185 - Epoch: [47/ 100] | Train loss: [0.05593037831783294]
2023-06-05 00:15:18.732 | INFO     | trainer:train_loop:185 - Epoch: [48/ 100] | Train loss: [0.06058082956075668]
2023-06-05 00:20:30.435 | INFO     | trainer:train_loop:185 - Epoch: [49/ 100] | Train loss: [0.05609873609244823]
2023-06-05 00:25:44.770 | INFO     | trainer:train_loop:185 - Epoch: [50/ 100] | Train loss: [0.058296279400587084]
2023-06-05 00:30:59.622 | INFO     | trainer:train_loop:185 - Epoch: [51/ 100] | Train loss: [0.05998282825946808]
2023-06-05 00:36:11.366 | INFO     | trainer:train_loop:185 - Epoch: [52/ 100] | Train loss: [0.05950657424330712]
2023-06-05 00:41:23.178 | INFO     | trainer:train_loop:185 - Epoch: [53/ 100] | Train loss: [0.05518878582119942]
2023-06-05 00:46:37.223 | INFO     | trainer:train_loop:185 - Epoch: [54/ 100] | Train loss: [0.05418317280709743]
2023-06-05 00:51:50.977 | INFO     | trainer:train_loop:185 - Epoch: [55/ 100] | Train loss: [0.053615655675530435]
2023-06-05 00:57:04.932 | INFO     | trainer:train_loop:185 - Epoch: [56/ 100] | Train loss: [0.05473810528218746]
2023-06-05 01:02:16.533 | INFO     | trainer:train_loop:185 - Epoch: [57/ 100] | Train loss: [0.059170749843120575]
2023-06-05 01:07:33.755 | INFO     | trainer:train_loop:185 - Epoch: [58/ 100] | Train loss: [0.053781345754861834]
2023-06-05 01:12:46.821 | INFO     | trainer:train_loop:185 - Epoch: [59/ 100] | Train loss: [0.05064412234723568]
2023-06-05 01:17:59.580 | INFO     | trainer:train_loop:185 - Epoch: [60/ 100] | Train loss: [0.050798619851469995]
2023-06-05 01:23:14.317 | INFO     | trainer:train_loop:185 - Epoch: [61/ 100] | Train loss: [0.04961241041123867]
2023-06-05 01:28:28.847 | INFO     | trainer:train_loop:185 - Epoch: [62/ 100] | Train loss: [0.04840218822658062]
2023-06-05 01:33:41.223 | INFO     | trainer:train_loop:185 - Epoch: [63/ 100] | Train loss: [0.05015981456637383]
2023-06-05 01:38:58.513 | INFO     | trainer:train_loop:185 - Epoch: [64/ 100] | Train loss: [0.048938801988959314]
2023-06-05 01:44:11.650 | INFO     | trainer:train_loop:185 - Epoch: [65/ 100] | Train loss: [0.0476452913582325]
2023-06-05 01:49:25.693 | INFO     | trainer:train_loop:185 - Epoch: [66/ 100] | Train loss: [0.05263764330744743]
2023-06-05 01:54:38.150 | INFO     | trainer:train_loop:185 - Epoch: [67/ 100] | Train loss: [0.052515041872859]
2023-06-05 01:59:51.644 | INFO     | trainer:train_loop:185 - Epoch: [68/ 100] | Train loss: [0.04900908035039902]
2023-06-05 02:05:04.692 | INFO     | trainer:train_loop:185 - Epoch: [69/ 100] | Train loss: [0.04595203897356987]
2023-06-05 02:10:17.167 | INFO     | trainer:train_loop:185 - Epoch: [70/ 100] | Train loss: [0.04817742069065571]
2023-06-05 02:15:29.822 | INFO     | trainer:train_loop:185 - Epoch: [71/ 100] | Train loss: [0.0455909406542778]
2023-06-05 02:20:43.009 | INFO     | trainer:train_loop:185 - Epoch: [72/ 100] | Train loss: [0.044892686411738394]
2023-06-05 02:25:55.654 | INFO     | trainer:train_loop:185 - Epoch: [73/ 100] | Train loss: [0.04616659039258957]
2023-06-05 02:31:08.847 | INFO     | trainer:train_loop:185 - Epoch: [74/ 100] | Train loss: [0.047205770552158355]
2023-06-05 02:36:23.046 | INFO     | trainer:train_loop:185 - Epoch: [75/ 100] | Train loss: [0.0452619491815567]
2023-06-05 02:41:37.948 | INFO     | trainer:train_loop:185 - Epoch: [76/ 100] | Train loss: [0.045545562028884885]
2023-06-05 02:46:55.297 | INFO     | trainer:train_loop:185 - Epoch: [77/ 100] | Train loss: [0.04568251058459282]
2023-06-05 02:52:08.581 | INFO     | trainer:train_loop:185 - Epoch: [78/ 100] | Train loss: [0.043618436977267264]
2023-06-05 02:57:23.995 | INFO     | trainer:train_loop:185 - Epoch: [79/ 100] | Train loss: [0.044080378487706184]
2023-06-05 03:02:38.634 | INFO     | trainer:train_loop:185 - Epoch: [80/ 100] | Train loss: [0.04450260473787784]
2023-06-05 03:07:56.028 | INFO     | trainer:train_loop:185 - Epoch: [81/ 100] | Train loss: [0.042736287549138066]
2023-06-05 03:13:11.941 | INFO     | trainer:train_loop:185 - Epoch: [82/ 100] | Train loss: [0.043200189784169195]
2023-06-05 03:18:25.997 | INFO     | trainer:train_loop:185 - Epoch: [83/ 100] | Train loss: [0.04280724745988846]
2023-06-05 03:23:40.052 | INFO     | trainer:train_loop:185 - Epoch: [84/ 100] | Train loss: [0.04191942916810513]
2023-06-05 03:28:53.504 | INFO     | trainer:train_loop:185 - Epoch: [85/ 100] | Train loss: [0.04294966021180153]
2023-06-05 03:34:06.680 | INFO     | trainer:train_loop:185 - Epoch: [86/ 100] | Train loss: [0.042292137160897254]
2023-06-05 03:39:20.437 | INFO     | trainer:train_loop:185 - Epoch: [87/ 100] | Train loss: [0.0423128263503313]
2023-06-05 03:44:35.016 | INFO     | trainer:train_loop:185 - Epoch: [88/ 100] | Train loss: [0.04081971304118633]
2023-06-05 03:49:49.046 | INFO     | trainer:train_loop:185 - Epoch: [89/ 100] | Train loss: [0.04159359227120876]
2023-06-05 03:55:01.309 | INFO     | trainer:train_loop:185 - Epoch: [90/ 100] | Train loss: [0.041488065659999844]
2023-06-05 04:00:16.649 | INFO     | trainer:train_loop:185 - Epoch: [91/ 100] | Train loss: [0.04087300635874271]
2023-06-05 04:05:31.934 | INFO     | trainer:train_loop:185 - Epoch: [92/ 100] | Train loss: [0.04085894685983658]
2023-06-05 04:10:44.372 | INFO     | trainer:train_loop:185 - Epoch: [93/ 100] | Train loss: [0.04089835046231747]
2023-06-05 04:15:59.468 | INFO     | trainer:train_loop:185 - Epoch: [94/ 100] | Train loss: [0.0409799197614193]
2023-06-05 04:21:14.670 | INFO     | trainer:train_loop:185 - Epoch: [95/ 100] | Train loss: [0.041060953825712204]
2023-06-05 04:26:31.558 | INFO     | trainer:train_loop:185 - Epoch: [96/ 100] | Train loss: [0.04116235503554344]
2023-06-05 04:31:46.885 | INFO     | trainer:train_loop:185 - Epoch: [97/ 100] | Train loss: [0.04209017589688301]
2023-06-05 04:37:00.023 | INFO     | trainer:train_loop:185 - Epoch: [98/ 100] | Train loss: [0.04146466998755932]
2023-06-05 04:42:16.590 | INFO     | trainer:train_loop:185 - Epoch: [99/ 100] | Train loss: [0.04122454667091369]
2023-06-05 04:47:30.655 | INFO     | trainer:train_loop:185 - Epoch: [100/ 100] | Train loss: [0.041876011669635775]
2023-06-05 04:47:31.351 | INFO     | trainer:train_loop:206 - [Saving Snapshot:]/root/neo_code_reco/configs/checkpoint_0406/MiT-B3-FaPNHead_100.pth
2023-06-05 04:47:31.352 | INFO     | trainer:train_loop:215 - Training cost: 31322.16005525738seconds
