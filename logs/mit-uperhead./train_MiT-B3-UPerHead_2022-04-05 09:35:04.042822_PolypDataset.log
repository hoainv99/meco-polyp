2022-04-05 09:35:04.044 | INFO     | __main__:main:45 - Load config from configs/mit-uperhead.yaml
2022-04-05 09:35:04.044 | INFO     | __main__:main:46 - {'dataset': {'data_path': '/home/admin_mcn/hungpv/polyps/dataset/KCECE', 'train_data_path': ['/home/admin_mcn/hungpv/polyps/dataset/KCECE/TrainDataset'], 'test_data_path': ['/home/admin_mcn/hungpv/polyps/dataset/KCECE/TestDataset/CVC-300'], 'val_data_path': ['/home/admin_mcn/hungpv/polyps/dataset/KCECE/TestDataset/CVC-300']}, 'model': {'num_classes': 1, 'save_dir': '/mnt/data/hungpv/polyps/checkpoint/KCECE/mit-uperhead_v1', 'backbone': 'MiT-B3', 'head': 'UPerHead', 'pretrained': '/mnt/data/hungpv/polyps/pretrained-backbone/mit_b3.pth'}, 'optimizer': {'name': 'adam', 'lr': 0.0001, 'clip': 0.5, 'scheduler': 'cosine_warmup', 'loss': 'structure_loss'}, 'dev': 'cuda', 'train': {'start_from': 0, 'save_from': 78, 'num_epochs': 80, 'num_warmup_epoch': 10, 'is_val': False, 'size_rates': [0.75, 1, 1.25], 'dataloader': {'batchsize': 16, 'img_size': 352, 'shuffle': True, 'num_workers': 2, 'pin_memory': True, 'drop_last': True}, 'amp': False, 'ddp': False, 'augment': {'prob': 1, 'Flip_prob': 0.7, 'HueSaturationValue_prob': 0.7, 'RandomBrightnessContrast_prob': 0.5, 'crop_prob': 0.0, 'randomrotate90_prob': 0.7}}, 'test': {'dev': 'cuda', 'visualize': False, 'visualize_dir': '/mnt/data/hungpv/polyps/visualize', 'vis_x': 180, 'vis_overwrite': False, 'checkpoint_dir': '/mnt/data/hungpv/polyps/checkpoint/KCECE/mit-uperhead_v1/MiT-B3-UPerHead_80.pth', 'dataloader': {'batchsize': 1, 'img_size': 352, 'shuffle': True, 'num_workers': 2, 'pin_memory': True, 'drop_last': True}, 'augment': {'prob': 1, 'Flip_prob': 0, 'HueSaturationValue_prob': 0, 'RandomBrightnessContrast_prob': 0, 'crop_prob': 0, 'randomrotate90_prob': 0, 'elastictransform_prob': 0, 'gridistortion_prob': 0, 'opticaldistortion_prob': 0, 'verticalflip_prob': 0, 'horizontalflip_prob': 0, 'randomgamma_prob': 0, 'CoarseDropout_prob': 0, 'RGBShift_prob': 0, 'MotionBlur_prob': 0, 'MedianBlur_prob': 0, 'GaussianBlur_prob': 0, 'GaussNoise_prob': 0, 'ChannelShuffle_prob': 0}}}
2022-04-05 09:35:04.044 | INFO     | __main__:main:47 - Getting datapath
2022-04-05 09:35:04.050 | INFO     | __main__:main:61 - There are 1450 images to train
2022-04-05 09:35:04.051 | INFO     | __main__:main:80 - Train model with no valid dataset
2022-04-05 09:35:04.051 | INFO     | __main__:main:82 - Loading data
2022-04-05 09:35:04.139 | INFO     | __main__:main:96 - 90 batches to train
2022-04-05 09:35:04.143 | INFO     | __main__:main:109 - Loading model
2022-04-05 09:35:04.143 | INFO     | __main__:main:126 - Loading checkpoint from /mnt/data/hungpv/polyps/pretrained-backbone/mit_b3.pth ...
2022-04-05 09:35:06.768 | INFO     | __main__:main:164 - Training with FP32 ...
2022-04-05 09:37:44.343 | INFO     | tools.trainer:train_loop:89 - Epoch: [1/ 80] | Train loss: [1.1599738823042975]
2022-04-05 09:40:22.857 | INFO     | tools.trainer:train_loop:89 - Epoch: [2/ 80] | Train loss: [0.6265563093953662]
2022-04-05 09:43:01.259 | INFO     | tools.trainer:train_loop:89 - Epoch: [3/ 80] | Train loss: [0.4798414823081758]
2022-04-05 09:43:01.944 | INFO     | tools.trainer:train_loop:104 - [Saving Snapshot:]/mnt/data/hungpv/polyps/checkpoint/KCECE/mit-uperhead_v1/MiT-B3-UPerHead_3.pth
2022-04-05 09:45:41.606 | INFO     | tools.trainer:train_loop:89 - Epoch: [4/ 80] | Train loss: [0.3811758619215753]
2022-04-05 09:48:21.314 | INFO     | tools.trainer:train_loop:89 - Epoch: [5/ 80] | Train loss: [0.32189222243097093]
2022-04-05 09:51:01.736 | INFO     | tools.trainer:train_loop:89 - Epoch: [6/ 80] | Train loss: [0.2824064893854989]
2022-04-05 09:53:41.690 | INFO     | tools.trainer:train_loop:89 - Epoch: [7/ 80] | Train loss: [0.2608068618509505]
2022-04-05 09:56:21.402 | INFO     | tools.trainer:train_loop:89 - Epoch: [8/ 80] | Train loss: [0.22572568555672964]
2022-04-05 09:59:02.536 | INFO     | tools.trainer:train_loop:89 - Epoch: [9/ 80] | Train loss: [0.21920535332626767]
2022-04-05 10:01:42.527 | INFO     | tools.trainer:train_loop:89 - Epoch: [10/ 80] | Train loss: [0.207443348897828]
2022-04-05 10:04:22.522 | INFO     | tools.trainer:train_loop:89 - Epoch: [11/ 80] | Train loss: [0.1938777431845665]
2022-04-05 10:07:02.512 | INFO     | tools.trainer:train_loop:89 - Epoch: [12/ 80] | Train loss: [0.1822852944334348]
2022-04-05 10:09:41.604 | INFO     | tools.trainer:train_loop:89 - Epoch: [13/ 80] | Train loss: [0.18196427267458704]
2022-04-05 10:12:21.468 | INFO     | tools.trainer:train_loop:89 - Epoch: [14/ 80] | Train loss: [0.16965143448776668]
2022-04-05 10:15:01.891 | INFO     | tools.trainer:train_loop:89 - Epoch: [15/ 80] | Train loss: [0.16751763357056512]
2022-04-05 10:17:42.848 | INFO     | tools.trainer:train_loop:89 - Epoch: [16/ 80] | Train loss: [0.16032417019208273]
2022-04-05 10:20:22.969 | INFO     | tools.trainer:train_loop:89 - Epoch: [17/ 80] | Train loss: [0.157260526302788]
2022-04-05 10:23:04.317 | INFO     | tools.trainer:train_loop:89 - Epoch: [18/ 80] | Train loss: [0.16083561819460657]
2022-04-05 10:25:44.639 | INFO     | tools.trainer:train_loop:89 - Epoch: [19/ 80] | Train loss: [0.1569795333676868]
2022-04-05 10:28:24.056 | INFO     | tools.trainer:train_loop:89 - Epoch: [20/ 80] | Train loss: [0.14228371555606525]
2022-04-05 10:31:04.062 | INFO     | tools.trainer:train_loop:89 - Epoch: [21/ 80] | Train loss: [0.1457330868475967]
2022-04-05 10:33:43.294 | INFO     | tools.trainer:train_loop:89 - Epoch: [22/ 80] | Train loss: [0.14969063955876563]
2022-04-05 10:36:23.269 | INFO     | tools.trainer:train_loop:89 - Epoch: [23/ 80] | Train loss: [0.13403488207194542]
2022-04-05 10:39:05.569 | INFO     | tools.trainer:train_loop:89 - Epoch: [24/ 80] | Train loss: [0.1392639575733079]
2022-04-05 10:41:45.830 | INFO     | tools.trainer:train_loop:89 - Epoch: [25/ 80] | Train loss: [0.13370410518513787]
2022-04-05 10:44:26.079 | INFO     | tools.trainer:train_loop:89 - Epoch: [26/ 80] | Train loss: [0.13009077981114386]
2022-04-05 10:47:06.791 | INFO     | tools.trainer:train_loop:89 - Epoch: [27/ 80] | Train loss: [0.12639855022231739]
2022-04-05 10:49:46.639 | INFO     | tools.trainer:train_loop:89 - Epoch: [28/ 80] | Train loss: [0.123314708388514]
2022-04-05 10:52:26.535 | INFO     | tools.trainer:train_loop:89 - Epoch: [29/ 80] | Train loss: [0.13520267208417255]
2022-04-05 10:55:06.319 | INFO     | tools.trainer:train_loop:89 - Epoch: [30/ 80] | Train loss: [0.1270512416958809]
2022-04-05 10:57:47.906 | INFO     | tools.trainer:train_loop:89 - Epoch: [31/ 80] | Train loss: [0.1181941035721037]
2022-04-05 11:00:28.170 | INFO     | tools.trainer:train_loop:89 - Epoch: [32/ 80] | Train loss: [0.11686648544338014]
2022-04-05 11:03:08.995 | INFO     | tools.trainer:train_loop:89 - Epoch: [33/ 80] | Train loss: [0.11311229351494047]
2022-04-05 11:05:48.502 | INFO     | tools.trainer:train_loop:89 - Epoch: [34/ 80] | Train loss: [0.1109300538069672]
2022-04-05 11:08:28.496 | INFO     | tools.trainer:train_loop:89 - Epoch: [35/ 80] | Train loss: [0.1086430862545967]
2022-04-05 11:11:08.762 | INFO     | tools.trainer:train_loop:89 - Epoch: [36/ 80] | Train loss: [0.11143445173899333]
2022-04-05 11:13:48.356 | INFO     | tools.trainer:train_loop:89 - Epoch: [37/ 80] | Train loss: [0.1149694851703114]
2022-04-05 11:16:27.191 | INFO     | tools.trainer:train_loop:89 - Epoch: [38/ 80] | Train loss: [0.11002149515681797]
2022-04-05 11:19:07.050 | INFO     | tools.trainer:train_loop:89 - Epoch: [39/ 80] | Train loss: [0.10825524967577722]
2022-04-05 11:21:46.416 | INFO     | tools.trainer:train_loop:89 - Epoch: [40/ 80] | Train loss: [0.10612175746096505]
2022-04-05 11:24:26.172 | INFO     | tools.trainer:train_loop:89 - Epoch: [41/ 80] | Train loss: [0.10337207267681757]
2022-04-05 11:27:05.870 | INFO     | tools.trainer:train_loop:89 - Epoch: [42/ 80] | Train loss: [0.10039853900671006]
2022-04-05 11:29:44.497 | INFO     | tools.trainer:train_loop:89 - Epoch: [43/ 80] | Train loss: [0.09998455428414875]
2022-04-05 11:32:23.855 | INFO     | tools.trainer:train_loop:89 - Epoch: [44/ 80] | Train loss: [0.10124795776274469]
2022-04-05 11:35:03.083 | INFO     | tools.trainer:train_loop:89 - Epoch: [45/ 80] | Train loss: [0.10122897716032134]
2022-04-05 11:37:42.378 | INFO     | tools.trainer:train_loop:89 - Epoch: [46/ 80] | Train loss: [0.09784118524856038]
2022-04-05 11:40:22.848 | INFO     | tools.trainer:train_loop:89 - Epoch: [47/ 80] | Train loss: [0.09440144971013069]
2022-04-05 11:43:03.415 | INFO     | tools.trainer:train_loop:89 - Epoch: [48/ 80] | Train loss: [0.09341537165972921]
2022-04-05 11:45:45.256 | INFO     | tools.trainer:train_loop:89 - Epoch: [49/ 80] | Train loss: [0.09118455582194858]
2022-04-05 11:48:25.627 | INFO     | tools.trainer:train_loop:89 - Epoch: [50/ 80] | Train loss: [0.09059838892685043]
2022-04-05 11:51:05.729 | INFO     | tools.trainer:train_loop:89 - Epoch: [51/ 80] | Train loss: [0.0899099367360274]
2022-04-05 11:53:45.422 | INFO     | tools.trainer:train_loop:89 - Epoch: [52/ 80] | Train loss: [0.08696861763795218]
2022-04-05 11:56:25.868 | INFO     | tools.trainer:train_loop:89 - Epoch: [53/ 80] | Train loss: [0.08714465755555365]
2022-04-05 11:59:06.473 | INFO     | tools.trainer:train_loop:89 - Epoch: [54/ 80] | Train loss: [0.08488378317819702]
2022-04-05 12:01:46.138 | INFO     | tools.trainer:train_loop:89 - Epoch: [55/ 80] | Train loss: [0.08535105031397608]
2022-04-05 12:04:26.411 | INFO     | tools.trainer:train_loop:89 - Epoch: [56/ 80] | Train loss: [0.08385885887675815]
2022-04-05 12:07:05.191 | INFO     | tools.trainer:train_loop:89 - Epoch: [57/ 80] | Train loss: [0.08264785210291545]
2022-04-05 12:09:45.404 | INFO     | tools.trainer:train_loop:89 - Epoch: [58/ 80] | Train loss: [0.08295808691117498]
2022-04-05 12:12:25.478 | INFO     | tools.trainer:train_loop:89 - Epoch: [59/ 80] | Train loss: [0.08223211425873968]
2022-04-05 12:15:04.866 | INFO     | tools.trainer:train_loop:89 - Epoch: [60/ 80] | Train loss: [0.07971929270360205]
2022-04-05 12:15:05.069 | INFO     | tools.trainer:train_loop:104 - [Saving Snapshot:]/mnt/data/hungpv/polyps/checkpoint/KCECE/mit-uperhead_v1/MiT-B3-UPerHead_60.pth
2022-04-05 12:17:44.268 | INFO     | tools.trainer:train_loop:89 - Epoch: [61/ 80] | Train loss: [0.07948402480946647]
2022-04-05 12:20:24.300 | INFO     | tools.trainer:train_loop:89 - Epoch: [62/ 80] | Train loss: [0.07767108376655314]
2022-04-05 12:23:03.782 | INFO     | tools.trainer:train_loop:89 - Epoch: [63/ 80] | Train loss: [0.07708320986065599]
2022-04-05 12:25:42.074 | INFO     | tools.trainer:train_loop:89 - Epoch: [64/ 80] | Train loss: [0.07660390651888317]
2022-04-05 12:28:21.828 | INFO     | tools.trainer:train_loop:89 - Epoch: [65/ 80] | Train loss: [0.07572772693302897]
2022-04-05 12:31:01.671 | INFO     | tools.trainer:train_loop:89 - Epoch: [66/ 80] | Train loss: [0.07461382560431958]
2022-04-05 12:33:41.994 | INFO     | tools.trainer:train_loop:89 - Epoch: [67/ 80] | Train loss: [0.07540113946629895]
2022-04-05 12:36:21.735 | INFO     | tools.trainer:train_loop:89 - Epoch: [68/ 80] | Train loss: [0.07286049371792211]
2022-04-05 12:39:01.710 | INFO     | tools.trainer:train_loop:89 - Epoch: [69/ 80] | Train loss: [0.07177722358869182]
2022-04-05 12:41:42.069 | INFO     | tools.trainer:train_loop:89 - Epoch: [70/ 80] | Train loss: [0.07140485226280159]
2022-04-05 12:44:21.722 | INFO     | tools.trainer:train_loop:89 - Epoch: [71/ 80] | Train loss: [0.07107744295563963]
2022-04-05 12:47:01.054 | INFO     | tools.trainer:train_loop:89 - Epoch: [72/ 80] | Train loss: [0.06971359563370545]
2022-04-05 12:49:40.805 | INFO     | tools.trainer:train_loop:89 - Epoch: [73/ 80] | Train loss: [0.06970692570838663]
2022-04-05 12:52:20.679 | INFO     | tools.trainer:train_loop:89 - Epoch: [74/ 80] | Train loss: [0.06839568648073409]
2022-04-05 12:55:00.217 | INFO     | tools.trainer:train_loop:89 - Epoch: [75/ 80] | Train loss: [0.06933404778440794]
2022-04-05 12:57:40.531 | INFO     | tools.trainer:train_loop:89 - Epoch: [76/ 80] | Train loss: [0.06859216367204984]
2022-04-05 13:00:20.719 | INFO     | tools.trainer:train_loop:89 - Epoch: [77/ 80] | Train loss: [0.06753725144598219]
2022-04-05 13:03:00.124 | INFO     | tools.trainer:train_loop:89 - Epoch: [78/ 80] | Train loss: [0.0670940408276187]
2022-04-05 13:05:39.024 | INFO     | tools.trainer:train_loop:89 - Epoch: [79/ 80] | Train loss: [0.06695399669309457]
2022-04-05 13:05:39.228 | INFO     | tools.trainer:train_loop:104 - [Saving Snapshot:]/mnt/data/hungpv/polyps/checkpoint/KCECE/mit-uperhead_v1/MiT-B3-UPerHead_79.pth
2022-04-05 13:08:18.984 | INFO     | tools.trainer:train_loop:89 - Epoch: [80/ 80] | Train loss: [0.06756370121406184]
2022-04-05 13:08:19.186 | INFO     | tools.trainer:train_loop:104 - [Saving Snapshot:]/mnt/data/hungpv/polyps/checkpoint/KCECE/mit-uperhead_v1/MiT-B3-UPerHead_80.pth
2022-04-05 13:08:19.186 | INFO     | tools.trainer:train_loop:110 - Training cost: 12791.520029986976seconds
