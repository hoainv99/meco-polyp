2022-04-07 03:16:00.795 | INFO     | __main__:main:45 - Load config from configs/caraseguper.yaml
2022-04-07 03:16:00.795 | INFO     | __main__:main:46 - {'dataset': {'data_path': '/home/admin_mcn/hungpv/polyps/dataset/KCECE', 'train_data_path': ['/home/admin_mcn/hungpv/polyps/dataset/KCECE/TrainDataset'], 'test_data_path': ['/home/admin_mcn/hungpv/polyps/dataset/KCECE/TestDataset/Kvasir'], 'val_data_path': ['/home/admin_mcn/hungpv/polyps/dataset/KCECE/TestDataset/CVC-300']}, 'model': {'name': 'CaraSegUPer', 'num_classes': 1, 'save_dir': '/mnt/data/hungpv/polyps/checkpoint/KCECE/caraseguper', 'backbone': 'MiT-B3', 'head': 'UPerHead', 'pretrained': '/mnt/data/hungpv/polyps/pretrained-backbone/mit_b3.pth'}, 'optimizer': {'name': 'adam', 'lr': 0.0001, 'clip': 0.5, 'scheduler': 'cosine_warmup', 'loss': 'structure_loss'}, 'dev': 'cuda', 'train': {'start_from': 0, 'save_from': 78, 'num_epochs': 80, 'num_warmup_epoch': 10, 'is_val': False, 'size_rates': [0.75, 1, 1.25], 'dataloader': {'batchsize': 16, 'img_size': 352, 'shuffle': True, 'num_workers': 2, 'pin_memory': True, 'drop_last': True}, 'amp': False, 'ddp': False, 'augment': {'prob': 1, 'Flip_prob': 0.7, 'HueSaturationValue_prob': 0.7, 'RandomBrightnessContrast_prob': 0.5, 'crop_prob': 0.0, 'randomrotate90_prob': 0.7}}, 'test': {'dev': 'cuda', 'visualize': False, 'visualize_dir': '/mnt/data/hungpv/polyps/visualize', 'vis_x': 180, 'vis_overwrite': False, 'checkpoint_dir': '/mnt/data/hungpv/polyps/checkpoint/KCECE/mit-uperhead_v5/MiT-B3-UPerHead_80.pth', 'dataloader': {'batchsize': 1, 'img_size': 352, 'shuffle': True, 'num_workers': 2, 'pin_memory': True, 'drop_last': True}, 'augment': {'prob': 1, 'Flip_prob': 0, 'HueSaturationValue_prob': 0, 'RandomBrightnessContrast_prob': 0, 'crop_prob': 0, 'randomrotate90_prob': 0, 'elastictransform_prob': 0, 'gridistortion_prob': 0, 'opticaldistortion_prob': 0, 'verticalflip_prob': 0, 'horizontalflip_prob': 0, 'randomgamma_prob': 0, 'CoarseDropout_prob': 0, 'RGBShift_prob': 0, 'MotionBlur_prob': 0, 'MedianBlur_prob': 0, 'GaussianBlur_prob': 0, 'GaussNoise_prob': 0, 'ChannelShuffle_prob': 0}}}
2022-04-07 03:16:00.795 | INFO     | __main__:main:47 - Getting datapath
2022-04-07 03:16:00.801 | INFO     | __main__:main:61 - There are 1450 images to train
2022-04-07 03:16:00.802 | INFO     | __main__:main:80 - Train model with no valid dataset
2022-04-07 03:16:00.802 | INFO     | __main__:main:82 - Loading data
2022-04-07 03:16:00.893 | INFO     | __main__:main:96 - 90 batches to train
2022-04-07 03:16:00.897 | INFO     | __main__:main:109 - Loading model
2022-04-07 03:16:00.897 | INFO     | __main__:main:126 - Loading checkpoint from /mnt/data/hungpv/polyps/pretrained-backbone/mit_b3.pth ...
2022-04-07 03:16:03.615 | INFO     | __main__:main:164 - Training with FP32 ...
2022-04-07 03:18:35.477 | INFO     | tools.trainer:train_loop:89 - Epoch: [1/ 80] | Train loss: [2.048242445786794]
2022-04-07 03:21:06.524 | INFO     | tools.trainer:train_loop:89 - Epoch: [2/ 80] | Train loss: [0.7307743085755243]
2022-04-07 03:23:37.608 | INFO     | tools.trainer:train_loop:89 - Epoch: [3/ 80] | Train loss: [0.5547579805056254]
2022-04-07 03:23:37.820 | INFO     | tools.trainer:train_loop:104 - [Saving Snapshot:]/mnt/data/hungpv/polyps/checkpoint/KCECE/caraseguper/MiT-B3-UPerHead_3.pth
2022-04-07 03:26:08.858 | INFO     | tools.trainer:train_loop:89 - Epoch: [4/ 80] | Train loss: [0.4386327882607778]
2022-04-07 03:28:39.956 | INFO     | tools.trainer:train_loop:89 - Epoch: [5/ 80] | Train loss: [0.3674124702811241]
2022-04-07 03:31:11.030 | INFO     | tools.trainer:train_loop:89 - Epoch: [6/ 80] | Train loss: [0.3234201797180706]
2022-04-07 03:33:41.950 | INFO     | tools.trainer:train_loop:89 - Epoch: [7/ 80] | Train loss: [0.28835519320434994]
2022-04-07 03:36:12.987 | INFO     | tools.trainer:train_loop:89 - Epoch: [8/ 80] | Train loss: [0.2571222368213866]
2022-04-07 03:38:44.186 | INFO     | tools.trainer:train_loop:89 - Epoch: [9/ 80] | Train loss: [0.23502583023574616]
2022-04-07 03:41:15.210 | INFO     | tools.trainer:train_loop:89 - Epoch: [10/ 80] | Train loss: [0.22018555982245339]
2022-04-07 03:43:46.161 | INFO     | tools.trainer:train_loop:89 - Epoch: [11/ 80] | Train loss: [0.21294326417975956]
2022-04-07 03:46:17.113 | INFO     | tools.trainer:train_loop:89 - Epoch: [12/ 80] | Train loss: [0.20243598976069027]
2022-04-07 03:48:48.138 | INFO     | tools.trainer:train_loop:89 - Epoch: [13/ 80] | Train loss: [0.18578394022252825]
2022-04-07 03:51:19.109 | INFO     | tools.trainer:train_loop:89 - Epoch: [14/ 80] | Train loss: [0.1873018624054061]
2022-04-07 03:53:50.353 | INFO     | tools.trainer:train_loop:89 - Epoch: [15/ 80] | Train loss: [0.17748490422964097]
2022-04-07 03:56:21.424 | INFO     | tools.trainer:train_loop:89 - Epoch: [16/ 80] | Train loss: [0.17892516661021446]
2022-04-07 03:58:52.468 | INFO     | tools.trainer:train_loop:89 - Epoch: [17/ 80] | Train loss: [0.16887370107902422]
2022-04-07 04:01:23.503 | INFO     | tools.trainer:train_loop:89 - Epoch: [18/ 80] | Train loss: [0.16759288079208798]
2022-04-07 04:03:54.574 | INFO     | tools.trainer:train_loop:89 - Epoch: [19/ 80] | Train loss: [0.16373704498012862]
2022-04-07 04:06:25.550 | INFO     | tools.trainer:train_loop:89 - Epoch: [20/ 80] | Train loss: [0.15382504181729423]
2022-04-07 04:08:56.670 | INFO     | tools.trainer:train_loop:89 - Epoch: [21/ 80] | Train loss: [0.14857255924079155]
2022-04-07 04:11:27.809 | INFO     | tools.trainer:train_loop:89 - Epoch: [22/ 80] | Train loss: [0.14748506926827962]
2022-04-07 04:13:58.781 | INFO     | tools.trainer:train_loop:89 - Epoch: [23/ 80] | Train loss: [0.1393415971762604]
2022-04-07 04:16:29.903 | INFO     | tools.trainer:train_loop:89 - Epoch: [24/ 80] | Train loss: [0.13528127405378554]
2022-04-07 04:19:01.116 | INFO     | tools.trainer:train_loop:89 - Epoch: [25/ 80] | Train loss: [0.1449045815401607]
2022-04-07 04:21:32.305 | INFO     | tools.trainer:train_loop:89 - Epoch: [26/ 80] | Train loss: [0.1500409277776877]
2022-04-07 04:24:03.522 | INFO     | tools.trainer:train_loop:89 - Epoch: [27/ 80] | Train loss: [0.13965173876947826]
2022-04-07 04:26:34.670 | INFO     | tools.trainer:train_loop:89 - Epoch: [28/ 80] | Train loss: [0.13423270682493846]
2022-04-07 04:29:05.659 | INFO     | tools.trainer:train_loop:89 - Epoch: [29/ 80] | Train loss: [0.13457849828733337]
2022-04-07 04:31:36.623 | INFO     | tools.trainer:train_loop:89 - Epoch: [30/ 80] | Train loss: [0.13161589519845115]
2022-04-07 04:34:07.522 | INFO     | tools.trainer:train_loop:89 - Epoch: [31/ 80] | Train loss: [0.12799658452471097]
2022-04-07 04:36:38.522 | INFO     | tools.trainer:train_loop:89 - Epoch: [32/ 80] | Train loss: [0.12410308395822843]
2022-04-07 04:39:09.600 | INFO     | tools.trainer:train_loop:89 - Epoch: [33/ 80] | Train loss: [0.11920191438661681]
2022-04-07 04:41:40.825 | INFO     | tools.trainer:train_loop:89 - Epoch: [34/ 80] | Train loss: [0.11254456241925558]
2022-04-07 04:44:11.847 | INFO     | tools.trainer:train_loop:89 - Epoch: [35/ 80] | Train loss: [0.11634115858210457]
2022-04-07 04:46:42.834 | INFO     | tools.trainer:train_loop:89 - Epoch: [36/ 80] | Train loss: [0.11114191876517401]
2022-04-07 04:49:13.820 | INFO     | tools.trainer:train_loop:89 - Epoch: [37/ 80] | Train loss: [0.11201154929068353]
2022-04-07 04:51:44.741 | INFO     | tools.trainer:train_loop:89 - Epoch: [38/ 80] | Train loss: [0.10986394137144088]
2022-04-07 04:54:15.650 | INFO     | tools.trainer:train_loop:89 - Epoch: [39/ 80] | Train loss: [0.11923779729339812]
2022-04-07 04:56:46.838 | INFO     | tools.trainer:train_loop:89 - Epoch: [40/ 80] | Train loss: [0.10925225507881907]
2022-04-07 04:59:17.862 | INFO     | tools.trainer:train_loop:89 - Epoch: [41/ 80] | Train loss: [0.10649435487058427]
2022-04-07 05:01:48.864 | INFO     | tools.trainer:train_loop:89 - Epoch: [42/ 80] | Train loss: [0.10322869080636236]
2022-04-07 05:04:19.867 | INFO     | tools.trainer:train_loop:89 - Epoch: [43/ 80] | Train loss: [0.10198243111371993]
2022-04-07 05:06:50.887 | INFO     | tools.trainer:train_loop:89 - Epoch: [44/ 80] | Train loss: [0.10319398070375124]
2022-04-07 05:09:21.800 | INFO     | tools.trainer:train_loop:89 - Epoch: [45/ 80] | Train loss: [0.09941071404351129]
2022-04-07 05:11:52.778 | INFO     | tools.trainer:train_loop:89 - Epoch: [46/ 80] | Train loss: [0.0991863638162613]
2022-04-07 05:14:23.718 | INFO     | tools.trainer:train_loop:89 - Epoch: [47/ 80] | Train loss: [0.09950328138139512]
2022-04-07 05:16:54.589 | INFO     | tools.trainer:train_loop:89 - Epoch: [48/ 80] | Train loss: [0.09666052286823591]
2022-04-07 05:19:25.678 | INFO     | tools.trainer:train_loop:89 - Epoch: [49/ 80] | Train loss: [0.09618442422813839]
2022-04-07 05:21:56.697 | INFO     | tools.trainer:train_loop:89 - Epoch: [50/ 80] | Train loss: [0.09547850547565354]
2022-04-07 05:24:27.629 | INFO     | tools.trainer:train_loop:89 - Epoch: [51/ 80] | Train loss: [0.0937131800585323]
2022-04-07 05:26:58.549 | INFO     | tools.trainer:train_loop:89 - Epoch: [52/ 80] | Train loss: [0.09317754457394282]
2022-04-07 05:29:29.645 | INFO     | tools.trainer:train_loop:89 - Epoch: [53/ 80] | Train loss: [0.08960755724045966]
2022-04-07 05:32:00.775 | INFO     | tools.trainer:train_loop:89 - Epoch: [54/ 80] | Train loss: [0.08710130800803502]
2022-04-07 05:34:31.839 | INFO     | tools.trainer:train_loop:89 - Epoch: [55/ 80] | Train loss: [0.08844831089178722]
2022-04-07 05:37:02.965 | INFO     | tools.trainer:train_loop:89 - Epoch: [56/ 80] | Train loss: [0.08510140048133003]
2022-04-07 05:39:34.147 | INFO     | tools.trainer:train_loop:89 - Epoch: [57/ 80] | Train loss: [0.08473770030670696]
2022-04-07 05:42:05.205 | INFO     | tools.trainer:train_loop:89 - Epoch: [58/ 80] | Train loss: [0.08605496891670757]
2022-04-07 05:44:36.085 | INFO     | tools.trainer:train_loop:89 - Epoch: [59/ 80] | Train loss: [0.08585618436336517]
2022-04-07 05:47:06.964 | INFO     | tools.trainer:train_loop:89 - Epoch: [60/ 80] | Train loss: [0.08334047844012578]
2022-04-07 05:47:07.174 | INFO     | tools.trainer:train_loop:104 - [Saving Snapshot:]/mnt/data/hungpv/polyps/checkpoint/KCECE/caraseguper/MiT-B3-UPerHead_60.pth
2022-04-07 05:49:38.198 | INFO     | tools.trainer:train_loop:89 - Epoch: [61/ 80] | Train loss: [0.08289166821373833]
2022-04-07 05:52:09.198 | INFO     | tools.trainer:train_loop:89 - Epoch: [62/ 80] | Train loss: [0.08255000412464142]
2022-04-07 05:54:40.237 | INFO     | tools.trainer:train_loop:89 - Epoch: [63/ 80] | Train loss: [0.0805310833785269]
2022-04-07 05:57:11.223 | INFO     | tools.trainer:train_loop:89 - Epoch: [64/ 80] | Train loss: [0.08044806023438772]
2022-04-07 05:59:42.202 | INFO     | tools.trainer:train_loop:89 - Epoch: [65/ 80] | Train loss: [0.0776851578719086]
2022-04-07 06:02:13.260 | INFO     | tools.trainer:train_loop:89 - Epoch: [66/ 80] | Train loss: [0.07629286555780304]
2022-04-07 06:04:44.272 | INFO     | tools.trainer:train_loop:89 - Epoch: [67/ 80] | Train loss: [0.07628212256564035]
2022-04-07 06:07:15.183 | INFO     | tools.trainer:train_loop:89 - Epoch: [68/ 80] | Train loss: [0.07676180485222074]
2022-04-07 06:09:46.120 | INFO     | tools.trainer:train_loop:89 - Epoch: [69/ 80] | Train loss: [0.07511834796104166]
2022-04-07 06:12:17.231 | INFO     | tools.trainer:train_loop:89 - Epoch: [70/ 80] | Train loss: [0.07437650379207399]
2022-04-07 06:14:48.580 | INFO     | tools.trainer:train_loop:89 - Epoch: [71/ 80] | Train loss: [0.07388386266926925]
2022-04-07 06:17:19.687 | INFO     | tools.trainer:train_loop:89 - Epoch: [72/ 80] | Train loss: [0.07305002349118392]
2022-04-07 06:19:50.810 | INFO     | tools.trainer:train_loop:89 - Epoch: [73/ 80] | Train loss: [0.07192750395172172]
2022-04-07 06:22:21.925 | INFO     | tools.trainer:train_loop:89 - Epoch: [74/ 80] | Train loss: [0.07239628910190529]
2022-04-07 06:24:52.847 | INFO     | tools.trainer:train_loop:89 - Epoch: [75/ 80] | Train loss: [0.07238487311535412]
2022-04-07 06:27:23.825 | INFO     | tools.trainer:train_loop:89 - Epoch: [76/ 80] | Train loss: [0.07142133340239525]
2022-04-07 06:29:54.776 | INFO     | tools.trainer:train_loop:89 - Epoch: [77/ 80] | Train loss: [0.07169751744303439]
2022-04-07 06:32:25.780 | INFO     | tools.trainer:train_loop:89 - Epoch: [78/ 80] | Train loss: [0.07001314937240548]
2022-04-07 06:34:56.952 | INFO     | tools.trainer:train_loop:89 - Epoch: [79/ 80] | Train loss: [0.06968846188651191]
2022-04-07 06:34:57.161 | INFO     | tools.trainer:train_loop:104 - [Saving Snapshot:]/mnt/data/hungpv/polyps/checkpoint/KCECE/caraseguper/MiT-B3-UPerHead_79.pth
2022-04-07 06:37:28.245 | INFO     | tools.trainer:train_loop:89 - Epoch: [80/ 80] | Train loss: [0.06940614274806446]
2022-04-07 06:37:28.451 | INFO     | tools.trainer:train_loop:104 - [Saving Snapshot:]/mnt/data/hungpv/polyps/checkpoint/KCECE/caraseguper/MiT-B3-UPerHead_80.pth
2022-04-07 06:37:28.452 | INFO     | tools.trainer:train_loop:110 - Training cost: 12083.875895656995seconds
