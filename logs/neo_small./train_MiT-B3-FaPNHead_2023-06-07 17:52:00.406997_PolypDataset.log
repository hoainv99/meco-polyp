2023-06-07 17:52:00.411 | INFO     | __main__:main:57 - Load config from configs/neo_small.yaml
2023-06-07 17:52:00.411 | INFO     | __main__:main:58 - {'dataset': {'data_path': '/root/neo_code_reco_mb/bkai-igh-neopolyp', 'train_data_path': ['/root/neo_code_reco_mb/bkai-igh-neopolyp'], 'test_data_path': ['/root/neo_code_reco_mb/bkai-igh-neopolyp/test/test'], 'val_data_path': ['/root/neo_code_reco_mb/bkai-igh-neopolyp']}, 'model': {'num_classes': 3, 'save_dir': '/root/neo_code_reco_mb/configs/checkpoint0606', 'backbone': 'MiT-B3', 'head': 'FaPNHead', 'pretrained': 'mit_b3.pth'}, 'optimizer': {'name': 'adam', 'lr': 0.0001, 'clip': 0.5, 'scheduler': 'cosine_warmup', 'loss': 'multi_structure_loss'}, 'dev': 'cuda', 'train': {'start_from': 0, 'save_from': 99, 'num_epochs': 100, 'num_warmup_epoch': 8, 'is_val': False, 'size_rates': [0.75, 1, 1.25], 'dataloader': {'batchsize': 8, 'img_size': 384, 'shuffle': True, 'num_workers': 4, 'pin_memory': True, 'drop_last': True}, 'amp': False, 'ddp': False, 'augment': {'prob': 1, 'Flip_prob': 0.5, 'HueSaturationValue_prob': 0.5, 'RandomBrightnessContrast_prob': 0.5, 'crop_prob': 0.0, 'randomrotate90_prob': 0.5, 'ColorJitter_prob': 0.5}, 'augment_weak': {'prob': 1, 'Flip_prob': 0.5}}, 'val': {'dataloader': {'batchsize': 8, 'img_size': 384, 'shuffle': True, 'num_workers': 4, 'pin_memory': True, 'drop_last': False}}, 'test': {'dev': 'cuda', 'visualize': True, 'visualize_dir': '/root/neo_code_reco_mb/neo_visualize', 'vis_x': 180, 'vis_overwrite': False, 'checkpoint_dir': '/root/neo_code_reco_mb/configs/checkpoint0606/MiT-B3-FaPNHead_100.pth', 'dataloader': {'batchsize': 1, 'img_size': 384, 'shuffle': True, 'num_workers': 4, 'pin_memory': True, 'drop_last': False}, 'augment': {'prob': 1, 'Flip_prob': 0, 'HueSaturationValue_prob': 0, 'RandomBrightnessContrast_prob': 0, 'crop_prob': 0, 'randomrotate90_prob': 0, 'elastictransform_prob': 0, 'gridistortion_prob': 0, 'opticaldistortion_prob': 0, 'verticalflip_prob': 0, 'horizontalflip_prob': 0, 'randomgamma_prob': 0, 'CoarseDropout_prob': 0, 'RGBShift_prob': 0, 'MotionBlur_prob': 0, 'MedianBlur_prob': 0, 'GaussianBlur_prob': 0, 'GaussNoise_prob': 0, 'ChannelShuffle_prob': 0}}}
2023-06-07 17:52:00.412 | INFO     | __main__:main:59 - Getting datapath
2023-06-07 17:52:00.419 | INFO     | __main__:main:74 - There are 1000 images to train
2023-06-07 17:52:00.420 | INFO     | __main__:main:93 - Train model with no valid dataset
2023-06-07 17:52:00.420 | INFO     | __main__:main:95 - Loading data
2023-06-07 17:52:00.796 | INFO     | __main__:main:112 - 125 batches to train
2023-06-07 17:52:00.796 | INFO     | __main__:main:125 - Loading model
2023-06-07 17:52:00.796 | INFO     | __main__:main:146 - Loading checkpoint from mit_b3.pth ...
2023-06-07 17:52:06.158 | INFO     | __main__:main:190 - Training with FP32 ...
2023-06-07 17:57:23.079 | INFO     | trainer:train_loop:182 - Epoch: [1/ 100] | Train loss: [1.9782502541542053]
2023-06-07 18:02:41.603 | INFO     | trainer:train_loop:182 - Epoch: [2/ 100] | Train loss: [0.7263813629150391]
2023-06-07 18:08:01.561 | INFO     | trainer:train_loop:182 - Epoch: [3/ 100] | Train loss: [0.6683426618576049]
2023-06-07 18:13:18.950 | INFO     | trainer:train_loop:182 - Epoch: [4/ 100] | Train loss: [0.5502587460279464]
2023-06-07 18:18:38.886 | INFO     | trainer:train_loop:182 - Epoch: [5/ 100] | Train loss: [0.4126959316730499]
2023-06-07 18:23:56.570 | INFO     | trainer:train_loop:182 - Epoch: [6/ 100] | Train loss: [0.36572079157829285]
2023-06-07 18:29:17.410 | INFO     | trainer:train_loop:182 - Epoch: [7/ 100] | Train loss: [0.38472815543413164]
2023-06-07 18:34:40.153 | INFO     | trainer:train_loop:182 - Epoch: [8/ 100] | Train loss: [0.3431289848089218]
2023-06-07 18:40:02.217 | INFO     | trainer:train_loop:182 - Epoch: [9/ 100] | Train loss: [0.29952352660894394]
2023-06-07 18:45:23.512 | INFO     | trainer:train_loop:182 - Epoch: [10/ 100] | Train loss: [0.2763604202866554]
2023-06-07 18:50:44.299 | INFO     | trainer:train_loop:182 - Epoch: [11/ 100] | Train loss: [0.2753768703341484]
2023-06-07 18:56:06.164 | INFO     | trainer:train_loop:182 - Epoch: [12/ 100] | Train loss: [0.23500266143679618]
2023-06-07 19:01:27.095 | INFO     | trainer:train_loop:182 - Epoch: [13/ 100] | Train loss: [0.22287591844797133]
2023-06-07 19:06:48.090 | INFO     | trainer:train_loop:182 - Epoch: [14/ 100] | Train loss: [0.2056767910718918]
2023-06-07 19:12:09.944 | INFO     | trainer:train_loop:182 - Epoch: [15/ 100] | Train loss: [0.18177010896801948]
2023-06-07 19:17:32.684 | INFO     | trainer:train_loop:182 - Epoch: [16/ 100] | Train loss: [0.18143821087479592]
2023-06-07 19:22:51.215 | INFO     | trainer:train_loop:182 - Epoch: [17/ 100] | Train loss: [0.17732017520070076]
2023-06-07 19:28:14.558 | INFO     | trainer:train_loop:182 - Epoch: [18/ 100] | Train loss: [0.16152256846427918]
2023-06-07 19:33:36.397 | INFO     | trainer:train_loop:182 - Epoch: [19/ 100] | Train loss: [0.17262189495563507]
2023-06-07 19:38:59.339 | INFO     | trainer:train_loop:182 - Epoch: [20/ 100] | Train loss: [0.15884008064866065]
2023-06-07 19:44:23.845 | INFO     | trainer:train_loop:182 - Epoch: [21/ 100] | Train loss: [0.14413365331292152]
2023-06-07 19:49:46.551 | INFO     | trainer:train_loop:182 - Epoch: [22/ 100] | Train loss: [0.15014462473988532]
2023-06-07 19:55:10.419 | INFO     | trainer:train_loop:182 - Epoch: [23/ 100] | Train loss: [0.1361699560582638]
2023-06-07 20:00:32.947 | INFO     | trainer:train_loop:182 - Epoch: [24/ 100] | Train loss: [0.13289168751239777]
2023-06-07 20:05:55.406 | INFO     | trainer:train_loop:182 - Epoch: [25/ 100] | Train loss: [0.12049176400899887]
2023-06-07 20:11:17.314 | INFO     | trainer:train_loop:182 - Epoch: [26/ 100] | Train loss: [0.11613224673271179]
2023-06-07 20:16:40.569 | INFO     | trainer:train_loop:182 - Epoch: [27/ 100] | Train loss: [0.12372529706358909]
2023-06-07 20:22:02.828 | INFO     | trainer:train_loop:182 - Epoch: [28/ 100] | Train loss: [0.12175549644231796]
2023-06-07 20:27:27.457 | INFO     | trainer:train_loop:182 - Epoch: [29/ 100] | Train loss: [0.10801460900902748]
2023-06-07 20:32:51.392 | INFO     | trainer:train_loop:182 - Epoch: [30/ 100] | Train loss: [0.09828930684924125]
2023-06-07 20:38:14.971 | INFO     | trainer:train_loop:182 - Epoch: [31/ 100] | Train loss: [0.09327078667283058]
2023-06-07 20:43:37.832 | INFO     | trainer:train_loop:182 - Epoch: [32/ 100] | Train loss: [0.08395209312438964]
2023-06-07 20:49:00.343 | INFO     | trainer:train_loop:182 - Epoch: [33/ 100] | Train loss: [0.09231474712491035]
2023-06-07 20:54:23.360 | INFO     | trainer:train_loop:182 - Epoch: [34/ 100] | Train loss: [0.08683490747213364]
2023-06-07 20:59:45.744 | INFO     | trainer:train_loop:182 - Epoch: [35/ 100] | Train loss: [0.08478380417823791]
2023-06-07 21:05:08.579 | INFO     | trainer:train_loop:182 - Epoch: [36/ 100] | Train loss: [0.0811411789059639]
2023-06-07 21:10:30.715 | INFO     | trainer:train_loop:182 - Epoch: [37/ 100] | Train loss: [0.07903484159708023]
2023-06-07 21:15:51.741 | INFO     | trainer:train_loop:182 - Epoch: [38/ 100] | Train loss: [0.0811458488702774]
2023-06-07 21:21:13.779 | INFO     | trainer:train_loop:182 - Epoch: [39/ 100] | Train loss: [0.08024774608016014]
2023-06-07 21:26:36.429 | INFO     | trainer:train_loop:182 - Epoch: [40/ 100] | Train loss: [0.08092261004447937]
2023-06-07 21:31:58.649 | INFO     | trainer:train_loop:182 - Epoch: [41/ 100] | Train loss: [0.08952098128199577]
2023-06-07 21:37:21.176 | INFO     | trainer:train_loop:182 - Epoch: [42/ 100] | Train loss: [0.08133555668592453]
2023-06-07 21:42:44.625 | INFO     | trainer:train_loop:182 - Epoch: [43/ 100] | Train loss: [0.07172451436519622]
2023-06-07 21:48:06.420 | INFO     | trainer:train_loop:182 - Epoch: [44/ 100] | Train loss: [0.06996725974977017]
2023-06-07 21:53:29.203 | INFO     | trainer:train_loop:182 - Epoch: [45/ 100] | Train loss: [0.0760130659788847]
2023-06-07 21:58:49.950 | INFO     | trainer:train_loop:182 - Epoch: [46/ 100] | Train loss: [0.07868533605337143]
2023-06-07 22:04:11.909 | INFO     | trainer:train_loop:182 - Epoch: [47/ 100] | Train loss: [0.07143849775195121]
2023-06-07 22:09:36.093 | INFO     | trainer:train_loop:182 - Epoch: [48/ 100] | Train loss: [0.07220998445153236]
2023-06-07 22:14:58.172 | INFO     | trainer:train_loop:182 - Epoch: [49/ 100] | Train loss: [0.06874258841574192]
2023-06-07 22:20:19.748 | INFO     | trainer:train_loop:182 - Epoch: [50/ 100] | Train loss: [0.06418566724658012]
2023-06-07 22:25:42.469 | INFO     | trainer:train_loop:182 - Epoch: [51/ 100] | Train loss: [0.06342065747082233]
2023-06-07 22:31:05.036 | INFO     | trainer:train_loop:182 - Epoch: [52/ 100] | Train loss: [0.06865972381830215]
2023-06-07 22:36:28.010 | INFO     | trainer:train_loop:182 - Epoch: [53/ 100] | Train loss: [0.058831496596336366]
2023-06-07 22:41:50.453 | INFO     | trainer:train_loop:182 - Epoch: [54/ 100] | Train loss: [0.05521748659014702]
2023-06-07 22:47:12.484 | INFO     | trainer:train_loop:182 - Epoch: [55/ 100] | Train loss: [0.05683327725529671]
2023-06-07 22:52:35.751 | INFO     | trainer:train_loop:182 - Epoch: [56/ 100] | Train loss: [0.05991426672041416]
2023-06-07 22:57:58.140 | INFO     | trainer:train_loop:182 - Epoch: [57/ 100] | Train loss: [0.05757390670478344]
2023-06-07 23:03:20.379 | INFO     | trainer:train_loop:182 - Epoch: [58/ 100] | Train loss: [0.05849583153426647]
2023-06-07 23:08:42.690 | INFO     | trainer:train_loop:182 - Epoch: [59/ 100] | Train loss: [0.05733015398681164]
2023-06-07 23:14:06.407 | INFO     | trainer:train_loop:182 - Epoch: [60/ 100] | Train loss: [0.05341566529870033]
2023-06-07 23:19:29.918 | INFO     | trainer:train_loop:182 - Epoch: [61/ 100] | Train loss: [0.052353261485695836]
2023-06-07 23:24:53.442 | INFO     | trainer:train_loop:182 - Epoch: [62/ 100] | Train loss: [0.05882314312458038]
2023-06-07 23:30:14.727 | INFO     | trainer:train_loop:182 - Epoch: [63/ 100] | Train loss: [0.055060871079564096]
2023-06-07 23:35:36.931 | INFO     | trainer:train_loop:182 - Epoch: [64/ 100] | Train loss: [0.05026544724404812]
2023-06-07 23:40:58.036 | INFO     | trainer:train_loop:182 - Epoch: [65/ 100] | Train loss: [0.050522983685135844]
2023-06-07 23:46:18.459 | INFO     | trainer:train_loop:182 - Epoch: [66/ 100] | Train loss: [0.04891383199393749]
2023-06-07 23:51:38.725 | INFO     | trainer:train_loop:182 - Epoch: [67/ 100] | Train loss: [0.051945539891719815]
2023-06-07 23:57:02.140 | INFO     | trainer:train_loop:182 - Epoch: [68/ 100] | Train loss: [0.049192180931568144]
2023-06-08 00:02:25.392 | INFO     | trainer:train_loop:182 - Epoch: [69/ 100] | Train loss: [0.046597256660461425]
2023-06-08 00:07:49.373 | INFO     | trainer:train_loop:182 - Epoch: [70/ 100] | Train loss: [0.04727685604989529]
2023-06-08 00:13:11.180 | INFO     | trainer:train_loop:182 - Epoch: [71/ 100] | Train loss: [0.049031307011842724]
2023-06-08 00:18:34.922 | INFO     | trainer:train_loop:182 - Epoch: [72/ 100] | Train loss: [0.04841580253839493]
2023-06-08 00:23:59.869 | INFO     | trainer:train_loop:182 - Epoch: [73/ 100] | Train loss: [0.04608142177760601]
2023-06-08 00:29:24.913 | INFO     | trainer:train_loop:182 - Epoch: [74/ 100] | Train loss: [0.0462821072191]
2023-06-08 00:34:48.066 | INFO     | trainer:train_loop:182 - Epoch: [75/ 100] | Train loss: [0.043707175761461256]
2023-06-08 00:40:12.214 | INFO     | trainer:train_loop:182 - Epoch: [76/ 100] | Train loss: [0.04460470598936081]
2023-06-08 00:45:35.207 | INFO     | trainer:train_loop:182 - Epoch: [77/ 100] | Train loss: [0.04518811358511448]
2023-06-08 00:50:57.622 | INFO     | trainer:train_loop:182 - Epoch: [78/ 100] | Train loss: [0.043505382031202314]
2023-06-08 00:56:20.987 | INFO     | trainer:train_loop:182 - Epoch: [79/ 100] | Train loss: [0.04213348320126534]
2023-06-08 01:01:45.091 | INFO     | trainer:train_loop:182 - Epoch: [80/ 100] | Train loss: [0.042314940094947816]
2023-06-08 01:07:08.850 | INFO     | trainer:train_loop:182 - Epoch: [81/ 100] | Train loss: [0.04213402657210827]
2023-06-08 01:12:30.984 | INFO     | trainer:train_loop:182 - Epoch: [82/ 100] | Train loss: [0.0444975485354662]
2023-06-08 01:17:54.718 | INFO     | trainer:train_loop:182 - Epoch: [83/ 100] | Train loss: [0.0406916091889143]
2023-06-08 01:23:18.969 | INFO     | trainer:train_loop:182 - Epoch: [84/ 100] | Train loss: [0.04241713684797287]
2023-06-08 01:28:41.192 | INFO     | trainer:train_loop:182 - Epoch: [85/ 100] | Train loss: [0.04073803789913654]
2023-06-08 01:34:03.607 | INFO     | trainer:train_loop:182 - Epoch: [86/ 100] | Train loss: [0.04057491226494312]
2023-06-08 01:39:25.726 | INFO     | trainer:train_loop:182 - Epoch: [87/ 100] | Train loss: [0.04094125869870186]
2023-06-08 01:44:49.482 | INFO     | trainer:train_loop:182 - Epoch: [88/ 100] | Train loss: [0.041547715425491336]
2023-06-08 01:50:12.220 | INFO     | trainer:train_loop:182 - Epoch: [89/ 100] | Train loss: [0.03971966989338398]
2023-06-08 01:55:35.149 | INFO     | trainer:train_loop:182 - Epoch: [90/ 100] | Train loss: [0.04009407451748848]
2023-06-08 02:00:57.278 | INFO     | trainer:train_loop:182 - Epoch: [91/ 100] | Train loss: [0.03834887044131756]
2023-06-08 02:06:20.540 | INFO     | trainer:train_loop:182 - Epoch: [92/ 100] | Train loss: [0.03966834434866905]
2023-06-08 02:11:43.205 | INFO     | trainer:train_loop:182 - Epoch: [93/ 100] | Train loss: [0.03941233243048191]
2023-06-08 02:17:06.791 | INFO     | trainer:train_loop:182 - Epoch: [94/ 100] | Train loss: [0.03922123394906521]
2023-06-08 02:22:30.116 | INFO     | trainer:train_loop:182 - Epoch: [95/ 100] | Train loss: [0.03875628705322742]
2023-06-08 02:27:54.956 | INFO     | trainer:train_loop:182 - Epoch: [96/ 100] | Train loss: [0.03996177737414837]
2023-06-08 02:33:18.705 | INFO     | trainer:train_loop:182 - Epoch: [97/ 100] | Train loss: [0.03842113515734673]
2023-06-08 02:38:43.365 | INFO     | trainer:train_loop:182 - Epoch: [98/ 100] | Train loss: [0.03873491390049458]
2023-06-08 02:44:08.309 | INFO     | trainer:train_loop:182 - Epoch: [99/ 100] | Train loss: [0.03891089689731598]
2023-06-08 02:49:32.879 | INFO     | trainer:train_loop:182 - Epoch: [100/ 100] | Train loss: [0.03774460954964161]
2023-06-08 02:49:33.738 | INFO     | trainer:train_loop:203 - [Saving Snapshot:]/root/neo_code_reco_mb/configs/checkpoint0606/MiT-B3-FaPNHead_100.pth
2023-06-08 02:49:33.739 | INFO     | trainer:train_loop:212 - Training cost: 32246.11286585033seconds
