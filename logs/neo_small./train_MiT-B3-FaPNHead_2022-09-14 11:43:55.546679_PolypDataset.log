2022-09-14 11:43:55.550 | INFO     | __main__:main:57 - Load config from configs/neo_small.yaml
2022-09-14 11:43:55.550 | INFO     | __main__:main:58 - {'dataset': {'data_path': '/home/s/hungpv/polyps/dataset', 'train_data_path': ['/home/s/hungpv/polyps/dataset/neo_small/train'], 'test_data_path': ['/home/s/hungpv/polyps/dataset/neo_small/test'], 'val_data_path': ['/home/s/hungpv/polyps/dataset/neo_small/test']}, 'model': {'num_classes': 3, 'save_dir': '/home/s/hungpv/polyps/checkpoint/neo/neo_small_v2', 'backbone': 'MiT-B3', 'head': 'FaPNHead', 'pretrained': '/home/s/hungpv/polyps/pretrained_models/mit_b3.pth'}, 'optimizer': {'name': 'adam', 'lr': 0.0001, 'clip': 0.5, 'scheduler': 'cosine_warmup', 'loss': 'multi_structure_loss'}, 'dev': 'cuda', 'train': {'start_from': 0, 'save_from': 99, 'num_epochs': 100, 'num_warmup_epoch': 8, 'is_val': False, 'size_rates': [0.75, 1, 1.25], 'dataloader': {'batchsize': 16, 'img_size': 384, 'shuffle': True, 'num_workers': 4, 'pin_memory': True, 'drop_last': True}, 'amp': False, 'ddp': False, 'augment': {'prob': 1, 'Flip_prob': 0.5, 'HueSaturationValue_prob': 0.5, 'RandomBrightnessContrast_prob': 0.5, 'crop_prob': 0.0, 'randomrotate90_prob': 0.5, 'ColorJitter_prob': 0.5}}, 'val': {'dataloader': {'batchsize': 8, 'img_size': 384, 'shuffle': True, 'num_workers': 4, 'pin_memory': True, 'drop_last': False}}, 'test': {'dev': 'cuda', 'visualize': True, 'visualize_dir': '/home/s/hungpv/polyps/neo_visualize', 'vis_x': 180, 'vis_overwrite': False, 'checkpoint_dir': '/home/s/hungpv/polyps/checkpoint/neo/neo_small_v3/MiT-B3-FaPNHead_100.pth', 'dataloader': {'batchsize': 1, 'img_size': 384, 'shuffle': True, 'num_workers': 4, 'pin_memory': True, 'drop_last': False}, 'augment': {'prob': 1, 'Flip_prob': 0, 'HueSaturationValue_prob': 0, 'RandomBrightnessContrast_prob': 0, 'crop_prob': 0, 'randomrotate90_prob': 0, 'elastictransform_prob': 0, 'gridistortion_prob': 0, 'opticaldistortion_prob': 0, 'verticalflip_prob': 0, 'horizontalflip_prob': 0, 'randomgamma_prob': 0, 'CoarseDropout_prob': 0, 'RGBShift_prob': 0, 'MotionBlur_prob': 0, 'MedianBlur_prob': 0, 'GaussianBlur_prob': 0, 'GaussNoise_prob': 0, 'ChannelShuffle_prob': 0}}}
2022-09-14 11:43:55.550 | INFO     | __main__:main:59 - Getting datapath
2022-09-14 11:43:55.555 | INFO     | __main__:main:74 - There are 1000 images to train
2022-09-14 11:43:55.556 | INFO     | __main__:main:93 - Train model with no valid dataset
2022-09-14 11:43:55.557 | INFO     | __main__:main:95 - Loading data
2022-09-14 11:43:55.640 | INFO     | __main__:main:109 - 62 batches to train
2022-09-14 11:43:55.640 | INFO     | __main__:main:122 - Loading model
2022-09-14 11:43:55.640 | INFO     | __main__:main:143 - Loading checkpoint from /home/s/hungpv/polyps/pretrained_models/mit_b3.pth ...
2022-09-14 11:43:58.755 | INFO     | __main__:main:187 - Training with FP32 ...
2022-09-14 11:45:30.633 | INFO     | tools.trainer:train_loop:126 - Epoch: [1/ 100] | Train loss: [2.2819387066748833]
2022-09-14 11:47:01.398 | INFO     | tools.trainer:train_loop:126 - Epoch: [2/ 100] | Train loss: [1.0256142750863106]
2022-09-14 11:48:32.498 | INFO     | tools.trainer:train_loop:126 - Epoch: [3/ 100] | Train loss: [0.8154029615463749]
2022-09-14 11:50:03.916 | INFO     | tools.trainer:train_loop:126 - Epoch: [4/ 100] | Train loss: [0.6613288896699105]
2022-09-14 11:51:37.139 | INFO     | tools.trainer:train_loop:126 - Epoch: [5/ 100] | Train loss: [0.6041727046812734]
2022-09-14 11:53:09.991 | INFO     | tools.trainer:train_loop:126 - Epoch: [6/ 100] | Train loss: [0.5713291100917324]
2022-09-14 11:54:41.776 | INFO     | tools.trainer:train_loop:126 - Epoch: [7/ 100] | Train loss: [0.5444341768180171]
2022-09-14 11:56:16.341 | INFO     | tools.trainer:train_loop:126 - Epoch: [8/ 100] | Train loss: [0.5315310325353376]
2022-09-14 11:57:48.235 | INFO     | tools.trainer:train_loop:126 - Epoch: [9/ 100] | Train loss: [0.8213705228221032]
2022-09-14 11:59:20.947 | INFO     | tools.trainer:train_loop:126 - Epoch: [10/ 100] | Train loss: [0.6190279193462864]
2022-09-14 12:00:54.078 | INFO     | tools.trainer:train_loop:126 - Epoch: [11/ 100] | Train loss: [0.5298163280371697]
2022-09-14 12:02:28.913 | INFO     | tools.trainer:train_loop:126 - Epoch: [12/ 100] | Train loss: [0.4118461017647097]
2022-09-14 12:04:01.140 | INFO     | tools.trainer:train_loop:126 - Epoch: [13/ 100] | Train loss: [0.4039952396865814]
2022-09-14 12:05:35.283 | INFO     | tools.trainer:train_loop:126 - Epoch: [14/ 100] | Train loss: [0.3498496201730544]
2022-09-14 12:07:08.107 | INFO     | tools.trainer:train_loop:126 - Epoch: [15/ 100] | Train loss: [0.7155971974134445]
2022-09-14 12:08:41.745 | INFO     | tools.trainer:train_loop:126 - Epoch: [16/ 100] | Train loss: [0.6751169273930211]
2022-09-14 12:10:14.647 | INFO     | tools.trainer:train_loop:126 - Epoch: [17/ 100] | Train loss: [0.6322421719951015]
2022-09-14 12:11:49.290 | INFO     | tools.trainer:train_loop:126 - Epoch: [18/ 100] | Train loss: [0.5890148724279096]
2022-09-14 12:13:21.460 | INFO     | tools.trainer:train_loop:126 - Epoch: [19/ 100] | Train loss: [0.5549858472039623]
2022-09-14 12:14:55.823 | INFO     | tools.trainer:train_loop:126 - Epoch: [20/ 100] | Train loss: [0.5126456046296705]
2022-09-14 12:16:28.719 | INFO     | tools.trainer:train_loop:126 - Epoch: [21/ 100] | Train loss: [0.47726189321087253]
2022-09-14 12:18:02.145 | INFO     | tools.trainer:train_loop:126 - Epoch: [22/ 100] | Train loss: [0.439688534025223]
2022-09-14 12:19:34.705 | INFO     | tools.trainer:train_loop:126 - Epoch: [23/ 100] | Train loss: [0.4215521790808247]
2022-09-14 12:21:08.318 | INFO     | tools.trainer:train_loop:126 - Epoch: [24/ 100] | Train loss: [0.39270074785717074]
2022-09-14 12:22:42.965 | INFO     | tools.trainer:train_loop:126 - Epoch: [25/ 100] | Train loss: [0.3817150816321373]
2022-09-14 12:24:17.689 | INFO     | tools.trainer:train_loop:126 - Epoch: [26/ 100] | Train loss: [0.36766261583374393]
2022-09-14 12:25:50.346 | INFO     | tools.trainer:train_loop:126 - Epoch: [27/ 100] | Train loss: [0.3415473918280294]
2022-09-14 12:27:24.869 | INFO     | tools.trainer:train_loop:126 - Epoch: [28/ 100] | Train loss: [0.4232060995794112]
2022-09-14 12:28:58.610 | INFO     | tools.trainer:train_loop:126 - Epoch: [29/ 100] | Train loss: [0.37455446513429763]
2022-09-14 12:30:32.495 | INFO     | tools.trainer:train_loop:126 - Epoch: [30/ 100] | Train loss: [0.3450695331538877]
2022-09-14 12:32:05.821 | INFO     | tools.trainer:train_loop:126 - Epoch: [31/ 100] | Train loss: [0.3331958950767594]
2022-09-14 12:33:39.655 | INFO     | tools.trainer:train_loop:126 - Epoch: [32/ 100] | Train loss: [0.2949045793183388]
2022-09-14 12:35:11.783 | INFO     | tools.trainer:train_loop:126 - Epoch: [33/ 100] | Train loss: [0.2822137400507927]
2022-09-14 12:36:46.423 | INFO     | tools.trainer:train_loop:126 - Epoch: [34/ 100] | Train loss: [0.2787571548213882]
2022-09-14 12:38:20.054 | INFO     | tools.trainer:train_loop:126 - Epoch: [35/ 100] | Train loss: [0.26945136235125605]
2022-09-14 12:39:54.953 | INFO     | tools.trainer:train_loop:126 - Epoch: [36/ 100] | Train loss: [0.27406839882173845]
2022-09-14 12:41:27.205 | INFO     | tools.trainer:train_loop:126 - Epoch: [37/ 100] | Train loss: [0.2503855375032271]
2022-09-14 12:43:02.499 | INFO     | tools.trainer:train_loop:126 - Epoch: [38/ 100] | Train loss: [0.25502094626426697]
2022-09-14 12:44:35.197 | INFO     | tools.trainer:train_loop:126 - Epoch: [39/ 100] | Train loss: [0.24809202347551623]
2022-09-14 12:46:09.724 | INFO     | tools.trainer:train_loop:126 - Epoch: [40/ 100] | Train loss: [0.22469586302195826]
2022-09-14 12:47:42.092 | INFO     | tools.trainer:train_loop:126 - Epoch: [41/ 100] | Train loss: [0.23579853725048802]
2022-09-14 12:49:16.511 | INFO     | tools.trainer:train_loop:126 - Epoch: [42/ 100] | Train loss: [0.2174850558080981]
2022-09-14 12:50:50.711 | INFO     | tools.trainer:train_loop:126 - Epoch: [43/ 100] | Train loss: [0.22362385365751483]
2022-09-14 12:52:24.096 | INFO     | tools.trainer:train_loop:126 - Epoch: [44/ 100] | Train loss: [0.20418504697661247]
2022-09-14 12:53:56.674 | INFO     | tools.trainer:train_loop:126 - Epoch: [45/ 100] | Train loss: [0.22885799468044313]
2022-09-14 12:55:31.730 | INFO     | tools.trainer:train_loop:126 - Epoch: [46/ 100] | Train loss: [0.20819631098739563]
2022-09-14 12:57:05.946 | INFO     | tools.trainer:train_loop:126 - Epoch: [47/ 100] | Train loss: [0.19918406454305496]
2022-09-14 12:58:39.702 | INFO     | tools.trainer:train_loop:126 - Epoch: [48/ 100] | Train loss: [0.19486357884541636]
2022-09-14 13:00:12.797 | INFO     | tools.trainer:train_loop:126 - Epoch: [49/ 100] | Train loss: [0.2065896224230528]
2022-09-14 13:01:46.556 | INFO     | tools.trainer:train_loop:126 - Epoch: [50/ 100] | Train loss: [0.19142239108200995]
2022-09-14 13:03:20.538 | INFO     | tools.trainer:train_loop:126 - Epoch: [51/ 100] | Train loss: [0.18924623691747267]
2022-09-14 13:04:55.700 | INFO     | tools.trainer:train_loop:126 - Epoch: [52/ 100] | Train loss: [0.165710570531026]
2022-09-14 13:06:28.959 | INFO     | tools.trainer:train_loop:126 - Epoch: [53/ 100] | Train loss: [0.17054361399383314]
2022-09-14 13:08:01.960 | INFO     | tools.trainer:train_loop:126 - Epoch: [54/ 100] | Train loss: [0.16656908675307228]
2022-09-14 13:09:36.437 | INFO     | tools.trainer:train_loop:126 - Epoch: [55/ 100] | Train loss: [0.1778788166421075]
2022-09-14 13:11:09.074 | INFO     | tools.trainer:train_loop:126 - Epoch: [56/ 100] | Train loss: [0.16715348031251662]
2022-09-14 13:12:43.699 | INFO     | tools.trainer:train_loop:126 - Epoch: [57/ 100] | Train loss: [0.16390166245400906]
2022-09-14 13:14:16.776 | INFO     | tools.trainer:train_loop:126 - Epoch: [58/ 100] | Train loss: [0.14169949887981337]
2022-09-14 13:15:50.170 | INFO     | tools.trainer:train_loop:126 - Epoch: [59/ 100] | Train loss: [0.1554390781468922]
2022-09-14 13:17:24.243 | INFO     | tools.trainer:train_loop:126 - Epoch: [60/ 100] | Train loss: [0.1516060591224701]
2022-09-14 13:18:57.352 | INFO     | tools.trainer:train_loop:126 - Epoch: [61/ 100] | Train loss: [0.14598588849748334]
2022-09-14 13:20:32.083 | INFO     | tools.trainer:train_loop:126 - Epoch: [62/ 100] | Train loss: [0.1420942795492949]
2022-09-14 13:22:06.396 | INFO     | tools.trainer:train_loop:126 - Epoch: [63/ 100] | Train loss: [0.1443149103152175]
2022-09-14 13:23:40.884 | INFO     | tools.trainer:train_loop:126 - Epoch: [64/ 100] | Train loss: [0.13596730258676312]
2022-09-14 13:25:13.291 | INFO     | tools.trainer:train_loop:126 - Epoch: [65/ 100] | Train loss: [0.13842048381845798]
2022-09-14 13:26:46.826 | INFO     | tools.trainer:train_loop:126 - Epoch: [66/ 100] | Train loss: [0.12459333949992733]
2022-09-14 13:28:19.644 | INFO     | tools.trainer:train_loop:126 - Epoch: [67/ 100] | Train loss: [0.1171457648517624]
2022-09-14 13:29:52.117 | INFO     | tools.trainer:train_loop:126 - Epoch: [68/ 100] | Train loss: [0.12282114692272679]
2022-09-14 13:31:26.439 | INFO     | tools.trainer:train_loop:126 - Epoch: [69/ 100] | Train loss: [0.11266162498824057]
2022-09-14 13:32:59.987 | INFO     | tools.trainer:train_loop:126 - Epoch: [70/ 100] | Train loss: [0.1128284667408274]
2022-09-14 13:34:32.035 | INFO     | tools.trainer:train_loop:126 - Epoch: [71/ 100] | Train loss: [0.1116592088533986]
2022-09-14 13:36:06.276 | INFO     | tools.trainer:train_loop:126 - Epoch: [72/ 100] | Train loss: [0.11337727831015663]
2022-09-14 13:37:38.338 | INFO     | tools.trainer:train_loop:126 - Epoch: [73/ 100] | Train loss: [0.10373416512964233]
2022-09-14 13:39:12.436 | INFO     | tools.trainer:train_loop:126 - Epoch: [74/ 100] | Train loss: [0.09961780130622848]
2022-09-14 13:40:44.536 | INFO     | tools.trainer:train_loop:126 - Epoch: [75/ 100] | Train loss: [0.10153622835153533]
2022-09-14 13:42:17.163 | INFO     | tools.trainer:train_loop:126 - Epoch: [76/ 100] | Train loss: [0.09525640146626581]
2022-09-14 13:43:49.181 | INFO     | tools.trainer:train_loop:126 - Epoch: [77/ 100] | Train loss: [0.0961348268413736]
2022-09-14 13:45:22.750 | INFO     | tools.trainer:train_loop:126 - Epoch: [78/ 100] | Train loss: [0.089421926727218]
2022-09-14 13:46:55.670 | INFO     | tools.trainer:train_loop:126 - Epoch: [79/ 100] | Train loss: [0.08831182086179333]
2022-09-14 13:48:27.836 | INFO     | tools.trainer:train_loop:126 - Epoch: [80/ 100] | Train loss: [0.09788913904659209]
2022-09-14 13:50:00.569 | INFO     | tools.trainer:train_loop:126 - Epoch: [81/ 100] | Train loss: [0.08128204118580587]
2022-09-14 13:51:34.489 | INFO     | tools.trainer:train_loop:126 - Epoch: [82/ 100] | Train loss: [0.08441023660763618]
2022-09-14 13:53:06.661 | INFO     | tools.trainer:train_loop:126 - Epoch: [83/ 100] | Train loss: [0.07976202216119535]
2022-09-14 13:54:39.907 | INFO     | tools.trainer:train_loop:126 - Epoch: [84/ 100] | Train loss: [0.08371843680018379]
2022-09-14 13:56:12.344 | INFO     | tools.trainer:train_loop:126 - Epoch: [85/ 100] | Train loss: [0.07852786316746665]
2022-09-14 13:57:45.800 | INFO     | tools.trainer:train_loop:126 - Epoch: [86/ 100] | Train loss: [0.07432820575852547]
2022-09-14 13:59:18.246 | INFO     | tools.trainer:train_loop:126 - Epoch: [87/ 100] | Train loss: [0.07900795538819605]
2022-09-14 14:00:52.453 | INFO     | tools.trainer:train_loop:126 - Epoch: [88/ 100] | Train loss: [0.07894821693339656]
2022-09-14 14:02:24.832 | INFO     | tools.trainer:train_loop:126 - Epoch: [89/ 100] | Train loss: [0.07657142244880238]
2022-09-14 14:03:57.825 | INFO     | tools.trainer:train_loop:126 - Epoch: [90/ 100] | Train loss: [0.07510006169397984]
2022-09-14 14:05:30.441 | INFO     | tools.trainer:train_loop:126 - Epoch: [91/ 100] | Train loss: [0.07195618892869642]
2022-09-14 14:07:02.728 | INFO     | tools.trainer:train_loop:126 - Epoch: [92/ 100] | Train loss: [0.07790150553468735]
2022-09-14 14:08:37.175 | INFO     | tools.trainer:train_loop:126 - Epoch: [93/ 100] | Train loss: [0.07730635940547913]
2022-09-14 14:10:09.690 | INFO     | tools.trainer:train_loop:126 - Epoch: [94/ 100] | Train loss: [0.07996589678429789]
2022-09-14 14:11:42.199 | INFO     | tools.trainer:train_loop:126 - Epoch: [95/ 100] | Train loss: [0.07527218729017242]
2022-09-14 14:13:16.413 | INFO     | tools.trainer:train_loop:126 - Epoch: [96/ 100] | Train loss: [0.06509082878549252]
2022-09-14 14:14:48.456 | INFO     | tools.trainer:train_loop:126 - Epoch: [97/ 100] | Train loss: [0.06897521776057058]
2022-09-14 14:16:20.617 | INFO     | tools.trainer:train_loop:126 - Epoch: [98/ 100] | Train loss: [0.06517182921449985]
2022-09-14 14:17:53.175 | INFO     | tools.trainer:train_loop:126 - Epoch: [99/ 100] | Train loss: [0.06969582445679172]
2022-09-14 14:19:25.877 | INFO     | tools.trainer:train_loop:126 - Epoch: [100/ 100] | Train loss: [0.06938873742136263]
2022-09-14 14:19:26.283 | INFO     | tools.trainer:train_loop:138 - [Saving Snapshot:]/home/s/hungpv/polyps/checkpoint/neo/neo_small_v2/MiT-B3-FaPNHead_100.pth
2022-09-14 14:19:26.284 | INFO     | tools.trainer:train_loop:147 - Training cost: 9326.594589134678seconds
