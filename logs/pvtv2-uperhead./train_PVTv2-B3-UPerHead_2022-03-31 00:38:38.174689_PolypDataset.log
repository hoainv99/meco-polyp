2022-03-31 00:38:38.176 | INFO     | __main__:main:45 - Load config from configs/pvtv2-uperhead.yaml
2022-03-31 00:38:38.176 | INFO     | __main__:main:46 - {'dataset': {'data_path': '/home/admin_mcn/hungpv/polyps/dataset/KCECE', 'train_data_path': ['/home/admin_mcn/hungpv/polyps/dataset/KCECE/TrainDataset'], 'test_data_path': ['/home/admin_mcn/hungpv/polyps/dataset/KCECE/TestDataset/Kvasir'], 'val_data_path': ['/home/admin_mcn/hungpv/polyps/dataset/KCECE/TestDataset/CVC-300']}, 'model': {'num_classes': 1, 'save_dir': '/mnt/data/hungpv/polyps/checkpoint/KCECE/pvtv2-uperhead_v13', 'backbone': 'PVTv2-B3', 'head': 'UPerHead', 'pretrained': '/mnt/data/hungpv/polyps/pretrained-backbone/pvt_v2_b3.pth'}, 'optimizer': {'name': 'adam', 'lr': 0.0001, 'clip': 0.5, 'scheduler': 'cosine_warmup', 'loss': 'structure_loss'}, 'dev': 'cuda', 'train': {'start_from': 0, 'save_from': 78, 'num_epochs': 80, 'num_warmup_epoch': 10, 'is_val': False, 'size_rates': [0.75, 1, 1.25], 'dataloader': {'batchsize': 16, 'img_size': 352, 'shuffle': True, 'num_workers': 2, 'pin_memory': True, 'drop_last': True}, 'amp': False, 'ddp': False, 'augment': {'prob': 1, 'Flip_prob': 0.7, 'HueSaturationValue_prob': 0.7, 'RandomBrightnessContrast_prob': 0.5, 'crop_prob': 0.0, 'randomrotate90_prob': 0.7}}, 'test': {'dev': 'cuda', 'visualize': False, 'visualize_dir': '/mnt/data/hungpv/polyps/visualize', 'vis_x': 180, 'vis_overwrite': False, 'checkpoint_dir': '/mnt/data/hungpv/polyps/checkpoint/KCECE/pvtv2-uperhead_v12/PVTv2-B3-UPerHead_80.pth', 'dataloader': {'batchsize': 1, 'img_size': 352, 'shuffle': True, 'num_workers': 2, 'pin_memory': True, 'drop_last': True}, 'augment': {'prob': 1, 'Flip_prob': 0, 'HueSaturationValue_prob': 0, 'RandomBrightnessContrast_prob': 0, 'crop_prob': 0, 'randomrotate90_prob': 0, 'elastictransform_prob': 0, 'gridistortion_prob': 0, 'opticaldistortion_prob': 0, 'verticalflip_prob': 0, 'horizontalflip_prob': 0, 'randomgamma_prob': 0, 'CoarseDropout_prob': 0, 'RGBShift_prob': 0, 'MotionBlur_prob': 0, 'MedianBlur_prob': 0, 'GaussianBlur_prob': 0, 'GaussNoise_prob': 0, 'ChannelShuffle_prob': 0}}}
2022-03-31 00:38:38.176 | INFO     | __main__:main:47 - Getting datapath
2022-03-31 00:38:38.182 | INFO     | __main__:main:61 - There are 1450 images to train
2022-03-31 00:38:38.183 | INFO     | __main__:main:80 - Train model with no valid dataset
2022-03-31 00:38:38.183 | INFO     | __main__:main:82 - Loading data
2022-03-31 00:38:38.272 | INFO     | __main__:main:96 - 90 batches to train
2022-03-31 00:38:38.276 | INFO     | __main__:main:109 - Loading model
2022-03-31 00:38:38.277 | INFO     | __main__:main:126 - Loading checkpoint from /mnt/data/hungpv/polyps/pretrained-backbone/pvt_v2_b3.pth ...
2022-03-31 00:38:40.853 | INFO     | __main__:main:164 - Training with FP32 ...
2022-03-31 00:42:45.460 | INFO     | tools.trainer:train_loop:89 - Epoch: [1/ 80] | Train loss: [3.2876491910881467]
2022-03-31 00:47:06.080 | INFO     | tools.trainer:train_loop:89 - Epoch: [2/ 80] | Train loss: [0.8973816560374366]
2022-03-31 00:51:32.230 | INFO     | tools.trainer:train_loop:89 - Epoch: [3/ 80] | Train loss: [0.6619947201675839]
2022-03-31 00:51:32.434 | INFO     | tools.trainer:train_loop:104 - [Saving Snapshot:]/mnt/data/hungpv/polyps/checkpoint/KCECE/pvtv2-uperhead_v13/PVTv2-B3-UPerHead_3.pth
2022-03-31 00:55:59.382 | INFO     | tools.trainer:train_loop:89 - Epoch: [4/ 80] | Train loss: [0.5246140023072561]
2022-03-31 01:00:28.156 | INFO     | tools.trainer:train_loop:89 - Epoch: [5/ 80] | Train loss: [0.3976509941948785]
2022-03-31 01:04:56.502 | INFO     | tools.trainer:train_loop:89 - Epoch: [6/ 80] | Train loss: [0.36966103530592387]
2022-03-31 01:09:25.870 | INFO     | tools.trainer:train_loop:89 - Epoch: [7/ 80] | Train loss: [0.3120819937851694]
2022-03-31 01:13:56.689 | INFO     | tools.trainer:train_loop:89 - Epoch: [8/ 80] | Train loss: [0.27305611388550866]
2022-03-31 01:18:28.620 | INFO     | tools.trainer:train_loop:89 - Epoch: [9/ 80] | Train loss: [0.2581424923406707]
2022-03-31 01:22:58.863 | INFO     | tools.trainer:train_loop:89 - Epoch: [10/ 80] | Train loss: [0.24470376388894188]
2022-03-31 01:27:30.274 | INFO     | tools.trainer:train_loop:89 - Epoch: [11/ 80] | Train loss: [0.2343826938006613]
2022-03-31 01:32:03.120 | INFO     | tools.trainer:train_loop:89 - Epoch: [12/ 80] | Train loss: [0.23984286040067673]
2022-03-31 01:36:35.481 | INFO     | tools.trainer:train_loop:89 - Epoch: [13/ 80] | Train loss: [0.2002716690301895]
2022-03-31 01:41:08.272 | INFO     | tools.trainer:train_loop:89 - Epoch: [14/ 80] | Train loss: [0.19084274628096157]
2022-03-31 01:45:38.550 | INFO     | tools.trainer:train_loop:89 - Epoch: [15/ 80] | Train loss: [0.1824273596207301]
2022-03-31 01:50:11.862 | INFO     | tools.trainer:train_loop:89 - Epoch: [16/ 80] | Train loss: [0.17906263851457171]
2022-03-31 01:54:42.742 | INFO     | tools.trainer:train_loop:89 - Epoch: [17/ 80] | Train loss: [0.17846144752369986]
2022-03-31 01:59:14.149 | INFO     | tools.trainer:train_loop:89 - Epoch: [18/ 80] | Train loss: [0.17391871197356118]
2022-03-31 02:03:44.526 | INFO     | tools.trainer:train_loop:89 - Epoch: [19/ 80] | Train loss: [0.16911100049813588]
2022-03-31 02:08:15.403 | INFO     | tools.trainer:train_loop:89 - Epoch: [20/ 80] | Train loss: [0.16031962922877735]
2022-03-31 02:12:45.972 | INFO     | tools.trainer:train_loop:89 - Epoch: [21/ 80] | Train loss: [0.16093243584036826]
2022-03-31 02:17:16.068 | INFO     | tools.trainer:train_loop:89 - Epoch: [22/ 80] | Train loss: [0.1596101181374656]
2022-03-31 02:21:44.763 | INFO     | tools.trainer:train_loop:89 - Epoch: [23/ 80] | Train loss: [0.15151568916108873]
2022-03-31 02:26:13.039 | INFO     | tools.trainer:train_loop:89 - Epoch: [24/ 80] | Train loss: [0.14854379006557994]
2022-03-31 02:30:42.867 | INFO     | tools.trainer:train_loop:89 - Epoch: [25/ 80] | Train loss: [0.14141220558020803]
2022-03-31 02:35:12.179 | INFO     | tools.trainer:train_loop:89 - Epoch: [26/ 80] | Train loss: [0.13351364731788634]
2022-03-31 02:39:41.256 | INFO     | tools.trainer:train_loop:89 - Epoch: [27/ 80] | Train loss: [0.13135785129335192]
2022-03-31 02:44:10.542 | INFO     | tools.trainer:train_loop:89 - Epoch: [28/ 80] | Train loss: [0.13471339378092023]
2022-03-31 02:48:39.981 | INFO     | tools.trainer:train_loop:89 - Epoch: [29/ 80] | Train loss: [0.12866521138283943]
2022-03-31 02:53:08.596 | INFO     | tools.trainer:train_loop:89 - Epoch: [30/ 80] | Train loss: [0.13739241634805996]
2022-03-31 02:57:37.342 | INFO     | tools.trainer:train_loop:89 - Epoch: [31/ 80] | Train loss: [0.13847457849317127]
2022-03-31 03:02:06.444 | INFO     | tools.trainer:train_loop:89 - Epoch: [32/ 80] | Train loss: [0.12308821231126785]
2022-03-31 03:06:33.678 | INFO     | tools.trainer:train_loop:89 - Epoch: [33/ 80] | Train loss: [0.12288925573229789]
2022-03-31 03:11:00.800 | INFO     | tools.trainer:train_loop:89 - Epoch: [34/ 80] | Train loss: [0.12493954739636845]
2022-03-31 03:15:28.450 | INFO     | tools.trainer:train_loop:89 - Epoch: [35/ 80] | Train loss: [0.11981544693311055]
2022-03-31 03:19:56.616 | INFO     | tools.trainer:train_loop:89 - Epoch: [36/ 80] | Train loss: [0.1168628614809778]
2022-03-31 03:24:24.596 | INFO     | tools.trainer:train_loop:89 - Epoch: [37/ 80] | Train loss: [0.11556865862674183]
2022-03-31 03:28:53.431 | INFO     | tools.trainer:train_loop:89 - Epoch: [38/ 80] | Train loss: [0.12103304465611776]
2022-03-31 03:33:20.508 | INFO     | tools.trainer:train_loop:89 - Epoch: [39/ 80] | Train loss: [0.11035515417655309]
2022-03-31 03:37:48.362 | INFO     | tools.trainer:train_loop:89 - Epoch: [40/ 80] | Train loss: [0.11762786408265431]
2022-03-31 03:42:16.872 | INFO     | tools.trainer:train_loop:89 - Epoch: [41/ 80] | Train loss: [0.11084674696127574]
2022-03-31 03:46:43.213 | INFO     | tools.trainer:train_loop:89 - Epoch: [42/ 80] | Train loss: [0.10860351911849446]
2022-03-31 03:51:12.539 | INFO     | tools.trainer:train_loop:89 - Epoch: [43/ 80] | Train loss: [0.10515605823861228]
2022-03-31 03:55:41.709 | INFO     | tools.trainer:train_loop:89 - Epoch: [44/ 80] | Train loss: [0.10648641892605358]
2022-03-31 04:00:10.730 | INFO     | tools.trainer:train_loop:89 - Epoch: [45/ 80] | Train loss: [0.10273652084999614]
2022-03-31 04:04:38.340 | INFO     | tools.trainer:train_loop:89 - Epoch: [46/ 80] | Train loss: [0.10537354035509958]
2022-03-31 04:09:05.875 | INFO     | tools.trainer:train_loop:89 - Epoch: [47/ 80] | Train loss: [0.10233507653077444]
2022-03-31 04:13:33.988 | INFO     | tools.trainer:train_loop:89 - Epoch: [48/ 80] | Train loss: [0.09835503838128513]
2022-03-31 04:18:01.777 | INFO     | tools.trainer:train_loop:89 - Epoch: [49/ 80] | Train loss: [0.09817082741194301]
2022-03-31 04:22:30.279 | INFO     | tools.trainer:train_loop:89 - Epoch: [50/ 80] | Train loss: [0.09447524663474825]
2022-03-31 04:26:58.538 | INFO     | tools.trainer:train_loop:89 - Epoch: [51/ 80] | Train loss: [0.09488581923974884]
2022-03-31 04:31:26.591 | INFO     | tools.trainer:train_loop:89 - Epoch: [52/ 80] | Train loss: [0.09343688603904513]
2022-03-31 04:35:53.391 | INFO     | tools.trainer:train_loop:89 - Epoch: [53/ 80] | Train loss: [0.09029305146800147]
2022-03-31 04:40:22.643 | INFO     | tools.trainer:train_loop:89 - Epoch: [54/ 80] | Train loss: [0.0884534151189857]
2022-03-31 04:44:50.881 | INFO     | tools.trainer:train_loop:89 - Epoch: [55/ 80] | Train loss: [0.08793052832285563]
2022-03-31 04:49:19.500 | INFO     | tools.trainer:train_loop:89 - Epoch: [56/ 80] | Train loss: [0.08712509754631255]
2022-03-31 04:53:46.302 | INFO     | tools.trainer:train_loop:89 - Epoch: [57/ 80] | Train loss: [0.08645628343025843]
2022-03-31 04:58:15.685 | INFO     | tools.trainer:train_loop:89 - Epoch: [58/ 80] | Train loss: [0.08599775599108803]
2022-03-31 05:02:42.671 | INFO     | tools.trainer:train_loop:89 - Epoch: [59/ 80] | Train loss: [0.0838881655699677]
2022-03-31 05:07:09.964 | INFO     | tools.trainer:train_loop:89 - Epoch: [60/ 80] | Train loss: [0.08302272400922245]
2022-03-31 05:11:38.158 | INFO     | tools.trainer:train_loop:89 - Epoch: [61/ 80] | Train loss: [0.08246132789386643]
2022-03-31 05:16:05.056 | INFO     | tools.trainer:train_loop:89 - Epoch: [62/ 80] | Train loss: [0.08194785540302595]
2022-03-31 05:20:33.817 | INFO     | tools.trainer:train_loop:89 - Epoch: [63/ 80] | Train loss: [0.08039105335871378]
2022-03-31 05:25:01.472 | INFO     | tools.trainer:train_loop:89 - Epoch: [64/ 80] | Train loss: [0.07933303796582752]
2022-03-31 05:29:27.587 | INFO     | tools.trainer:train_loop:89 - Epoch: [65/ 80] | Train loss: [0.07941033616662026]
2022-03-31 05:33:54.060 | INFO     | tools.trainer:train_loop:89 - Epoch: [66/ 80] | Train loss: [0.07732622855239445]
2022-03-31 05:38:21.376 | INFO     | tools.trainer:train_loop:89 - Epoch: [67/ 80] | Train loss: [0.0766993964711825]
2022-03-31 05:42:47.558 | INFO     | tools.trainer:train_loop:89 - Epoch: [68/ 80] | Train loss: [0.07621374535891745]
2022-03-31 05:47:02.697 | INFO     | tools.trainer:train_loop:89 - Epoch: [69/ 80] | Train loss: [0.07590301380389267]
2022-03-31 05:51:02.930 | INFO     | tools.trainer:train_loop:89 - Epoch: [70/ 80] | Train loss: [0.07520009502768517]
2022-03-31 05:55:02.012 | INFO     | tools.trainer:train_loop:89 - Epoch: [71/ 80] | Train loss: [0.07401386693947845]
2022-03-31 05:59:01.023 | INFO     | tools.trainer:train_loop:89 - Epoch: [72/ 80] | Train loss: [0.07224238974352677]
2022-03-31 06:02:59.415 | INFO     | tools.trainer:train_loop:89 - Epoch: [73/ 80] | Train loss: [0.07246420400010214]
2022-03-31 06:06:57.248 | INFO     | tools.trainer:train_loop:89 - Epoch: [74/ 80] | Train loss: [0.07295913994312286]
2022-03-31 06:10:55.313 | INFO     | tools.trainer:train_loop:89 - Epoch: [75/ 80] | Train loss: [0.07070030930141608]
2022-03-31 06:14:53.226 | INFO     | tools.trainer:train_loop:89 - Epoch: [76/ 80] | Train loss: [0.07011747645835081]
2022-03-31 06:18:51.508 | INFO     | tools.trainer:train_loop:89 - Epoch: [77/ 80] | Train loss: [0.07044392505453692]
2022-03-31 06:22:49.738 | INFO     | tools.trainer:train_loop:89 - Epoch: [78/ 80] | Train loss: [0.06872971881594923]
2022-03-31 06:26:47.649 | INFO     | tools.trainer:train_loop:89 - Epoch: [79/ 80] | Train loss: [0.06935232968793975]
2022-03-31 06:26:47.851 | INFO     | tools.trainer:train_loop:104 - [Saving Snapshot:]/mnt/data/hungpv/polyps/checkpoint/KCECE/pvtv2-uperhead_v13/PVTv2-B3-UPerHead_79.pth
2022-03-31 06:30:46.426 | INFO     | tools.trainer:train_loop:89 - Epoch: [80/ 80] | Train loss: [0.06815348201327853]
2022-03-31 06:30:46.624 | INFO     | tools.trainer:train_loop:104 - [Saving Snapshot:]/mnt/data/hungpv/polyps/checkpoint/KCECE/pvtv2-uperhead_v13/PVTv2-B3-UPerHead_80.pth
2022-03-31 06:30:46.625 | INFO     | tools.trainer:train_loop:110 - Training cost: 21124.774247205seconds
