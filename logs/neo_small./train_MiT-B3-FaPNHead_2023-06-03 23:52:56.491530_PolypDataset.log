2023-06-03 23:52:56.497 | INFO     | __main__:main:57 - Load config from configs/neo_small.yaml
2023-06-03 23:52:56.497 | INFO     | __main__:main:58 - {'dataset': {'data_path': '/root/neo_code_reco/bkai-igh-neopolyp', 'train_data_path': ['/root/neo_code_reco/bkai-igh-neopolyp'], 'test_data_path': ['/root/neo_code/bkai-igh-neopolyp/test/test'], 'val_data_path': ['/root/neo_code_reco/bkai-igh-neopolyp']}, 'model': {'num_classes': 3, 'save_dir': '/root/neo_code_reco/configs/checkpoint_mb_with_local', 'backbone': 'MiT-B3', 'head': 'FaPNHead', 'pretrained': 'mit_b3.pth'}, 'optimizer': {'name': 'adam', 'lr': 0.0001, 'clip': 0.5, 'scheduler': 'cosine_warmup', 'loss': 'multi_structure_loss'}, 'dev': 'cuda', 'train': {'start_from': 0, 'save_from': 99, 'num_epochs': 100, 'num_warmup_epoch': 8, 'is_val': False, 'size_rates': [0.75, 1, 1.25], 'dataloader': {'batchsize': 8, 'img_size': 384, 'shuffle': True, 'num_workers': 4, 'pin_memory': True, 'drop_last': True}, 'amp': False, 'ddp': False, 'augment': {'prob': 1, 'Flip_prob': 0.5, 'HueSaturationValue_prob': 0.5, 'RandomBrightnessContrast_prob': 0.5, 'crop_prob': 0.0, 'randomrotate90_prob': 0.5, 'ColorJitter_prob': 0.5}, 'augment_weak': {'prob': 1, 'Flip_prob': 0.5}}, 'val': {'dataloader': {'batchsize': 8, 'img_size': 384, 'shuffle': True, 'num_workers': 4, 'pin_memory': True, 'drop_last': False}}, 'test': {'dev': 'cuda', 'visualize': True, 'visualize_dir': '/root/neo_code_reco/neo_visualize', 'vis_x': 180, 'vis_overwrite': False, 'checkpoint_dir': '/root/neo_code_reco/configs/checkpoint_mb/MiT-B3-FaPNHead_100.pth', 'dataloader': {'batchsize': 1, 'img_size': 384, 'shuffle': True, 'num_workers': 4, 'pin_memory': True, 'drop_last': False}, 'augment': {'prob': 1, 'Flip_prob': 0, 'HueSaturationValue_prob': 0, 'RandomBrightnessContrast_prob': 0, 'crop_prob': 0, 'randomrotate90_prob': 0, 'elastictransform_prob': 0, 'gridistortion_prob': 0, 'opticaldistortion_prob': 0, 'verticalflip_prob': 0, 'horizontalflip_prob': 0, 'randomgamma_prob': 0, 'CoarseDropout_prob': 0, 'RGBShift_prob': 0, 'MotionBlur_prob': 0, 'MedianBlur_prob': 0, 'GaussianBlur_prob': 0, 'GaussNoise_prob': 0, 'ChannelShuffle_prob': 0}}}
2023-06-03 23:52:56.498 | INFO     | __main__:main:59 - Getting datapath
2023-06-03 23:52:56.506 | INFO     | __main__:main:74 - There are 1000 images to train
2023-06-03 23:52:56.506 | INFO     | __main__:main:93 - Train model with no valid dataset
2023-06-03 23:52:56.506 | INFO     | __main__:main:95 - Loading data
2023-06-03 23:52:56.928 | INFO     | __main__:main:112 - 125 batches to train
2023-06-03 23:52:56.929 | INFO     | __main__:main:125 - Loading model
2023-06-03 23:52:56.929 | INFO     | __main__:main:146 - Loading checkpoint from mit_b3.pth ...
2023-06-03 23:53:03.376 | INFO     | __main__:main:190 - Training with FP32 ...
2023-06-03 23:58:24.672 | INFO     | trainer:train_loop:183 - Epoch: [1/ 100] | Train loss: [2.021934953212738]
2023-06-04 00:03:46.752 | INFO     | trainer:train_loop:183 - Epoch: [2/ 100] | Train loss: [0.8007863068580627]
2023-06-04 00:09:08.006 | INFO     | trainer:train_loop:183 - Epoch: [3/ 100] | Train loss: [0.6717736377716065]
2023-06-04 00:14:30.529 | INFO     | trainer:train_loop:183 - Epoch: [4/ 100] | Train loss: [0.5662588055133819]
2023-06-04 00:19:53.309 | INFO     | trainer:train_loop:183 - Epoch: [5/ 100] | Train loss: [0.43067318379879]
2023-06-04 00:25:15.595 | INFO     | trainer:train_loop:183 - Epoch: [6/ 100] | Train loss: [0.3686042232513428]
2023-06-04 00:30:36.475 | INFO     | trainer:train_loop:183 - Epoch: [7/ 100] | Train loss: [0.33619610929489135]
2023-06-04 00:36:00.512 | INFO     | trainer:train_loop:183 - Epoch: [8/ 100] | Train loss: [0.3232750060558319]
2023-06-04 00:41:24.538 | INFO     | trainer:train_loop:183 - Epoch: [9/ 100] | Train loss: [0.2678305124640465]
2023-06-04 00:46:48.541 | INFO     | trainer:train_loop:183 - Epoch: [10/ 100] | Train loss: [0.22220938742160798]
2023-06-04 00:52:13.679 | INFO     | trainer:train_loop:183 - Epoch: [11/ 100] | Train loss: [0.21121724319458007]
2023-06-04 00:57:35.951 | INFO     | trainer:train_loop:183 - Epoch: [12/ 100] | Train loss: [0.21729154914617538]
2023-06-04 01:02:58.866 | INFO     | trainer:train_loop:183 - Epoch: [13/ 100] | Train loss: [0.1857499377131462]
2023-06-04 01:08:24.958 | INFO     | trainer:train_loop:183 - Epoch: [14/ 100] | Train loss: [0.1791585921049118]
2023-06-04 01:13:47.711 | INFO     | trainer:train_loop:183 - Epoch: [15/ 100] | Train loss: [0.16242520636320115]
2023-06-04 01:19:09.355 | INFO     | trainer:train_loop:183 - Epoch: [16/ 100] | Train loss: [0.1553952748477459]
2023-06-04 01:24:33.616 | INFO     | trainer:train_loop:183 - Epoch: [17/ 100] | Train loss: [0.14726557978987695]
2023-06-04 01:29:55.014 | INFO     | trainer:train_loop:183 - Epoch: [18/ 100] | Train loss: [0.17290067505836487]
2023-06-04 01:35:16.200 | INFO     | trainer:train_loop:183 - Epoch: [19/ 100] | Train loss: [0.1614237878024578]
2023-06-04 01:40:40.252 | INFO     | trainer:train_loop:183 - Epoch: [20/ 100] | Train loss: [0.1497907584309578]
2023-06-04 01:46:04.261 | INFO     | trainer:train_loop:183 - Epoch: [21/ 100] | Train loss: [0.19033582985401154]
2023-06-04 01:51:29.456 | INFO     | trainer:train_loop:183 - Epoch: [22/ 100] | Train loss: [0.15001264029741287]
2023-06-04 01:56:55.248 | INFO     | trainer:train_loop:183 - Epoch: [23/ 100] | Train loss: [0.12587498930096627]
2023-06-04 02:02:18.722 | INFO     | trainer:train_loop:183 - Epoch: [24/ 100] | Train loss: [0.11841802862286567]
2023-06-04 02:07:42.263 | INFO     | trainer:train_loop:183 - Epoch: [25/ 100] | Train loss: [0.11463270249962806]
2023-06-04 02:13:05.377 | INFO     | trainer:train_loop:183 - Epoch: [26/ 100] | Train loss: [0.1174701474905014]
2023-06-04 02:18:29.300 | INFO     | trainer:train_loop:183 - Epoch: [27/ 100] | Train loss: [0.10375007483363151]
2023-06-04 02:23:51.674 | INFO     | trainer:train_loop:183 - Epoch: [28/ 100] | Train loss: [0.09196725261211396]
2023-06-04 02:29:14.164 | INFO     | trainer:train_loop:183 - Epoch: [29/ 100] | Train loss: [0.1007020969092846]
2023-06-04 02:34:40.291 | INFO     | trainer:train_loop:183 - Epoch: [30/ 100] | Train loss: [0.10594648423790931]
2023-06-04 02:40:04.061 | INFO     | trainer:train_loop:183 - Epoch: [31/ 100] | Train loss: [0.08984153062105178]
2023-06-04 02:45:29.848 | INFO     | trainer:train_loop:183 - Epoch: [32/ 100] | Train loss: [0.09038014402985572]
2023-06-04 02:50:51.382 | INFO     | trainer:train_loop:183 - Epoch: [33/ 100] | Train loss: [0.09183133351802826]
2023-06-04 02:56:16.580 | INFO     | trainer:train_loop:183 - Epoch: [34/ 100] | Train loss: [0.08608541220426559]
2023-06-04 03:01:39.607 | INFO     | trainer:train_loop:183 - Epoch: [35/ 100] | Train loss: [0.09448627004027367]
2023-06-04 03:07:03.034 | INFO     | trainer:train_loop:183 - Epoch: [36/ 100] | Train loss: [0.09023309627175331]
2023-06-04 03:12:28.698 | INFO     | trainer:train_loop:183 - Epoch: [37/ 100] | Train loss: [0.07892799720168114]
2023-06-04 03:17:52.922 | INFO     | trainer:train_loop:183 - Epoch: [38/ 100] | Train loss: [0.07706853854656219]
2023-06-04 03:23:18.773 | INFO     | trainer:train_loop:183 - Epoch: [39/ 100] | Train loss: [0.08576393520832062]
2023-06-04 03:28:45.300 | INFO     | trainer:train_loop:183 - Epoch: [40/ 100] | Train loss: [0.07807630434632301]
2023-06-04 03:34:09.681 | INFO     | trainer:train_loop:183 - Epoch: [41/ 100] | Train loss: [0.07134344431757927]
2023-06-04 03:39:33.640 | INFO     | trainer:train_loop:183 - Epoch: [42/ 100] | Train loss: [0.07269947946071625]
2023-06-04 03:44:57.647 | INFO     | trainer:train_loop:183 - Epoch: [43/ 100] | Train loss: [0.0952811040878296]
2023-06-04 03:50:22.057 | INFO     | trainer:train_loop:183 - Epoch: [44/ 100] | Train loss: [0.07165235015749931]
2023-06-04 03:55:45.471 | INFO     | trainer:train_loop:183 - Epoch: [45/ 100] | Train loss: [0.07068525660037994]
2023-06-04 04:01:10.966 | INFO     | trainer:train_loop:183 - Epoch: [46/ 100] | Train loss: [0.06381079334020615]
2023-06-04 04:06:36.937 | INFO     | trainer:train_loop:183 - Epoch: [47/ 100] | Train loss: [0.06522911964356899]
2023-06-04 04:12:03.031 | INFO     | trainer:train_loop:183 - Epoch: [48/ 100] | Train loss: [0.0627878791987896]
2023-06-04 04:17:28.333 | INFO     | trainer:train_loop:183 - Epoch: [49/ 100] | Train loss: [0.06216215392947197]
2023-06-04 04:22:54.415 | INFO     | trainer:train_loop:183 - Epoch: [50/ 100] | Train loss: [0.06819814747571945]
2023-06-04 04:28:17.209 | INFO     | trainer:train_loop:183 - Epoch: [51/ 100] | Train loss: [0.06971867924928665]
2023-06-04 04:33:41.588 | INFO     | trainer:train_loop:183 - Epoch: [52/ 100] | Train loss: [0.059653304368257526]
2023-06-04 04:39:07.891 | INFO     | trainer:train_loop:183 - Epoch: [53/ 100] | Train loss: [0.06265308117866517]
2023-06-04 04:44:35.166 | INFO     | trainer:train_loop:183 - Epoch: [54/ 100] | Train loss: [0.05744420187175274]
2023-06-04 04:50:02.499 | INFO     | trainer:train_loop:183 - Epoch: [55/ 100] | Train loss: [0.059312449738383295]
2023-06-04 04:55:25.951 | INFO     | trainer:train_loop:183 - Epoch: [56/ 100] | Train loss: [0.05836518907546997]
2023-06-04 05:00:49.075 | INFO     | trainer:train_loop:183 - Epoch: [57/ 100] | Train loss: [0.05734989473223686]
2023-06-04 05:06:14.077 | INFO     | trainer:train_loop:183 - Epoch: [58/ 100] | Train loss: [0.059739363104105]
2023-06-04 05:11:39.758 | INFO     | trainer:train_loop:183 - Epoch: [59/ 100] | Train loss: [0.058097657889127734]
2023-06-04 05:17:04.842 | INFO     | trainer:train_loop:183 - Epoch: [60/ 100] | Train loss: [0.05513444837927818]
2023-06-04 05:22:29.917 | INFO     | trainer:train_loop:183 - Epoch: [61/ 100] | Train loss: [0.054484696686267854]
2023-06-04 05:27:55.567 | INFO     | trainer:train_loop:183 - Epoch: [62/ 100] | Train loss: [0.05292832162976265]
2023-06-04 05:33:21.105 | INFO     | trainer:train_loop:183 - Epoch: [63/ 100] | Train loss: [0.054333541706204413]
2023-06-04 05:38:46.076 | INFO     | trainer:train_loop:183 - Epoch: [64/ 100] | Train loss: [0.05126554653048515]
2023-06-04 05:44:11.308 | INFO     | trainer:train_loop:183 - Epoch: [65/ 100] | Train loss: [0.05013749323785305]
2023-06-04 05:49:37.607 | INFO     | trainer:train_loop:183 - Epoch: [66/ 100] | Train loss: [0.05233711463212967]
2023-06-04 05:55:05.493 | INFO     | trainer:train_loop:183 - Epoch: [67/ 100] | Train loss: [0.05110037173330784]
2023-06-04 06:00:31.965 | INFO     | trainer:train_loop:183 - Epoch: [68/ 100] | Train loss: [0.05098832160234451]
2023-06-04 06:05:59.112 | INFO     | trainer:train_loop:183 - Epoch: [69/ 100] | Train loss: [0.04853447289764881]
2023-06-04 06:11:26.782 | INFO     | trainer:train_loop:183 - Epoch: [70/ 100] | Train loss: [0.048957922115921974]
2023-06-04 06:16:51.520 | INFO     | trainer:train_loop:183 - Epoch: [71/ 100] | Train loss: [0.04934222224354744]
2023-06-04 06:22:18.919 | INFO     | trainer:train_loop:183 - Epoch: [72/ 100] | Train loss: [0.050884716153144834]
2023-06-04 06:27:46.105 | INFO     | trainer:train_loop:183 - Epoch: [73/ 100] | Train loss: [0.047850369155406955]
2023-06-04 06:33:10.715 | INFO     | trainer:train_loop:183 - Epoch: [74/ 100] | Train loss: [0.04710253468155861]
2023-06-04 06:38:35.005 | INFO     | trainer:train_loop:183 - Epoch: [75/ 100] | Train loss: [0.04579033161699772]
2023-06-04 06:43:58.798 | INFO     | trainer:train_loop:183 - Epoch: [76/ 100] | Train loss: [0.048490221068263055]
2023-06-04 06:49:26.647 | INFO     | trainer:train_loop:183 - Epoch: [77/ 100] | Train loss: [0.046172928526997566]
2023-06-04 06:54:53.325 | INFO     | trainer:train_loop:183 - Epoch: [78/ 100] | Train loss: [0.046062156692147256]
2023-06-04 07:00:20.531 | INFO     | trainer:train_loop:183 - Epoch: [79/ 100] | Train loss: [0.04748743349313736]
2023-06-04 07:05:45.853 | INFO     | trainer:train_loop:183 - Epoch: [80/ 100] | Train loss: [0.04741466200351715]
2023-06-04 07:11:10.416 | INFO     | trainer:train_loop:183 - Epoch: [81/ 100] | Train loss: [0.0482477817684412]
2023-06-04 07:16:37.943 | INFO     | trainer:train_loop:183 - Epoch: [82/ 100] | Train loss: [0.046350058540701865]
2023-06-04 07:22:01.459 | INFO     | trainer:train_loop:183 - Epoch: [83/ 100] | Train loss: [0.0451881785094738]
2023-06-04 07:27:24.630 | INFO     | trainer:train_loop:183 - Epoch: [84/ 100] | Train loss: [0.0449790194183588]
2023-06-04 07:32:51.284 | INFO     | trainer:train_loop:183 - Epoch: [85/ 100] | Train loss: [0.047152528688311574]
2023-06-04 07:38:18.121 | INFO     | trainer:train_loop:183 - Epoch: [86/ 100] | Train loss: [0.04777706290781498]
2023-06-04 07:43:44.537 | INFO     | trainer:train_loop:183 - Epoch: [87/ 100] | Train loss: [0.047243375808000566]
2023-06-04 07:49:08.552 | INFO     | trainer:train_loop:183 - Epoch: [88/ 100] | Train loss: [0.04485477130115032]
2023-06-04 07:54:32.925 | INFO     | trainer:train_loop:183 - Epoch: [89/ 100] | Train loss: [0.04550820514559746]
2023-06-04 07:59:55.956 | INFO     | trainer:train_loop:183 - Epoch: [90/ 100] | Train loss: [0.04600416895747185]
2023-06-04 08:05:20.394 | INFO     | trainer:train_loop:183 - Epoch: [91/ 100] | Train loss: [0.04422576539218426]
2023-06-04 08:10:47.321 | INFO     | trainer:train_loop:183 - Epoch: [92/ 100] | Train loss: [0.04391808193922043]
2023-06-04 08:16:13.786 | INFO     | trainer:train_loop:183 - Epoch: [93/ 100] | Train loss: [0.04379377882182598]
2023-06-04 08:21:41.449 | INFO     | trainer:train_loop:183 - Epoch: [94/ 100] | Train loss: [0.04404137681424618]
2023-06-04 08:27:07.624 | INFO     | trainer:train_loop:183 - Epoch: [95/ 100] | Train loss: [0.04459865160286427]
2023-06-04 08:32:34.785 | INFO     | trainer:train_loop:183 - Epoch: [96/ 100] | Train loss: [0.04402760428190231]
2023-06-04 08:37:57.070 | INFO     | trainer:train_loop:183 - Epoch: [97/ 100] | Train loss: [0.04340542361140251]
2023-06-04 08:43:16.800 | INFO     | trainer:train_loop:183 - Epoch: [98/ 100] | Train loss: [0.04368433700501919]
2023-06-04 08:48:37.915 | INFO     | trainer:train_loop:183 - Epoch: [99/ 100] | Train loss: [0.04429820890724659]
2023-06-04 08:54:00.040 | INFO     | trainer:train_loop:183 - Epoch: [100/ 100] | Train loss: [0.04482494255900383]
2023-06-04 08:54:00.520 | INFO     | trainer:train_loop:195 - [Saving Snapshot:]/root/neo_code_reco/configs/checkpoint_mb_with_local/MiT-B3-FaPNHead_100.pth
2023-06-04 08:54:00.521 | INFO     | trainer:train_loop:204 - Training cost: 32455.527889303863seconds
