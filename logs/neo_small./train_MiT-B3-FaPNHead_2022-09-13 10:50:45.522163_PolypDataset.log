2022-09-13 10:50:45.526 | INFO     | __main__:main:57 - Load config from configs/neo_small.yaml
2022-09-13 10:50:45.526 | INFO     | __main__:main:58 - {'dataset': {'data_path': '/home/s/hungpv/polyps/dataset', 'train_data_path': ['/home/s/hungpv/polyps/dataset/neo_small/train'], 'test_data_path': ['/home/s/hungpv/polyps/dataset/neo_small/test'], 'val_data_path': ['/home/s/hungpv/polyps/dataset/neo_small/test']}, 'model': {'num_classes': 3, 'save_dir': '/home/s/hungpv/polyps/checkpoint/neo/neo_small_v3', 'backbone': 'MiT-B3', 'head': 'FaPNHead', 'pretrained': '/home/s/hungpv/polyps/pretrained_models/mit_b3.pth'}, 'optimizer': {'name': 'adam', 'lr': 0.0001, 'clip': 0.5, 'scheduler': 'cosine_warmup', 'loss': 'multi_structure_loss'}, 'dev': 'cuda', 'train': {'start_from': 0, 'save_from': 59, 'num_epochs': 60, 'num_warmup_epoch': 4, 'is_val': False, 'size_rates': [0.75, 1, 1.25], 'dataloader': {'batchsize': 16, 'img_size': 384, 'shuffle': True, 'num_workers': 4, 'pin_memory': True, 'drop_last': True}, 'amp': False, 'ddp': False, 'augment': {'prob': 1, 'Flip_prob': 0.5, 'HueSaturationValue_prob': 0.5, 'RandomBrightnessContrast_prob': 0.5, 'crop_prob': 0.0, 'randomrotate90_prob': 0.5, 'ColorJitter_prob': 0.5}}, 'val': {'dataloader': {'batchsize': 8, 'img_size': 384, 'shuffle': True, 'num_workers': 4, 'pin_memory': True, 'drop_last': False}}, 'test': {'dev': 'cuda', 'visualize': True, 'visualize_dir': '/home/s/hungpv/polyps/neo_visualize', 'vis_x': 180, 'vis_overwrite': False, 'checkpoint_dir': '/home/s/hungpv/polyps/checkpoint/neo/neo_small_v1/MiT-B3-FaPNHead_60.pth', 'dataloader': {'batchsize': 1, 'img_size': 384, 'shuffle': True, 'num_workers': 4, 'pin_memory': True, 'drop_last': False}, 'augment': {'prob': 1, 'Flip_prob': 0, 'HueSaturationValue_prob': 0, 'RandomBrightnessContrast_prob': 0, 'crop_prob': 0, 'randomrotate90_prob': 0, 'elastictransform_prob': 0, 'gridistortion_prob': 0, 'opticaldistortion_prob': 0, 'verticalflip_prob': 0, 'horizontalflip_prob': 0, 'randomgamma_prob': 0, 'CoarseDropout_prob': 0, 'RGBShift_prob': 0, 'MotionBlur_prob': 0, 'MedianBlur_prob': 0, 'GaussianBlur_prob': 0, 'GaussNoise_prob': 0, 'ChannelShuffle_prob': 0}}}
2022-09-13 10:50:45.526 | INFO     | __main__:main:59 - Getting datapath
2022-09-13 10:50:45.531 | INFO     | __main__:main:74 - There are 1000 images to train
2022-09-13 10:50:45.532 | INFO     | __main__:main:93 - Train model with no valid dataset
2022-09-13 10:50:45.532 | INFO     | __main__:main:95 - Loading data
2022-09-13 10:50:45.618 | INFO     | __main__:main:109 - 62 batches to train
2022-09-13 10:50:45.618 | INFO     | __main__:main:122 - Loading model
2022-09-13 10:50:45.618 | INFO     | __main__:main:143 - Loading checkpoint from /home/s/hungpv/polyps/pretrained_models/mit_b3.pth ...
2022-09-13 10:50:48.726 | INFO     | __main__:main:187 - Training with FP32 ...
2022-09-13 10:53:58.356 | INFO     | tools.trainer:train_loop:126 - Epoch: [1/ 60] | Train loss: [2.289766178977105]
2022-09-13 11:00:22.511 | INFO     | tools.trainer:train_loop:126 - Epoch: [2/ 60] | Train loss: [1.016581214243366]
2022-09-13 11:07:29.445 | INFO     | tools.trainer:train_loop:126 - Epoch: [3/ 60] | Train loss: [0.7112518645101978]
2022-09-13 11:15:03.265 | INFO     | tools.trainer:train_loop:126 - Epoch: [4/ 60] | Train loss: [0.6261626107077445]
2022-09-13 11:22:45.675 | INFO     | tools.trainer:train_loop:126 - Epoch: [5/ 60] | Train loss: [0.5555670213314795]
2022-09-13 11:30:25.531 | INFO     | tools.trainer:train_loop:126 - Epoch: [6/ 60] | Train loss: [0.49974307129459994]
2022-09-13 11:38:13.128 | INFO     | tools.trainer:train_loop:126 - Epoch: [7/ 60] | Train loss: [0.43255421855757314]
2022-09-13 11:45:52.062 | INFO     | tools.trainer:train_loop:126 - Epoch: [8/ 60] | Train loss: [0.33041013681119485]
2022-09-13 11:53:37.606 | INFO     | tools.trainer:train_loop:126 - Epoch: [9/ 60] | Train loss: [0.30754666715379686]
2022-09-13 12:01:23.432 | INFO     | tools.trainer:train_loop:126 - Epoch: [10/ 60] | Train loss: [0.5127864559331248]
2022-09-13 12:09:17.211 | INFO     | tools.trainer:train_loop:126 - Epoch: [11/ 60] | Train loss: [0.42394748690628237]
2022-09-13 12:17:11.179 | INFO     | tools.trainer:train_loop:126 - Epoch: [12/ 60] | Train loss: [0.3424510881304741]
2022-09-13 12:24:08.749 | INFO     | tools.trainer:train_loop:126 - Epoch: [13/ 60] | Train loss: [0.3045848014373933]
2022-09-13 12:26:59.220 | INFO     | tools.trainer:train_loop:126 - Epoch: [14/ 60] | Train loss: [0.2850046905298387]
2022-09-13 12:29:20.486 | INFO     | tools.trainer:train_loop:126 - Epoch: [15/ 60] | Train loss: [0.28078065980826655]
2022-09-13 12:31:34.617 | INFO     | tools.trainer:train_loop:126 - Epoch: [16/ 60] | Train loss: [0.24253133924738055]
2022-09-13 12:33:45.066 | INFO     | tools.trainer:train_loop:126 - Epoch: [17/ 60] | Train loss: [0.2766927431427663]
2022-09-13 12:35:53.996 | INFO     | tools.trainer:train_loop:126 - Epoch: [18/ 60] | Train loss: [0.24749280944947274]
2022-09-13 12:38:01.497 | INFO     | tools.trainer:train_loop:126 - Epoch: [19/ 60] | Train loss: [0.266596723107561]
2022-09-13 12:40:09.106 | INFO     | tools.trainer:train_loop:126 - Epoch: [20/ 60] | Train loss: [0.23837262824658426]
2022-09-13 12:42:14.180 | INFO     | tools.trainer:train_loop:126 - Epoch: [21/ 60] | Train loss: [0.22332876788512354]
2022-09-13 12:44:19.445 | INFO     | tools.trainer:train_loop:126 - Epoch: [22/ 60] | Train loss: [0.2286034501608341]
2022-09-13 12:46:24.379 | INFO     | tools.trainer:train_loop:126 - Epoch: [23/ 60] | Train loss: [0.22217978140519512]
2022-09-13 12:48:28.544 | INFO     | tools.trainer:train_loop:126 - Epoch: [24/ 60] | Train loss: [0.21972699379248004]
2022-09-13 12:50:33.252 | INFO     | tools.trainer:train_loop:126 - Epoch: [25/ 60] | Train loss: [0.19916388933216372]
2022-09-13 12:52:37.060 | INFO     | tools.trainer:train_loop:126 - Epoch: [26/ 60] | Train loss: [0.21976163935276768]
2022-09-13 12:54:40.245 | INFO     | tools.trainer:train_loop:126 - Epoch: [27/ 60] | Train loss: [0.17847176040372542]
2022-09-13 12:56:43.197 | INFO     | tools.trainer:train_loop:126 - Epoch: [28/ 60] | Train loss: [0.22651642957522022]
2022-09-13 12:58:47.215 | INFO     | tools.trainer:train_loop:126 - Epoch: [29/ 60] | Train loss: [0.2737984579176672]
2022-09-13 13:00:50.941 | INFO     | tools.trainer:train_loop:126 - Epoch: [30/ 60] | Train loss: [0.24649359009438945]
2022-09-13 13:02:55.926 | INFO     | tools.trainer:train_loop:126 - Epoch: [31/ 60] | Train loss: [0.21955527653617243]
2022-09-13 13:05:01.111 | INFO     | tools.trainer:train_loop:126 - Epoch: [32/ 60] | Train loss: [0.20713821930750723]
2022-09-13 13:07:06.787 | INFO     | tools.trainer:train_loop:126 - Epoch: [33/ 60] | Train loss: [0.2050603533223752]
2022-09-13 13:09:12.272 | INFO     | tools.trainer:train_loop:126 - Epoch: [34/ 60] | Train loss: [0.18527302362265125]
2022-09-13 13:11:17.997 | INFO     | tools.trainer:train_loop:126 - Epoch: [35/ 60] | Train loss: [0.19299152229101427]
2022-09-13 13:13:23.653 | INFO     | tools.trainer:train_loop:126 - Epoch: [36/ 60] | Train loss: [0.1845276364155354]
2022-09-13 13:15:28.604 | INFO     | tools.trainer:train_loop:126 - Epoch: [37/ 60] | Train loss: [0.17421400943590748]
2022-09-13 13:17:34.537 | INFO     | tools.trainer:train_loop:126 - Epoch: [38/ 60] | Train loss: [0.17577504300542415]
2022-09-13 13:19:41.280 | INFO     | tools.trainer:train_loop:126 - Epoch: [39/ 60] | Train loss: [0.15733830084002787]
2022-09-13 13:21:46.832 | INFO     | tools.trainer:train_loop:126 - Epoch: [40/ 60] | Train loss: [0.16189275045068033]
2022-09-13 13:23:51.164 | INFO     | tools.trainer:train_loop:126 - Epoch: [41/ 60] | Train loss: [0.16105368030407735]
2022-09-13 13:25:56.391 | INFO     | tools.trainer:train_loop:126 - Epoch: [42/ 60] | Train loss: [0.18285141374555328]
2022-09-13 13:28:00.678 | INFO     | tools.trainer:train_loop:126 - Epoch: [43/ 60] | Train loss: [0.1761382259428501]
2022-09-13 13:30:06.952 | INFO     | tools.trainer:train_loop:126 - Epoch: [44/ 60] | Train loss: [0.1637796617804035]
2022-09-13 13:32:34.814 | INFO     | tools.trainer:train_loop:126 - Epoch: [45/ 60] | Train loss: [0.1672482227365817]
2022-09-13 13:38:14.384 | INFO     | tools.trainer:train_loop:126 - Epoch: [46/ 60] | Train loss: [0.1522972362656747]
2022-09-13 13:45:18.241 | INFO     | tools.trainer:train_loop:126 - Epoch: [47/ 60] | Train loss: [0.14601741040185576]
2022-09-13 13:52:39.560 | INFO     | tools.trainer:train_loop:126 - Epoch: [48/ 60] | Train loss: [0.1517393329451161]
2022-09-13 13:59:54.062 | INFO     | tools.trainer:train_loop:126 - Epoch: [49/ 60] | Train loss: [0.14113600125476236]
2022-09-13 14:06:54.223 | INFO     | tools.trainer:train_loop:126 - Epoch: [50/ 60] | Train loss: [0.14370412571776298]
2022-09-13 14:13:45.906 | INFO     | tools.trainer:train_loop:126 - Epoch: [51/ 60] | Train loss: [0.13465274822327397]
2022-09-13 14:20:47.727 | INFO     | tools.trainer:train_loop:126 - Epoch: [52/ 60] | Train loss: [0.1366422455157003]
2022-09-13 14:27:40.563 | INFO     | tools.trainer:train_loop:126 - Epoch: [53/ 60] | Train loss: [0.13533500503868826]
2022-09-13 14:34:35.135 | INFO     | tools.trainer:train_loop:126 - Epoch: [54/ 60] | Train loss: [0.1272157284641458]
2022-09-13 14:41:23.251 | INFO     | tools.trainer:train_loop:126 - Epoch: [55/ 60] | Train loss: [0.12493471170385037]
2022-09-13 14:48:32.349 | INFO     | tools.trainer:train_loop:126 - Epoch: [56/ 60] | Train loss: [0.12370639258334713]
2022-09-13 14:55:41.589 | INFO     | tools.trainer:train_loop:126 - Epoch: [57/ 60] | Train loss: [0.12569010443985462]
2022-09-13 15:02:46.714 | INFO     | tools.trainer:train_loop:126 - Epoch: [58/ 60] | Train loss: [0.12770603627206817]
2022-09-13 15:07:06.685 | INFO     | tools.trainer:train_loop:126 - Epoch: [59/ 60] | Train loss: [0.11933904862211596]
2022-09-13 15:09:33.991 | INFO     | tools.trainer:train_loop:126 - Epoch: [60/ 60] | Train loss: [0.12213079174680094]
2022-09-13 15:09:34.396 | INFO     | tools.trainer:train_loop:138 - [Saving Snapshot:]/home/s/hungpv/polyps/checkpoint/neo/neo_small_v3/MiT-B3-FaPNHead_60.pth
2022-09-13 15:09:34.397 | INFO     | tools.trainer:train_loop:147 - Training cost: 15524.65412057424seconds
