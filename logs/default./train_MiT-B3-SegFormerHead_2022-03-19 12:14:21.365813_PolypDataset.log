2022-03-19 12:14:21.367 | INFO     | __main__:main:45 - Load config from configs/default.yaml
2022-03-19 12:14:21.367 | INFO     | __main__:main:46 - {'dataset': {'data_path': '/home/admin_mcn/hungpv/polyps/dataset/KCECE', 'train_data_path': ['/home/admin_mcn/hungpv/polyps/dataset/KCECE/TrainDataset'], 'test_data_path': ['/home/admin_mcn/hungpv/polyps/dataset/KCECE/TestDataset/CVC-ClinicDB'], 'val_data_path': ['/home/admin_mcn/hungpv/polyps/dataset/KCECE/TestDataset/CVC-300']}, 'model': {'num_classes': 1, 'save_dir': '/mnt/data/hungpv/polyps/checkpoint/KCECE/default', 'backbone': 'MiT-B3', 'head': 'SegFormerHead', 'pretrained': '/mnt/data/hungpv/polyps/pretrained-backbone/mit_b3.pth'}, 'optimizer': {'name': 'adam', 'lr': 0.0001, 'clip': 0.5, 'scheduler': 'cosine_warmup', 'num_warmup_epoch': 1, 'loss': 'structure_loss'}, 'dev': 'cuda', 'train': {'start_from': 0, 'save_from': 116, 'num_epochs': 120, 'num_warmup_epoch': 8, 'is_val': False, 'size_rates': [0.75, 1, 1.25], 'dataloader': {'batchsize': 16, 'img_size': 352, 'shuffle': True, 'num_workers': 2, 'pin_memory': True, 'drop_last': True}, 'amp': False, 'ddp': False, 'augment': {'prob': 1, 'Flip_prob': 0.7, 'HueSaturationValue_prob': 0.7, 'RandomBrightnessContrast_prob': 0.5, 'crop_prob': 0.2, 'randomrotate90_prob': 0.7}}, 'test': {'dev': 'cuda', 'visualize': False, 'visualize_dir': '/mnt/data/hungpv/polyps/visualize', 'vis_x': 180, 'vis_overwrite': False, 'dataloader': {'batchsize': 1, 'img_size': 224, 'shuffle': True, 'num_workers': 2, 'pin_memory': True, 'drop_last': True}, 'augment': {'prob': 1, 'Flip_prob': 0, 'HueSaturationValue_prob': 0, 'RandomBrightnessContrast_prob': 0, 'crop_prob': 0, 'randomrotate90_prob': 0, 'elastictransform_prob': 0, 'gridistortion_prob': 0, 'opticaldistortion_prob': 0, 'verticalflip_prob': 0, 'horizontalflip_prob': 0, 'randomgamma_prob': 0, 'CoarseDropout_prob': 0, 'RGBShift_prob': 0, 'MotionBlur_prob': 0, 'MedianBlur_prob': 0, 'GaussianBlur_prob': 0, 'GaussNoise_prob': 0, 'ChannelShuffle_prob': 0}}}
2022-03-19 12:14:21.367 | INFO     | __main__:main:47 - Getting datapath
2022-03-19 12:14:21.373 | INFO     | __main__:main:61 - There are 1450 images to train
2022-03-19 12:14:21.374 | INFO     | __main__:main:80 - Train model with no valid dataset
2022-03-19 12:14:21.374 | INFO     | __main__:main:82 - Loading data
2022-03-19 12:14:21.462 | INFO     | __main__:main:96 - 90 batches to train
2022-03-19 12:14:21.466 | INFO     | __main__:main:109 - Loading model
2022-03-19 12:14:21.466 | INFO     | __main__:main:124 - Loading checkpoint from /mnt/data/hungpv/polyps/pretrained-backbone/mit_b3.pth ...
2022-03-19 12:14:24.114 | INFO     | __main__:main:164 - Training with FP32 ...
2022-03-19 12:16:40.048 | INFO     | tools.trainer:train_loop:89 - Epoch: [1/ 120] | Train loss: [1.325473177433014]
2022-03-19 12:18:55.360 | INFO     | tools.trainer:train_loop:89 - Epoch: [2/ 120] | Train loss: [0.7032621807522244]
2022-03-19 12:21:10.848 | INFO     | tools.trainer:train_loop:89 - Epoch: [3/ 120] | Train loss: [0.5424815045462714]
2022-03-19 12:21:11.050 | INFO     | tools.trainer:train_loop:103 - [Saving Snapshot:]/mnt/data/hungpv/polyps/checkpoint/KCECE/default/MiT-B3-SegFormerHead_3.pth
2022-03-19 12:23:26.300 | INFO     | tools.trainer:train_loop:89 - Epoch: [4/ 120] | Train loss: [0.45602797402275935]
2022-03-19 12:25:41.670 | INFO     | tools.trainer:train_loop:89 - Epoch: [5/ 120] | Train loss: [0.38444844683011375]
2022-03-19 12:27:56.954 | INFO     | tools.trainer:train_loop:89 - Epoch: [6/ 120] | Train loss: [0.3643500193953514]
2022-03-19 12:30:12.417 | INFO     | tools.trainer:train_loop:89 - Epoch: [7/ 120] | Train loss: [0.306645689242416]
2022-03-19 12:32:27.796 | INFO     | tools.trainer:train_loop:89 - Epoch: [8/ 120] | Train loss: [0.2870957997110155]
2022-03-19 12:34:43.285 | INFO     | tools.trainer:train_loop:89 - Epoch: [9/ 120] | Train loss: [0.29642016771766877]
2022-03-19 12:36:59.023 | INFO     | tools.trainer:train_loop:89 - Epoch: [10/ 120] | Train loss: [0.2794144512878524]
2022-03-19 12:39:14.770 | INFO     | tools.trainer:train_loop:89 - Epoch: [11/ 120] | Train loss: [0.25900176647636625]
2022-03-19 12:41:30.733 | INFO     | tools.trainer:train_loop:89 - Epoch: [12/ 120] | Train loss: [0.2531396120786667]
2022-03-19 12:43:46.943 | INFO     | tools.trainer:train_loop:89 - Epoch: [13/ 120] | Train loss: [0.23254019154442682]
2022-03-19 12:46:02.910 | INFO     | tools.trainer:train_loop:89 - Epoch: [14/ 120] | Train loss: [0.24079693837298288]
2022-03-19 12:48:18.681 | INFO     | tools.trainer:train_loop:89 - Epoch: [15/ 120] | Train loss: [0.22953439437680775]
2022-03-19 12:50:34.975 | INFO     | tools.trainer:train_loop:89 - Epoch: [16/ 120] | Train loss: [0.24455316795243157]
2022-03-19 12:52:50.794 | INFO     | tools.trainer:train_loop:89 - Epoch: [17/ 120] | Train loss: [0.22070006744729148]
2022-03-19 12:55:06.469 | INFO     | tools.trainer:train_loop:89 - Epoch: [18/ 120] | Train loss: [0.2052688712047206]
2022-03-19 12:57:22.461 | INFO     | tools.trainer:train_loop:89 - Epoch: [19/ 120] | Train loss: [0.20919975075456831]
2022-03-19 12:59:38.535 | INFO     | tools.trainer:train_loop:89 - Epoch: [20/ 120] | Train loss: [0.19115630719396803]
2022-03-19 13:01:54.494 | INFO     | tools.trainer:train_loop:89 - Epoch: [21/ 120] | Train loss: [0.20532293932305443]
2022-03-19 13:04:10.263 | INFO     | tools.trainer:train_loop:89 - Epoch: [22/ 120] | Train loss: [0.20209247585799958]
2022-03-19 13:06:26.211 | INFO     | tools.trainer:train_loop:89 - Epoch: [23/ 120] | Train loss: [0.2087310853931639]
2022-03-19 13:08:42.309 | INFO     | tools.trainer:train_loop:89 - Epoch: [24/ 120] | Train loss: [0.19220875650644303]
2022-03-19 13:10:58.303 | INFO     | tools.trainer:train_loop:89 - Epoch: [25/ 120] | Train loss: [0.19274074054426618]
2022-03-19 13:13:14.122 | INFO     | tools.trainer:train_loop:89 - Epoch: [26/ 120] | Train loss: [0.18380979415443208]
2022-03-19 13:15:29.941 | INFO     | tools.trainer:train_loop:89 - Epoch: [27/ 120] | Train loss: [0.18127497086922328]
2022-03-19 13:17:45.814 | INFO     | tools.trainer:train_loop:89 - Epoch: [28/ 120] | Train loss: [0.18360966799987688]
2022-03-19 13:20:01.853 | INFO     | tools.trainer:train_loop:89 - Epoch: [29/ 120] | Train loss: [0.18521516513493325]
2022-03-19 13:22:17.744 | INFO     | tools.trainer:train_loop:89 - Epoch: [30/ 120] | Train loss: [0.17520255992809933]
2022-03-19 13:24:33.536 | INFO     | tools.trainer:train_loop:89 - Epoch: [31/ 120] | Train loss: [0.16911992662482792]
2022-03-19 13:26:49.486 | INFO     | tools.trainer:train_loop:89 - Epoch: [32/ 120] | Train loss: [0.17161582849091953]
2022-03-19 13:29:05.198 | INFO     | tools.trainer:train_loop:89 - Epoch: [33/ 120] | Train loss: [0.1634946902592977]
2022-03-19 13:31:21.278 | INFO     | tools.trainer:train_loop:89 - Epoch: [34/ 120] | Train loss: [0.1654373821285036]
2022-03-19 13:33:37.167 | INFO     | tools.trainer:train_loop:89 - Epoch: [35/ 120] | Train loss: [0.17349760896629757]
2022-03-19 13:35:53.179 | INFO     | tools.trainer:train_loop:89 - Epoch: [36/ 120] | Train loss: [0.1719304730494817]
2022-03-19 13:38:09.087 | INFO     | tools.trainer:train_loop:89 - Epoch: [37/ 120] | Train loss: [0.17479837760329248]
2022-03-19 13:40:25.002 | INFO     | tools.trainer:train_loop:89 - Epoch: [38/ 120] | Train loss: [0.16568892863061693]
2022-03-19 13:42:40.799 | INFO     | tools.trainer:train_loop:89 - Epoch: [39/ 120] | Train loss: [0.14848579052421781]
2022-03-19 13:44:56.814 | INFO     | tools.trainer:train_loop:89 - Epoch: [40/ 120] | Train loss: [0.16006175991561677]
2022-03-19 13:47:12.696 | INFO     | tools.trainer:train_loop:89 - Epoch: [41/ 120] | Train loss: [0.16584302865796618]
2022-03-19 13:49:28.583 | INFO     | tools.trainer:train_loop:89 - Epoch: [42/ 120] | Train loss: [0.15617934068044026]
2022-03-19 13:51:44.633 | INFO     | tools.trainer:train_loop:89 - Epoch: [43/ 120] | Train loss: [0.16302207989825143]
2022-03-19 13:54:00.641 | INFO     | tools.trainer:train_loop:89 - Epoch: [44/ 120] | Train loss: [0.1541527181863785]
2022-03-19 13:56:16.730 | INFO     | tools.trainer:train_loop:89 - Epoch: [45/ 120] | Train loss: [0.16503246997793516]
2022-03-19 13:58:32.952 | INFO     | tools.trainer:train_loop:89 - Epoch: [46/ 120] | Train loss: [0.1668145910733276]
2022-03-19 14:00:48.984 | INFO     | tools.trainer:train_loop:89 - Epoch: [47/ 120] | Train loss: [0.16810749280783865]
2022-03-19 14:03:04.946 | INFO     | tools.trainer:train_loop:89 - Epoch: [48/ 120] | Train loss: [0.14788661474982898]
2022-03-19 14:05:21.019 | INFO     | tools.trainer:train_loop:89 - Epoch: [49/ 120] | Train loss: [0.1384375951356358]
2022-03-19 14:07:37.150 | INFO     | tools.trainer:train_loop:89 - Epoch: [50/ 120] | Train loss: [0.1423119314842754]
2022-03-19 14:09:53.039 | INFO     | tools.trainer:train_loop:89 - Epoch: [51/ 120] | Train loss: [0.1425330638885498]
2022-03-19 14:12:08.875 | INFO     | tools.trainer:train_loop:89 - Epoch: [52/ 120] | Train loss: [0.1439542927675777]
2022-03-19 14:14:24.866 | INFO     | tools.trainer:train_loop:89 - Epoch: [53/ 120] | Train loss: [0.14864952655302155]
2022-03-19 14:16:41.223 | INFO     | tools.trainer:train_loop:89 - Epoch: [54/ 120] | Train loss: [0.14227806520130898]
2022-03-19 14:18:57.217 | INFO     | tools.trainer:train_loop:89 - Epoch: [55/ 120] | Train loss: [0.14480392295453284]
2022-03-19 14:21:13.252 | INFO     | tools.trainer:train_loop:89 - Epoch: [56/ 120] | Train loss: [0.15437172858251466]
2022-03-19 14:23:29.217 | INFO     | tools.trainer:train_loop:89 - Epoch: [57/ 120] | Train loss: [0.1393169696132342]
2022-03-19 14:25:45.364 | INFO     | tools.trainer:train_loop:89 - Epoch: [58/ 120] | Train loss: [0.15796194101373354]
2022-03-19 14:28:01.411 | INFO     | tools.trainer:train_loop:89 - Epoch: [59/ 120] | Train loss: [0.1339715680314435]
2022-03-19 14:30:17.378 | INFO     | tools.trainer:train_loop:89 - Epoch: [60/ 120] | Train loss: [0.1479067836370733]
2022-03-19 14:32:33.349 | INFO     | tools.trainer:train_loop:89 - Epoch: [61/ 120] | Train loss: [0.13552303794357512]
2022-03-19 14:34:49.408 | INFO     | tools.trainer:train_loop:89 - Epoch: [62/ 120] | Train loss: [0.13467245515849854]
2022-03-19 14:37:05.458 | INFO     | tools.trainer:train_loop:89 - Epoch: [63/ 120] | Train loss: [0.1272069441775481]
2022-03-19 14:39:21.518 | INFO     | tools.trainer:train_loop:89 - Epoch: [64/ 120] | Train loss: [0.13153773215081957]
2022-03-19 14:41:37.668 | INFO     | tools.trainer:train_loop:89 - Epoch: [65/ 120] | Train loss: [0.1296373607383834]
2022-03-19 14:43:53.630 | INFO     | tools.trainer:train_loop:89 - Epoch: [66/ 120] | Train loss: [0.12765471281276808]
2022-03-19 14:46:09.588 | INFO     | tools.trainer:train_loop:89 - Epoch: [67/ 120] | Train loss: [0.1260774165391922]
2022-03-19 14:48:25.778 | INFO     | tools.trainer:train_loop:89 - Epoch: [68/ 120] | Train loss: [0.12444213728109996]
2022-03-19 14:50:41.857 | INFO     | tools.trainer:train_loop:89 - Epoch: [69/ 120] | Train loss: [0.11980026761690775]
2022-03-19 14:52:57.735 | INFO     | tools.trainer:train_loop:89 - Epoch: [70/ 120] | Train loss: [0.12688412227564388]
2022-03-19 14:55:13.709 | INFO     | tools.trainer:train_loop:89 - Epoch: [71/ 120] | Train loss: [0.14036929052737024]
2022-03-19 14:57:29.850 | INFO     | tools.trainer:train_loop:89 - Epoch: [72/ 120] | Train loss: [0.12240101968248686]
2022-03-19 14:59:45.611 | INFO     | tools.trainer:train_loop:89 - Epoch: [73/ 120] | Train loss: [0.12788799007733662]
2022-03-19 15:02:01.652 | INFO     | tools.trainer:train_loop:89 - Epoch: [74/ 120] | Train loss: [0.12210154185692469]
2022-03-19 15:04:17.842 | INFO     | tools.trainer:train_loop:89 - Epoch: [75/ 120] | Train loss: [0.12253234684467315]
2022-03-19 15:06:34.024 | INFO     | tools.trainer:train_loop:89 - Epoch: [76/ 120] | Train loss: [0.12181012175149387]
2022-03-19 15:08:50.052 | INFO     | tools.trainer:train_loop:89 - Epoch: [77/ 120] | Train loss: [0.1200181739197837]
2022-03-19 15:11:06.458 | INFO     | tools.trainer:train_loop:89 - Epoch: [78/ 120] | Train loss: [0.12713896251387066]
2022-03-19 15:13:22.652 | INFO     | tools.trainer:train_loop:89 - Epoch: [79/ 120] | Train loss: [0.12107549392514759]
2022-03-19 15:15:38.878 | INFO     | tools.trainer:train_loop:89 - Epoch: [80/ 120] | Train loss: [0.11992189892464214]
2022-03-19 15:17:55.012 | INFO     | tools.trainer:train_loop:89 - Epoch: [81/ 120] | Train loss: [0.1147262790136867]
2022-03-19 15:20:11.172 | INFO     | tools.trainer:train_loop:89 - Epoch: [82/ 120] | Train loss: [0.11499414816498757]
2022-03-19 15:22:27.220 | INFO     | tools.trainer:train_loop:89 - Epoch: [83/ 120] | Train loss: [0.11208266533083386]
2022-03-19 15:24:43.495 | INFO     | tools.trainer:train_loop:89 - Epoch: [84/ 120] | Train loss: [0.11345767080783845]
2022-03-19 15:26:59.609 | INFO     | tools.trainer:train_loop:89 - Epoch: [85/ 120] | Train loss: [0.12995785632067255]
2022-03-19 15:29:15.850 | INFO     | tools.trainer:train_loop:89 - Epoch: [86/ 120] | Train loss: [0.1162570687631766]
2022-03-19 15:31:31.972 | INFO     | tools.trainer:train_loop:89 - Epoch: [87/ 120] | Train loss: [0.11613695522149405]
2022-03-19 15:33:48.210 | INFO     | tools.trainer:train_loop:89 - Epoch: [88/ 120] | Train loss: [0.11422279650966326]
2022-03-19 15:36:04.347 | INFO     | tools.trainer:train_loop:89 - Epoch: [89/ 120] | Train loss: [0.11285095040996869]
2022-03-19 15:38:20.354 | INFO     | tools.trainer:train_loop:89 - Epoch: [90/ 120] | Train loss: [0.1190878522892793]
2022-03-19 15:40:36.508 | INFO     | tools.trainer:train_loop:89 - Epoch: [91/ 120] | Train loss: [0.12318760860297415]
2022-03-19 15:42:52.681 | INFO     | tools.trainer:train_loop:89 - Epoch: [92/ 120] | Train loss: [0.10615535693036185]
2022-03-19 15:45:08.766 | INFO     | tools.trainer:train_loop:89 - Epoch: [93/ 120] | Train loss: [0.11020667850971222]
2022-03-19 15:47:24.731 | INFO     | tools.trainer:train_loop:89 - Epoch: [94/ 120] | Train loss: [0.11903241905901167]
2022-03-19 15:49:40.645 | INFO     | tools.trainer:train_loop:89 - Epoch: [95/ 120] | Train loss: [0.10875059333112505]
2022-03-19 15:51:56.716 | INFO     | tools.trainer:train_loop:89 - Epoch: [96/ 120] | Train loss: [0.11596515013111962]
2022-03-19 15:54:12.961 | INFO     | tools.trainer:train_loop:89 - Epoch: [97/ 120] | Train loss: [0.11211921390559938]
2022-03-19 15:56:29.221 | INFO     | tools.trainer:train_loop:89 - Epoch: [98/ 120] | Train loss: [0.10811742800805303]
2022-03-19 15:58:45.286 | INFO     | tools.trainer:train_loop:89 - Epoch: [99/ 120] | Train loss: [0.10822905451059342]
2022-03-19 16:01:01.374 | INFO     | tools.trainer:train_loop:89 - Epoch: [100/ 120] | Train loss: [0.1098649449646473]
2022-03-19 16:03:17.476 | INFO     | tools.trainer:train_loop:89 - Epoch: [101/ 120] | Train loss: [0.10790853194064565]
2022-03-19 16:05:33.611 | INFO     | tools.trainer:train_loop:89 - Epoch: [102/ 120] | Train loss: [0.10482536910308732]
2022-03-19 16:07:49.622 | INFO     | tools.trainer:train_loop:89 - Epoch: [103/ 120] | Train loss: [0.10903815279404322]
2022-03-19 16:10:05.655 | INFO     | tools.trainer:train_loop:89 - Epoch: [104/ 120] | Train loss: [0.10180584092934926]
2022-03-19 16:12:21.655 | INFO     | tools.trainer:train_loop:89 - Epoch: [105/ 120] | Train loss: [0.10178998642497593]
2022-03-19 16:14:37.696 | INFO     | tools.trainer:train_loop:89 - Epoch: [106/ 120] | Train loss: [0.10091673988435003]
2022-03-19 16:16:53.718 | INFO     | tools.trainer:train_loop:89 - Epoch: [107/ 120] | Train loss: [0.10387030533618397]
2022-03-19 16:19:09.625 | INFO     | tools.trainer:train_loop:89 - Epoch: [108/ 120] | Train loss: [0.10033159818914202]
2022-03-19 16:21:25.636 | INFO     | tools.trainer:train_loop:89 - Epoch: [109/ 120] | Train loss: [0.11138012152579095]
2022-03-19 16:23:41.769 | INFO     | tools.trainer:train_loop:89 - Epoch: [110/ 120] | Train loss: [0.10082787457439635]
2022-03-19 16:25:57.858 | INFO     | tools.trainer:train_loop:89 - Epoch: [111/ 120] | Train loss: [0.10373252853751183]
2022-03-19 16:28:13.947 | INFO     | tools.trainer:train_loop:89 - Epoch: [112/ 120] | Train loss: [0.10307274642917845]
2022-03-19 16:30:29.878 | INFO     | tools.trainer:train_loop:89 - Epoch: [113/ 120] | Train loss: [0.09869715314772394]
2022-03-19 16:32:46.273 | INFO     | tools.trainer:train_loop:89 - Epoch: [114/ 120] | Train loss: [0.10350469938582844]
2022-03-19 16:35:02.290 | INFO     | tools.trainer:train_loop:89 - Epoch: [115/ 120] | Train loss: [0.10092077611221208]
2022-03-19 16:37:18.179 | INFO     | tools.trainer:train_loop:89 - Epoch: [116/ 120] | Train loss: [0.10081932751668823]
2022-03-19 16:39:34.257 | INFO     | tools.trainer:train_loop:89 - Epoch: [117/ 120] | Train loss: [0.09548087939620017]
2022-03-19 16:39:34.457 | INFO     | tools.trainer:train_loop:103 - [Saving Snapshot:]/mnt/data/hungpv/polyps/checkpoint/KCECE/default/MiT-B3-SegFormerHead_117.pth
2022-03-19 16:41:50.607 | INFO     | tools.trainer:train_loop:89 - Epoch: [118/ 120] | Train loss: [0.09889183135496246]
2022-03-19 16:41:50.807 | INFO     | tools.trainer:train_loop:103 - [Saving Snapshot:]/mnt/data/hungpv/polyps/checkpoint/KCECE/default/MiT-B3-SegFormerHead_118.pth
2022-03-19 16:44:06.952 | INFO     | tools.trainer:train_loop:89 - Epoch: [119/ 120] | Train loss: [0.10016521836320559]
2022-03-19 16:44:07.153 | INFO     | tools.trainer:train_loop:103 - [Saving Snapshot:]/mnt/data/hungpv/polyps/checkpoint/KCECE/default/MiT-B3-SegFormerHead_119.pth
2022-03-19 16:46:23.366 | INFO     | tools.trainer:train_loop:89 - Epoch: [120/ 120] | Train loss: [0.10012645191616482]
2022-03-19 16:46:23.566 | INFO     | tools.trainer:train_loop:103 - [Saving Snapshot:]/mnt/data/hungpv/polyps/checkpoint/KCECE/default/MiT-B3-SegFormerHead_120.pth
2022-03-19 16:46:23.566 | INFO     | tools.trainer:train_loop:109 - Training cost: 16318.457196705975seconds
