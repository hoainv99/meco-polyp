2023-06-03 14:03:14.677 | INFO     | __main__:main:57 - Load config from configs/neo_small.yaml
2023-06-03 14:03:14.677 | INFO     | __main__:main:58 - {'dataset': {'data_path': '/root/neo_code_reco/bkai-igh-neopolyp', 'train_data_path': ['/root/neo_code_reco/bkai-igh-neopolyp'], 'test_data_path': ['/root/neo_code/bkai-igh-neopolyp/test/test'], 'val_data_path': ['/root/neo_code_reco/bkai-igh-neopolyp']}, 'model': {'num_classes': 3, 'save_dir': '/root/neo_code_reco/configs/checkpoint_mb_non_local', 'backbone': 'MiT-B3', 'head': 'FaPNHead', 'pretrained': 'mit_b3.pth'}, 'optimizer': {'name': 'adam', 'lr': 0.0001, 'clip': 0.5, 'scheduler': 'cosine_warmup', 'loss': 'multi_structure_loss'}, 'dev': 'cuda', 'train': {'start_from': 0, 'save_from': 99, 'num_epochs': 100, 'num_warmup_epoch': 8, 'is_val': False, 'size_rates': [0.75, 1, 1.25], 'dataloader': {'batchsize': 8, 'img_size': 384, 'shuffle': True, 'num_workers': 4, 'pin_memory': True, 'drop_last': True}, 'amp': False, 'ddp': False, 'augment': {'prob': 1, 'Flip_prob': 0.5, 'HueSaturationValue_prob': 0.5, 'RandomBrightnessContrast_prob': 0.5, 'crop_prob': 0.0, 'randomrotate90_prob': 0.5, 'ColorJitter_prob': 0.5}, 'augment_weak': {'prob': 1, 'Flip_prob': 0.5}}, 'val': {'dataloader': {'batchsize': 8, 'img_size': 384, 'shuffle': True, 'num_workers': 4, 'pin_memory': True, 'drop_last': False}}, 'test': {'dev': 'cuda', 'visualize': True, 'visualize_dir': '/root/neo_code_reco/neo_visualize', 'vis_x': 180, 'vis_overwrite': False, 'checkpoint_dir': '/root/neo_code_reco/configs/checkpoint_mb/MiT-B3-FaPNHead_100.pth', 'dataloader': {'batchsize': 1, 'img_size': 384, 'shuffle': True, 'num_workers': 4, 'pin_memory': True, 'drop_last': False}, 'augment': {'prob': 1, 'Flip_prob': 0, 'HueSaturationValue_prob': 0, 'RandomBrightnessContrast_prob': 0, 'crop_prob': 0, 'randomrotate90_prob': 0, 'elastictransform_prob': 0, 'gridistortion_prob': 0, 'opticaldistortion_prob': 0, 'verticalflip_prob': 0, 'horizontalflip_prob': 0, 'randomgamma_prob': 0, 'CoarseDropout_prob': 0, 'RGBShift_prob': 0, 'MotionBlur_prob': 0, 'MedianBlur_prob': 0, 'GaussianBlur_prob': 0, 'GaussNoise_prob': 0, 'ChannelShuffle_prob': 0}}}
2023-06-03 14:03:14.677 | INFO     | __main__:main:59 - Getting datapath
2023-06-03 14:03:14.685 | INFO     | __main__:main:74 - There are 1000 images to train
2023-06-03 14:03:14.685 | INFO     | __main__:main:93 - Train model with no valid dataset
2023-06-03 14:03:14.685 | INFO     | __main__:main:95 - Loading data
2023-06-03 14:03:15.045 | INFO     | __main__:main:112 - 125 batches to train
2023-06-03 14:03:15.045 | INFO     | __main__:main:125 - Loading model
2023-06-03 14:03:15.045 | INFO     | __main__:main:146 - Loading checkpoint from mit_b3.pth ...
2023-06-03 14:03:20.423 | INFO     | __main__:main:190 - Training with FP32 ...
2023-06-03 14:08:38.678 | INFO     | trainer:train_loop:183 - Epoch: [1/ 100] | Train loss: [1.6411429166793823]
2023-06-03 14:13:57.417 | INFO     | trainer:train_loop:183 - Epoch: [2/ 100] | Train loss: [0.7609103951454163]
2023-06-03 14:19:15.065 | INFO     | trainer:train_loop:183 - Epoch: [3/ 100] | Train loss: [0.661337203502655]
2023-06-03 14:24:32.891 | INFO     | trainer:train_loop:183 - Epoch: [4/ 100] | Train loss: [0.5817298800945282]
2023-06-03 14:29:52.170 | INFO     | trainer:train_loop:183 - Epoch: [5/ 100] | Train loss: [0.4048614690899849]
2023-06-03 14:35:08.920 | INFO     | trainer:train_loop:183 - Epoch: [6/ 100] | Train loss: [0.37379301726818087]
2023-06-03 14:40:25.647 | INFO     | trainer:train_loop:183 - Epoch: [7/ 100] | Train loss: [0.32944746178388595]
2023-06-03 14:45:42.277 | INFO     | trainer:train_loop:183 - Epoch: [8/ 100] | Train loss: [0.30622521102428435]
2023-06-03 14:51:02.370 | INFO     | trainer:train_loop:183 - Epoch: [9/ 100] | Train loss: [0.2845378821492195]
2023-06-03 14:56:23.598 | INFO     | trainer:train_loop:183 - Epoch: [10/ 100] | Train loss: [0.2677256563305855]
2023-06-03 15:01:41.506 | INFO     | trainer:train_loop:183 - Epoch: [11/ 100] | Train loss: [0.25248913207650187]
2023-06-03 15:07:00.489 | INFO     | trainer:train_loop:183 - Epoch: [12/ 100] | Train loss: [0.2815728518664837]
2023-06-03 15:12:20.052 | INFO     | trainer:train_loop:183 - Epoch: [13/ 100] | Train loss: [0.2573667097091675]
2023-06-03 15:17:40.129 | INFO     | trainer:train_loop:183 - Epoch: [14/ 100] | Train loss: [0.233358798712492]
2023-06-03 15:23:01.656 | INFO     | trainer:train_loop:183 - Epoch: [15/ 100] | Train loss: [0.23836424991488456]
2023-06-03 15:28:21.736 | INFO     | trainer:train_loop:183 - Epoch: [16/ 100] | Train loss: [0.23282109114527702]
2023-06-03 15:33:42.589 | INFO     | trainer:train_loop:183 - Epoch: [17/ 100] | Train loss: [0.20666304856538772]
2023-06-03 15:39:03.207 | INFO     | trainer:train_loop:183 - Epoch: [18/ 100] | Train loss: [0.2099847598671913]
2023-06-03 15:44:25.305 | INFO     | trainer:train_loop:183 - Epoch: [19/ 100] | Train loss: [0.1991954752802849]
2023-06-03 15:49:43.365 | INFO     | trainer:train_loop:183 - Epoch: [20/ 100] | Train loss: [0.2049324830174446]
2023-06-03 15:55:03.085 | INFO     | trainer:train_loop:183 - Epoch: [21/ 100] | Train loss: [0.19883740243315698]
2023-06-03 16:00:23.556 | INFO     | trainer:train_loop:183 - Epoch: [22/ 100] | Train loss: [0.18227306309342384]
2023-06-03 16:05:43.436 | INFO     | trainer:train_loop:183 - Epoch: [23/ 100] | Train loss: [0.1784098523259163]
2023-06-03 16:11:02.787 | INFO     | trainer:train_loop:183 - Epoch: [24/ 100] | Train loss: [0.19668552473187448]
2023-06-03 16:16:22.673 | INFO     | trainer:train_loop:183 - Epoch: [25/ 100] | Train loss: [0.17294700759649276]
2023-06-03 16:21:42.533 | INFO     | trainer:train_loop:183 - Epoch: [26/ 100] | Train loss: [0.1748872540295124]
2023-06-03 16:27:04.066 | INFO     | trainer:train_loop:183 - Epoch: [27/ 100] | Train loss: [0.179182471036911]
2023-06-03 16:32:23.373 | INFO     | trainer:train_loop:183 - Epoch: [28/ 100] | Train loss: [0.16528983673453332]
2023-06-03 16:37:42.712 | INFO     | trainer:train_loop:183 - Epoch: [29/ 100] | Train loss: [0.16490992924571038]
2023-06-03 16:43:02.995 | INFO     | trainer:train_loop:183 - Epoch: [30/ 100] | Train loss: [0.16579703482985497]
2023-06-03 16:48:26.390 | INFO     | trainer:train_loop:183 - Epoch: [31/ 100] | Train loss: [0.1830654782652855]
2023-06-03 16:53:46.392 | INFO     | trainer:train_loop:183 - Epoch: [32/ 100] | Train loss: [0.14878773692250252]
2023-06-03 16:59:06.097 | INFO     | trainer:train_loop:183 - Epoch: [33/ 100] | Train loss: [0.16413178446888924]
2023-06-03 17:04:24.294 | INFO     | trainer:train_loop:183 - Epoch: [34/ 100] | Train loss: [0.17517296314239503]
2023-06-03 17:09:47.155 | INFO     | trainer:train_loop:183 - Epoch: [35/ 100] | Train loss: [0.1909144302904606]
2023-06-03 17:15:08.308 | INFO     | trainer:train_loop:183 - Epoch: [36/ 100] | Train loss: [0.17895045208930968]
2023-06-03 17:20:31.109 | INFO     | trainer:train_loop:183 - Epoch: [37/ 100] | Train loss: [0.20686366704106332]
2023-06-03 17:25:55.000 | INFO     | trainer:train_loop:183 - Epoch: [38/ 100] | Train loss: [0.1512271371483803]
2023-06-03 17:31:16.497 | INFO     | trainer:train_loop:183 - Epoch: [39/ 100] | Train loss: [0.15335308896005154]
2023-06-03 17:36:38.038 | INFO     | trainer:train_loop:183 - Epoch: [40/ 100] | Train loss: [0.18619449093937873]
2023-06-03 17:42:01.015 | INFO     | trainer:train_loop:183 - Epoch: [41/ 100] | Train loss: [0.146533017963171]
2023-06-03 17:47:20.473 | INFO     | trainer:train_loop:183 - Epoch: [42/ 100] | Train loss: [0.14966623210906982]
2023-06-03 17:52:41.709 | INFO     | trainer:train_loop:183 - Epoch: [43/ 100] | Train loss: [0.139760605096817]
2023-06-03 17:58:03.926 | INFO     | trainer:train_loop:183 - Epoch: [44/ 100] | Train loss: [0.18258400267362596]
2023-06-03 18:03:24.366 | INFO     | trainer:train_loop:183 - Epoch: [45/ 100] | Train loss: [0.18096338534355164]
2023-06-03 18:08:42.632 | INFO     | trainer:train_loop:183 - Epoch: [46/ 100] | Train loss: [0.13723156455159188]
2023-06-03 18:14:03.712 | INFO     | trainer:train_loop:183 - Epoch: [47/ 100] | Train loss: [0.13276268205046654]
2023-06-03 18:19:22.202 | INFO     | trainer:train_loop:183 - Epoch: [48/ 100] | Train loss: [0.10768098616600037]
2023-06-03 18:24:44.172 | INFO     | trainer:train_loop:183 - Epoch: [49/ 100] | Train loss: [0.12591191160678863]
2023-06-03 18:30:04.714 | INFO     | trainer:train_loop:183 - Epoch: [50/ 100] | Train loss: [0.12761165669560431]
2023-06-03 18:35:24.407 | INFO     | trainer:train_loop:183 - Epoch: [51/ 100] | Train loss: [0.10910171820223331]
2023-06-03 18:40:45.386 | INFO     | trainer:train_loop:183 - Epoch: [52/ 100] | Train loss: [0.12306119173765183]
2023-06-03 18:46:05.356 | INFO     | trainer:train_loop:183 - Epoch: [53/ 100] | Train loss: [0.10572720688581466]
2023-06-03 18:51:25.949 | INFO     | trainer:train_loop:183 - Epoch: [54/ 100] | Train loss: [0.11070373968780041]
2023-06-03 18:56:46.872 | INFO     | trainer:train_loop:183 - Epoch: [55/ 100] | Train loss: [0.1290690771192312]
2023-06-03 19:02:08.062 | INFO     | trainer:train_loop:183 - Epoch: [56/ 100] | Train loss: [0.10973230530321598]
2023-06-03 19:07:28.101 | INFO     | trainer:train_loop:183 - Epoch: [57/ 100] | Train loss: [0.13065398512780665]
2023-06-03 19:12:49.733 | INFO     | trainer:train_loop:183 - Epoch: [58/ 100] | Train loss: [0.11934419232606888]
2023-06-03 19:18:09.537 | INFO     | trainer:train_loop:183 - Epoch: [59/ 100] | Train loss: [0.11280469943583012]
2023-06-03 19:23:30.683 | INFO     | trainer:train_loop:183 - Epoch: [60/ 100] | Train loss: [0.11329232996702195]
2023-06-03 19:28:49.992 | INFO     | trainer:train_loop:183 - Epoch: [61/ 100] | Train loss: [0.10596455678343773]
2023-06-03 19:34:11.368 | INFO     | trainer:train_loop:183 - Epoch: [62/ 100] | Train loss: [0.08966279792785645]
2023-06-03 19:39:32.972 | INFO     | trainer:train_loop:183 - Epoch: [63/ 100] | Train loss: [0.10959751862287521]
2023-06-03 19:44:52.401 | INFO     | trainer:train_loop:183 - Epoch: [64/ 100] | Train loss: [0.09770082399249076]
2023-06-03 19:50:15.111 | INFO     | trainer:train_loop:183 - Epoch: [65/ 100] | Train loss: [0.08600071233510971]
2023-06-03 19:55:37.466 | INFO     | trainer:train_loop:183 - Epoch: [66/ 100] | Train loss: [0.09411481574177742]
2023-06-03 20:00:58.678 | INFO     | trainer:train_loop:183 - Epoch: [67/ 100] | Train loss: [0.08820849187672138]
2023-06-03 20:06:22.449 | INFO     | trainer:train_loop:183 - Epoch: [68/ 100] | Train loss: [0.07928331029415131]
2023-06-03 20:11:43.140 | INFO     | trainer:train_loop:183 - Epoch: [69/ 100] | Train loss: [0.08322471497952938]
2023-06-03 20:17:06.346 | INFO     | trainer:train_loop:183 - Epoch: [70/ 100] | Train loss: [0.09008078828454018]
2023-06-03 20:22:26.895 | INFO     | trainer:train_loop:183 - Epoch: [71/ 100] | Train loss: [0.07672494994103908]
2023-06-03 20:27:52.476 | INFO     | trainer:train_loop:183 - Epoch: [72/ 100] | Train loss: [0.07643629232048989]
2023-06-03 20:33:13.391 | INFO     | trainer:train_loop:183 - Epoch: [73/ 100] | Train loss: [0.07542382504045964]
2023-06-03 20:38:34.922 | INFO     | trainer:train_loop:183 - Epoch: [74/ 100] | Train loss: [0.06913908341526985]
2023-06-03 20:43:55.824 | INFO     | trainer:train_loop:183 - Epoch: [75/ 100] | Train loss: [0.06382875460386277]
2023-06-03 20:49:18.114 | INFO     | trainer:train_loop:183 - Epoch: [76/ 100] | Train loss: [0.06778707312047481]
2023-06-03 20:54:40.511 | INFO     | trainer:train_loop:183 - Epoch: [77/ 100] | Train loss: [0.07376495087146759]
2023-06-03 21:00:02.802 | INFO     | trainer:train_loop:183 - Epoch: [78/ 100] | Train loss: [0.06560903093218803]
2023-06-03 21:05:24.033 | INFO     | trainer:train_loop:183 - Epoch: [79/ 100] | Train loss: [0.06048074176907539]
2023-06-03 21:10:45.125 | INFO     | trainer:train_loop:183 - Epoch: [80/ 100] | Train loss: [0.06702689243853092]
2023-06-03 21:16:07.383 | INFO     | trainer:train_loop:183 - Epoch: [81/ 100] | Train loss: [0.06734177221357822]
2023-06-03 21:21:30.367 | INFO     | trainer:train_loop:183 - Epoch: [82/ 100] | Train loss: [0.0604381843060255]
2023-06-03 21:26:53.240 | INFO     | trainer:train_loop:183 - Epoch: [83/ 100] | Train loss: [0.0557058265209198]
2023-06-03 21:32:17.040 | INFO     | trainer:train_loop:183 - Epoch: [84/ 100] | Train loss: [0.060226291328668594]
2023-06-03 21:37:39.460 | INFO     | trainer:train_loop:183 - Epoch: [85/ 100] | Train loss: [0.06018697512149811]
2023-06-03 21:43:01.474 | INFO     | trainer:train_loop:183 - Epoch: [86/ 100] | Train loss: [0.06068869653344154]
2023-06-03 21:48:24.101 | INFO     | trainer:train_loop:183 - Epoch: [87/ 100] | Train loss: [0.06002003730833531]
2023-06-03 21:53:46.399 | INFO     | trainer:train_loop:183 - Epoch: [88/ 100] | Train loss: [0.0586756931245327]
2023-06-03 21:59:11.422 | INFO     | trainer:train_loop:183 - Epoch: [89/ 100] | Train loss: [0.05543455216288567]
2023-06-03 22:04:31.452 | INFO     | trainer:train_loop:183 - Epoch: [90/ 100] | Train loss: [0.05863805197179318]
2023-06-03 22:09:53.469 | INFO     | trainer:train_loop:183 - Epoch: [91/ 100] | Train loss: [0.05478619158267975]
2023-06-03 22:15:13.002 | INFO     | trainer:train_loop:183 - Epoch: [92/ 100] | Train loss: [0.05685685071349144]
2023-06-03 22:20:35.204 | INFO     | trainer:train_loop:183 - Epoch: [93/ 100] | Train loss: [0.050383292198181155]
2023-06-03 22:25:58.809 | INFO     | trainer:train_loop:183 - Epoch: [94/ 100] | Train loss: [0.05515779702365398]
2023-06-03 22:31:19.478 | INFO     | trainer:train_loop:183 - Epoch: [95/ 100] | Train loss: [0.05395395323634147]
2023-06-03 22:36:41.266 | INFO     | trainer:train_loop:183 - Epoch: [96/ 100] | Train loss: [0.054386015221476555]
2023-06-03 22:42:05.768 | INFO     | trainer:train_loop:183 - Epoch: [97/ 100] | Train loss: [0.05542132145166397]
2023-06-03 22:47:29.897 | INFO     | trainer:train_loop:183 - Epoch: [98/ 100] | Train loss: [0.05062353745102882]
2023-06-03 22:52:51.740 | INFO     | trainer:train_loop:183 - Epoch: [99/ 100] | Train loss: [0.05202108065783977]
2023-06-03 22:58:14.830 | INFO     | trainer:train_loop:183 - Epoch: [100/ 100] | Train loss: [0.04784458130598068]
2023-06-03 22:58:15.194 | INFO     | trainer:train_loop:195 - [Saving Snapshot:]/root/neo_code_reco/configs/checkpoint_mb_non_local/MiT-B3-FaPNHead_100.pth
2023-06-03 22:58:15.195 | INFO     | trainer:train_loop:204 - Training cost: 32093.300754263997seconds
