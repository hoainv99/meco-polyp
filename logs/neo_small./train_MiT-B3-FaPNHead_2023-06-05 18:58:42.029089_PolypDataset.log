2023-06-05 18:58:42.033 | INFO     | __main__:main:57 - Load config from configs/neo_small.yaml
2023-06-05 18:58:42.034 | INFO     | __main__:main:58 - {'dataset': {'data_path': '/root/neo_code_reco_mb/bkai-igh-neopolyp', 'train_data_path': ['/root/neo_code_reco_mb/bkai-igh-neopolyp'], 'test_data_path': ['/root/neo_code_reco_mb/bkai-igh-neopolyp/test/test'], 'val_data_path': ['/root/neo_code_reco_mb/bkai-igh-neopolyp']}, 'model': {'num_classes': 3, 'save_dir': '/root/neo_code_reco_mb/configs/checkpoint_0406', 'backbone': 'MiT-B3', 'head': 'FaPNHead', 'pretrained': 'mit_b3.pth'}, 'optimizer': {'name': 'adam', 'lr': 0.0001, 'clip': 0.5, 'scheduler': 'cosine_warmup', 'loss': 'multi_structure_loss'}, 'dev': 'cuda', 'train': {'start_from': 0, 'save_from': 99, 'num_epochs': 100, 'num_warmup_epoch': 8, 'is_val': False, 'size_rates': [0.75, 1, 1.25], 'dataloader': {'batchsize': 8, 'img_size': 384, 'shuffle': True, 'num_workers': 4, 'pin_memory': True, 'drop_last': True}, 'amp': False, 'ddp': False, 'augment': {'prob': 1, 'Flip_prob': 0.5, 'HueSaturationValue_prob': 0.5, 'RandomBrightnessContrast_prob': 0.5, 'crop_prob': 0.0, 'randomrotate90_prob': 0.5, 'ColorJitter_prob': 0.5}, 'augment_weak': {'prob': 1, 'Flip_prob': 0.5}}, 'val': {'dataloader': {'batchsize': 8, 'img_size': 384, 'shuffle': True, 'num_workers': 4, 'pin_memory': True, 'drop_last': False}}, 'test': {'dev': 'cuda', 'visualize': True, 'visualize_dir': '/root/neo_code_reco_mb/neo_visualize', 'vis_x': 180, 'vis_overwrite': False, 'checkpoint_dir': '/root/neo_code_reco_mb/configs/checkpoint_0406/MiT-B3-FaPNHead_100_teacher.pth', 'dataloader': {'batchsize': 1, 'img_size': 384, 'shuffle': True, 'num_workers': 4, 'pin_memory': True, 'drop_last': False}, 'augment': {'prob': 1, 'Flip_prob': 0, 'HueSaturationValue_prob': 0, 'RandomBrightnessContrast_prob': 0, 'crop_prob': 0, 'randomrotate90_prob': 0, 'elastictransform_prob': 0, 'gridistortion_prob': 0, 'opticaldistortion_prob': 0, 'verticalflip_prob': 0, 'horizontalflip_prob': 0, 'randomgamma_prob': 0, 'CoarseDropout_prob': 0, 'RGBShift_prob': 0, 'MotionBlur_prob': 0, 'MedianBlur_prob': 0, 'GaussianBlur_prob': 0, 'GaussNoise_prob': 0, 'ChannelShuffle_prob': 0}}}
2023-06-05 18:58:42.034 | INFO     | __main__:main:59 - Getting datapath
2023-06-05 18:58:42.042 | INFO     | __main__:main:74 - There are 1000 images to train
2023-06-05 18:58:42.042 | INFO     | __main__:main:93 - Train model with no valid dataset
2023-06-05 18:58:42.042 | INFO     | __main__:main:95 - Loading data
2023-06-05 18:58:42.432 | INFO     | __main__:main:112 - 125 batches to train
2023-06-05 18:58:42.432 | INFO     | __main__:main:125 - Loading model
2023-06-05 18:58:42.433 | INFO     | __main__:main:146 - Loading checkpoint from mit_b3.pth ...
2023-06-05 18:58:48.033 | INFO     | __main__:main:190 - Training with FP32 ...
2023-06-05 19:04:07.291 | INFO     | trainer:train_loop:182 - Epoch: [1/ 100] | Train loss: [1.6863923540115358]
2023-06-05 19:09:26.203 | INFO     | trainer:train_loop:182 - Epoch: [2/ 100] | Train loss: [0.6889531779289245]
2023-06-05 19:14:45.435 | INFO     | trainer:train_loop:182 - Epoch: [3/ 100] | Train loss: [0.5942401123046875]
2023-06-05 19:20:07.845 | INFO     | trainer:train_loop:182 - Epoch: [4/ 100] | Train loss: [0.45747519636154177]
2023-06-05 19:25:26.975 | INFO     | trainer:train_loop:182 - Epoch: [5/ 100] | Train loss: [0.35601667189598085]
2023-06-05 19:30:49.865 | INFO     | trainer:train_loop:182 - Epoch: [6/ 100] | Train loss: [0.3586326683759689]
2023-06-05 19:36:11.594 | INFO     | trainer:train_loop:182 - Epoch: [7/ 100] | Train loss: [0.3056221665740013]
2023-06-05 19:41:34.405 | INFO     | trainer:train_loop:182 - Epoch: [8/ 100] | Train loss: [0.5680389150381088]
2023-06-05 19:46:56.818 | INFO     | trainer:train_loop:182 - Epoch: [9/ 100] | Train loss: [0.47125677359104157]
2023-06-05 19:52:15.916 | INFO     | trainer:train_loop:182 - Epoch: [10/ 100] | Train loss: [0.4053427506685257]
2023-06-05 19:57:38.360 | INFO     | trainer:train_loop:182 - Epoch: [11/ 100] | Train loss: [0.35770282155275346]
2023-06-05 20:03:01.014 | INFO     | trainer:train_loop:182 - Epoch: [12/ 100] | Train loss: [0.3005395959913731]
2023-06-05 20:08:23.372 | INFO     | trainer:train_loop:182 - Epoch: [13/ 100] | Train loss: [0.26442118936777115]
2023-06-05 20:13:44.767 | INFO     | trainer:train_loop:182 - Epoch: [14/ 100] | Train loss: [0.2499533536732197]
2023-06-05 20:19:06.104 | INFO     | trainer:train_loop:182 - Epoch: [15/ 100] | Train loss: [0.232900370657444]
2023-06-05 20:24:29.498 | INFO     | trainer:train_loop:182 - Epoch: [16/ 100] | Train loss: [0.22026309356093407]
2023-06-05 20:29:52.110 | INFO     | trainer:train_loop:182 - Epoch: [17/ 100] | Train loss: [0.22162731426954269]
2023-06-05 20:35:15.060 | INFO     | trainer:train_loop:182 - Epoch: [18/ 100] | Train loss: [0.21272752809524537]
2023-06-05 20:40:36.309 | INFO     | trainer:train_loop:182 - Epoch: [19/ 100] | Train loss: [0.23445451331138611]
2023-06-05 20:45:59.439 | INFO     | trainer:train_loop:182 - Epoch: [20/ 100] | Train loss: [0.2174109459221363]
2023-06-05 20:51:23.790 | INFO     | trainer:train_loop:182 - Epoch: [21/ 100] | Train loss: [0.19345705357193946]
2023-06-05 20:56:47.244 | INFO     | trainer:train_loop:182 - Epoch: [22/ 100] | Train loss: [0.18358544927835466]
2023-06-05 21:02:09.176 | INFO     | trainer:train_loop:182 - Epoch: [23/ 100] | Train loss: [0.19506176936626435]
2023-06-05 21:07:31.934 | INFO     | trainer:train_loop:182 - Epoch: [24/ 100] | Train loss: [0.18702090445160865]
2023-06-05 21:12:56.116 | INFO     | trainer:train_loop:182 - Epoch: [25/ 100] | Train loss: [0.18381137976050377]
2023-06-05 21:18:19.611 | INFO     | trainer:train_loop:182 - Epoch: [26/ 100] | Train loss: [0.18784814512729645]
2023-06-05 21:23:44.141 | INFO     | trainer:train_loop:182 - Epoch: [27/ 100] | Train loss: [0.20605611339211463]
2023-06-05 21:29:09.016 | INFO     | trainer:train_loop:182 - Epoch: [28/ 100] | Train loss: [0.1979248008430004]
2023-06-05 21:34:31.489 | INFO     | trainer:train_loop:182 - Epoch: [29/ 100] | Train loss: [0.2042783509641886]
2023-06-05 21:39:53.802 | INFO     | trainer:train_loop:182 - Epoch: [30/ 100] | Train loss: [0.17123152151703835]
2023-06-05 21:45:16.359 | INFO     | trainer:train_loop:182 - Epoch: [31/ 100] | Train loss: [0.16213649520277976]
2023-06-05 21:50:39.895 | INFO     | trainer:train_loop:182 - Epoch: [32/ 100] | Train loss: [0.18291191059350967]
2023-06-05 21:56:03.389 | INFO     | trainer:train_loop:182 - Epoch: [33/ 100] | Train loss: [0.1558891575038433]
2023-06-05 22:01:27.934 | INFO     | trainer:train_loop:182 - Epoch: [34/ 100] | Train loss: [0.14765974527597428]
2023-06-05 22:06:51.576 | INFO     | trainer:train_loop:182 - Epoch: [35/ 100] | Train loss: [0.16885303390026093]
2023-06-05 22:12:14.451 | INFO     | trainer:train_loop:182 - Epoch: [36/ 100] | Train loss: [0.20602237969636916]
2023-06-05 22:17:36.148 | INFO     | trainer:train_loop:182 - Epoch: [37/ 100] | Train loss: [0.16675990241765976]
2023-06-05 22:22:59.812 | INFO     | trainer:train_loop:182 - Epoch: [38/ 100] | Train loss: [0.15774916949868203]
2023-06-05 22:28:22.278 | INFO     | trainer:train_loop:182 - Epoch: [39/ 100] | Train loss: [0.15646132189035417]
2023-06-05 22:33:44.069 | INFO     | trainer:train_loop:182 - Epoch: [40/ 100] | Train loss: [0.1447652868628502]
2023-06-05 22:39:07.088 | INFO     | trainer:train_loop:182 - Epoch: [41/ 100] | Train loss: [0.16617438885569571]
2023-06-05 22:44:31.607 | INFO     | trainer:train_loop:182 - Epoch: [42/ 100] | Train loss: [0.16143205851316453]
2023-06-05 22:49:55.543 | INFO     | trainer:train_loop:182 - Epoch: [43/ 100] | Train loss: [0.1760513170361519]
2023-06-05 22:55:19.692 | INFO     | trainer:train_loop:182 - Epoch: [44/ 100] | Train loss: [0.16727568130195142]
2023-06-05 23:00:41.557 | INFO     | trainer:train_loop:182 - Epoch: [45/ 100] | Train loss: [0.1626023600101471]
2023-06-05 23:06:03.474 | INFO     | trainer:train_loop:182 - Epoch: [46/ 100] | Train loss: [0.14240371821820735]
2023-06-05 23:11:26.907 | INFO     | trainer:train_loop:182 - Epoch: [47/ 100] | Train loss: [0.13257859155535698]
2023-06-05 23:16:49.007 | INFO     | trainer:train_loop:182 - Epoch: [48/ 100] | Train loss: [0.15744260719418526]
2023-06-05 23:22:13.002 | INFO     | trainer:train_loop:182 - Epoch: [49/ 100] | Train loss: [0.14981556463241577]
