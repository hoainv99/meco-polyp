2023-06-04 17:54:39.384 | INFO     | __main__:main:57 - Load config from configs/neo_small_test.yaml
2023-06-04 17:54:39.384 | INFO     | __main__:main:58 - {'dataset': {'data_path': '/root/neo_code_reco/bkai-igh-neopolyp', 'train_data_path': ['/root/neo_code_reco/bkai-igh-neopolyp'], 'test_data_path': ['/root/neo_code/bkai-igh-neopolyp/test/test'], 'val_data_path': ['/root/neo_code_reco/bkai-igh-neopolyp']}, 'model': {'num_classes': 3, 'save_dir': '/root/neo_code_reco/configs/0406', 'backbone': 'MiT-B3', 'head': 'FaPNHead', 'pretrained': 'mit_b3.pth'}, 'optimizer': {'name': 'adam', 'lr': 0.0001, 'clip': 0.5, 'scheduler': 'cosine_warmup', 'loss': 'multi_structure_loss'}, 'dev': 'cuda', 'train': {'start_from': 0, 'save_from': 99, 'num_epochs': 100, 'num_warmup_epoch': 8, 'is_val': False, 'size_rates': [0.75, 1, 1.25], 'dataloader': {'batchsize': 8, 'img_size': 384, 'shuffle': True, 'num_workers': 8, 'pin_memory': True, 'drop_last': True}, 'amp': False, 'ddp': False, 'augment': {'prob': 0.5, 'Flip_prob': 0.5, 'HueSaturationValue_prob': 0.5, 'RandomBrightnessContrast_prob': 0.5, 'crop_prob': 0.0, 'randomrotate90_prob': 0.5, 'ColorJitter_prob': 0.5}, 'augment_weak': {'prob': 1, 'Flip_prob': 0.5}}, 'val': {'dataloader': {'batchsize': 8, 'img_size': 384, 'shuffle': True, 'num_workers': 4, 'pin_memory': True, 'drop_last': False}}, 'test': {'dev': 'cuda', 'visualize': True, 'visualize_dir': '/root/neo_code_reco/neo_visualize', 'vis_x': 180, 'vis_overwrite': False, 'checkpoint_dir': '/root/neo_code_reco/configs/checkpoint_mb_with_local/MiT-B3-FaPNHead_100.pth', 'dataloader': {'batchsize': 1, 'img_size': 384, 'shuffle': True, 'num_workers': 4, 'pin_memory': True, 'drop_last': False}, 'augment': {'prob': 1, 'Flip_prob': 0, 'HueSaturationValue_prob': 0, 'RandomBrightnessContrast_prob': 0, 'crop_prob': 0, 'randomrotate90_prob': 0, 'elastictransform_prob': 0, 'gridistortion_prob': 0, 'opticaldistortion_prob': 0, 'verticalflip_prob': 0, 'horizontalflip_prob': 0, 'randomgamma_prob': 0, 'CoarseDropout_prob': 0, 'RGBShift_prob': 0, 'MotionBlur_prob': 0, 'MedianBlur_prob': 0, 'GaussianBlur_prob': 0, 'GaussNoise_prob': 0, 'ChannelShuffle_prob': 0}}}
2023-06-04 17:54:39.384 | INFO     | __main__:main:59 - Getting datapath
2023-06-04 17:54:39.392 | INFO     | __main__:main:74 - There are 1000 images to train
2023-06-04 17:54:39.393 | INFO     | __main__:main:93 - Train model with no valid dataset
2023-06-04 17:54:39.393 | INFO     | __main__:main:95 - Loading data
2023-06-04 17:54:39.778 | INFO     | __main__:main:112 - 125 batches to train
2023-06-04 17:54:39.779 | INFO     | __main__:main:125 - Loading model
2023-06-04 17:54:39.779 | INFO     | __main__:main:146 - Loading checkpoint from mit_b3.pth ...
2023-06-04 17:54:45.501 | INFO     | __main__:main:190 - Training with FP32 ...
2023-06-04 18:00:10.645 | INFO     | trainer:train_loop:183 - Epoch: [1/ 100] | Train loss: [1.6651091618537903]
2023-06-04 18:05:37.659 | INFO     | trainer:train_loop:183 - Epoch: [2/ 100] | Train loss: [0.7343397159576416]
2023-06-04 18:11:06.082 | INFO     | trainer:train_loop:183 - Epoch: [3/ 100] | Train loss: [0.6545294017791748]
2023-06-04 18:16:32.366 | INFO     | trainer:train_loop:183 - Epoch: [4/ 100] | Train loss: [0.5597364571094513]
2023-06-04 18:21:56.963 | INFO     | trainer:train_loop:183 - Epoch: [5/ 100] | Train loss: [0.3958007237911224]
2023-06-04 18:27:21.103 | INFO     | trainer:train_loop:183 - Epoch: [6/ 100] | Train loss: [0.33750628542900085]
2023-06-04 18:32:47.671 | INFO     | trainer:train_loop:183 - Epoch: [7/ 100] | Train loss: [0.33630185878276825]
2023-06-04 18:38:14.044 | INFO     | trainer:train_loop:183 - Epoch: [8/ 100] | Train loss: [0.29004786247015]
2023-06-04 18:43:42.047 | INFO     | trainer:train_loop:183 - Epoch: [9/ 100] | Train loss: [0.24777380332350732]
2023-06-04 18:49:07.568 | INFO     | trainer:train_loop:183 - Epoch: [10/ 100] | Train loss: [0.2580015290379524]
2023-06-04 18:54:34.078 | INFO     | trainer:train_loop:183 - Epoch: [11/ 100] | Train loss: [0.21947515028715134]
2023-06-04 19:00:00.630 | INFO     | trainer:train_loop:183 - Epoch: [12/ 100] | Train loss: [0.22858797934651376]
2023-06-04 19:05:26.844 | INFO     | trainer:train_loop:183 - Epoch: [13/ 100] | Train loss: [0.21087770467996597]
2023-06-04 19:10:52.516 | INFO     | trainer:train_loop:183 - Epoch: [14/ 100] | Train loss: [0.1999596425294876]
2023-06-04 19:16:17.461 | INFO     | trainer:train_loop:183 - Epoch: [15/ 100] | Train loss: [0.20833862602710723]
2023-06-04 19:21:40.449 | INFO     | trainer:train_loop:183 - Epoch: [16/ 100] | Train loss: [0.20399013990163803]
2023-06-04 19:27:06.084 | INFO     | trainer:train_loop:183 - Epoch: [17/ 100] | Train loss: [0.22174980667233468]
2023-06-04 19:32:31.916 | INFO     | trainer:train_loop:183 - Epoch: [18/ 100] | Train loss: [0.2677886049449444]
2023-06-04 19:37:58.804 | INFO     | trainer:train_loop:183 - Epoch: [19/ 100] | Train loss: [0.1853074253499508]
2023-06-04 19:43:23.093 | INFO     | trainer:train_loop:183 - Epoch: [20/ 100] | Train loss: [0.20972827285528184]
2023-06-04 19:48:48.540 | INFO     | trainer:train_loop:183 - Epoch: [21/ 100] | Train loss: [0.1873535130918026]
2023-06-04 19:54:13.572 | INFO     | trainer:train_loop:183 - Epoch: [22/ 100] | Train loss: [0.17872112503647805]
2023-06-04 19:59:40.121 | INFO     | trainer:train_loop:183 - Epoch: [23/ 100] | Train loss: [0.17308532100915908]
2023-06-04 20:05:09.136 | INFO     | trainer:train_loop:183 - Epoch: [24/ 100] | Train loss: [0.1815834472477436]
2023-06-04 20:10:37.162 | INFO     | trainer:train_loop:183 - Epoch: [25/ 100] | Train loss: [0.15700682571530342]
2023-06-04 20:16:07.490 | INFO     | trainer:train_loop:183 - Epoch: [26/ 100] | Train loss: [0.1331547347009182]
2023-06-04 20:21:35.861 | INFO     | trainer:train_loop:183 - Epoch: [27/ 100] | Train loss: [0.12823697423934938]
2023-06-04 20:27:06.422 | INFO     | trainer:train_loop:183 - Epoch: [28/ 100] | Train loss: [0.13550401473045348]
2023-06-04 20:32:34.295 | INFO     | trainer:train_loop:183 - Epoch: [29/ 100] | Train loss: [0.14468812599778175]
2023-06-04 20:38:04.856 | INFO     | trainer:train_loop:183 - Epoch: [30/ 100] | Train loss: [0.12697187502682208]
2023-06-04 20:43:34.047 | INFO     | trainer:train_loop:183 - Epoch: [31/ 100] | Train loss: [0.1437340567111969]
2023-06-04 20:49:01.398 | INFO     | trainer:train_loop:183 - Epoch: [32/ 100] | Train loss: [0.15134437425434588]
2023-06-04 20:54:31.920 | INFO     | trainer:train_loop:183 - Epoch: [33/ 100] | Train loss: [0.15282572615146636]
2023-06-04 21:00:03.965 | INFO     | trainer:train_loop:183 - Epoch: [34/ 100] | Train loss: [0.1352611203491688]
2023-06-04 21:05:30.197 | INFO     | trainer:train_loop:183 - Epoch: [35/ 100] | Train loss: [0.12938406476378442]
2023-06-04 21:10:58.228 | INFO     | trainer:train_loop:183 - Epoch: [36/ 100] | Train loss: [0.17845195788145066]
2023-06-04 21:16:25.639 | INFO     | trainer:train_loop:183 - Epoch: [37/ 100] | Train loss: [0.15550074088573457]
2023-06-04 21:21:54.342 | INFO     | trainer:train_loop:183 - Epoch: [38/ 100] | Train loss: [0.11099348109960556]
2023-06-04 21:27:24.489 | INFO     | trainer:train_loop:183 - Epoch: [39/ 100] | Train loss: [0.11471994176506996]
2023-06-04 21:32:54.941 | INFO     | trainer:train_loop:183 - Epoch: [40/ 100] | Train loss: [0.124843347042799]
2023-06-04 21:38:25.980 | INFO     | trainer:train_loop:183 - Epoch: [41/ 100] | Train loss: [0.11157574677467347]
2023-06-04 21:43:53.900 | INFO     | trainer:train_loop:183 - Epoch: [42/ 100] | Train loss: [0.10972800371050835]
2023-06-04 21:49:24.372 | INFO     | trainer:train_loop:183 - Epoch: [43/ 100] | Train loss: [0.11990864640474319]
2023-06-04 21:54:55.894 | INFO     | trainer:train_loop:183 - Epoch: [44/ 100] | Train loss: [0.14723819150030612]
2023-06-04 22:00:24.343 | INFO     | trainer:train_loop:183 - Epoch: [45/ 100] | Train loss: [0.1441473192870617]
2023-06-04 22:05:52.966 | INFO     | trainer:train_loop:183 - Epoch: [46/ 100] | Train loss: [0.09641115906834602]
2023-06-04 22:11:22.186 | INFO     | trainer:train_loop:183 - Epoch: [47/ 100] | Train loss: [0.10464320236444473]
2023-06-04 22:16:50.389 | INFO     | trainer:train_loop:183 - Epoch: [48/ 100] | Train loss: [0.10627988700568676]
2023-06-04 22:22:18.488 | INFO     | trainer:train_loop:183 - Epoch: [49/ 100] | Train loss: [0.08767514929175377]
2023-06-04 22:27:48.720 | INFO     | trainer:train_loop:183 - Epoch: [50/ 100] | Train loss: [0.08443558433651924]
2023-06-04 22:33:15.692 | INFO     | trainer:train_loop:183 - Epoch: [51/ 100] | Train loss: [0.0871792846918106]
2023-06-04 22:38:44.899 | INFO     | trainer:train_loop:183 - Epoch: [52/ 100] | Train loss: [0.08536153048276901]
2023-06-04 22:44:13.547 | INFO     | trainer:train_loop:183 - Epoch: [53/ 100] | Train loss: [0.09063092571496964]
2023-06-04 22:49:43.114 | INFO     | trainer:train_loop:183 - Epoch: [54/ 100] | Train loss: [0.08286303506791591]
2023-06-04 22:55:11.816 | INFO     | trainer:train_loop:183 - Epoch: [55/ 100] | Train loss: [0.11282922874391078]
2023-06-04 23:00:42.480 | INFO     | trainer:train_loop:183 - Epoch: [56/ 100] | Train loss: [0.10319251464307308]
2023-06-04 23:06:12.022 | INFO     | trainer:train_loop:183 - Epoch: [57/ 100] | Train loss: [0.0900995609164238]
2023-06-04 23:11:40.410 | INFO     | trainer:train_loop:183 - Epoch: [58/ 100] | Train loss: [0.07705770628154278]
2023-06-04 23:17:12.445 | INFO     | trainer:train_loop:183 - Epoch: [59/ 100] | Train loss: [0.07395482710003853]
2023-06-04 23:22:40.158 | INFO     | trainer:train_loop:183 - Epoch: [60/ 100] | Train loss: [0.06836216954886913]
2023-06-04 23:28:12.177 | INFO     | trainer:train_loop:183 - Epoch: [61/ 100] | Train loss: [0.05994372996687889]
2023-06-04 23:33:42.213 | INFO     | trainer:train_loop:183 - Epoch: [62/ 100] | Train loss: [0.07256470572948456]
2023-06-04 23:39:09.488 | INFO     | trainer:train_loop:183 - Epoch: [63/ 100] | Train loss: [0.07017113310098648]
2023-06-04 23:44:40.216 | INFO     | trainer:train_loop:183 - Epoch: [64/ 100] | Train loss: [0.06889584471285343]
2023-06-04 23:50:07.799 | INFO     | trainer:train_loop:183 - Epoch: [65/ 100] | Train loss: [0.0701446835398674]
2023-06-04 23:55:36.229 | INFO     | trainer:train_loop:183 - Epoch: [66/ 100] | Train loss: [0.07189425659179688]
2023-06-05 00:01:04.748 | INFO     | trainer:train_loop:183 - Epoch: [67/ 100] | Train loss: [0.06993312087655068]
2023-06-05 00:06:34.285 | INFO     | trainer:train_loop:183 - Epoch: [68/ 100] | Train loss: [0.08728442703187465]
2023-06-05 00:12:06.305 | INFO     | trainer:train_loop:183 - Epoch: [69/ 100] | Train loss: [0.06090300785005093]
