2022-07-24 01:15:47.012 | INFO     | __main__:main:57 - Load config from configs/neo_large.yaml
2022-07-24 01:15:47.012 | INFO     | __main__:main:58 - {'dataset': {'data_path': '/home/s/WLIv5_pub_noud', 'train_data_path': ['/home/s/WLIv5_pub_noud/Train'], 'test_data_path': ['/home/s/WLIv5_pub_noud/Test'], 'val_data_path': ['/home/s/WLIv5_pub_noud/Test']}, 'model': {'num_classes': 3, 'save_dir': '/home/s/hungpv/polyps/checkpoints/neo_large_v11', 'backbone': 'MiT-B1', 'head': 'FaPNHead', 'pretrained': '/home/s/hungpv/polyps/pretrained_models/mit_b1.pth'}, 'optimizer': {'name': 'adam', 'lr': 0.0004, 'clip': 0.5, 'scheduler': 'cosine_warmup', 'loss': 'CustomLoss'}, 'dev': 'cuda', 'train': {'start_from': 0, 'save_from': 99, 'num_epochs': 100, 'num_warmup_epoch': 4, 'is_val': False, 'size_rates': [0.75, 1, 1.25], 'dataloader': {'batchsize': 16, 'img_size': 384, 'shuffle': True, 'num_workers': 4, 'pin_memory': True, 'drop_last': True}, 'amp': False, 'ddp': False, 'augment': {'prob': 1, 'Flip_prob': 0.5, 'HueSaturationValue_prob': 0.5, 'RandomBrightnessContrast_prob': 0.5, 'crop_prob': 0.0, 'randomrotate90_prob': 0.5, 'elastictransform_prob': 0.0}}, 'val': {'dataloader': {'batchsize': 8, 'img_size': 352, 'shuffle': True, 'num_workers': 4, 'pin_memory': True, 'drop_last': False}}, 'test': {'dev': 'cuda', 'visualize': True, 'visualize_dir': '/home/s/hungpv/polyps/neo_visualize', 'vis_x': 180, 'vis_overwrite': False, 'checkpoint_dir': '/home/s/hungpv/polyps/checkpoints/neo_large_v1/MiT-B3-UPerHead_60.pth', 'dataloader': {'batchsize': 1, 'img_size': 352, 'shuffle': True, 'num_workers': 4, 'pin_memory': True, 'drop_last': False}, 'augment': {'prob': 1, 'Flip_prob': 0, 'HueSaturationValue_prob': 0, 'RandomBrightnessContrast_prob': 0, 'crop_prob': 0, 'randomrotate90_prob': 0, 'elastictransform_prob': 0, 'gridistortion_prob': 0, 'opticaldistortion_prob': 0, 'verticalflip_prob': 0, 'horizontalflip_prob': 0, 'randomgamma_prob': 0, 'CoarseDropout_prob': 0, 'RGBShift_prob': 0, 'MotionBlur_prob': 0, 'MedianBlur_prob': 0, 'GaussianBlur_prob': 0, 'GaussNoise_prob': 0, 'ChannelShuffle_prob': 0}}}
2022-07-24 01:15:47.012 | INFO     | __main__:main:59 - Getting datapath
2022-07-24 01:15:47.039 | INFO     | __main__:main:74 - There are 5277 images to train
2022-07-24 01:15:47.045 | INFO     | __main__:main:93 - Train model with no valid dataset
2022-07-24 01:15:47.045 | INFO     | __main__:main:95 - Loading data
2022-07-24 01:15:47.860 | INFO     | __main__:main:109 - 329 batches to train
2022-07-24 01:15:48.066 | INFO     | __main__:main:122 - Loading model
2022-07-24 01:15:48.066 | INFO     | __main__:main:143 - Loading checkpoint from /home/s/hungpv/polyps/pretrained_models/mit_b1.pth ...
2022-07-24 01:15:50.955 | INFO     | __main__:main:187 - Training with FP32 ...
2022-07-24 01:32:37.254 | INFO     | tools.trainer:train_loop:124 - Epoch: [1/ 100] | Train loss: [1.1743301754664506]
2022-07-24 01:52:44.123 | INFO     | tools.trainer:train_loop:124 - Epoch: [2/ 100] | Train loss: [0.5562935204310258]
2022-07-24 02:11:58.596 | INFO     | tools.trainer:train_loop:124 - Epoch: [3/ 100] | Train loss: [0.5027776187042335]
2022-07-24 02:30:19.204 | INFO     | tools.trainer:train_loop:124 - Epoch: [4/ 100] | Train loss: [0.36675766316500114]
2022-07-24 02:48:58.908 | INFO     | tools.trainer:train_loop:124 - Epoch: [5/ 100] | Train loss: [0.3004903881428452]
2022-07-24 03:06:49.582 | INFO     | tools.trainer:train_loop:124 - Epoch: [6/ 100] | Train loss: [0.3283848400173941]
2022-07-24 03:24:48.002 | INFO     | tools.trainer:train_loop:124 - Epoch: [7/ 100] | Train loss: [0.3087427590076322]
2022-07-24 03:42:07.546 | INFO     | tools.trainer:train_loop:124 - Epoch: [8/ 100] | Train loss: [0.27875634482113426]
2022-07-24 03:59:30.341 | INFO     | tools.trainer:train_loop:124 - Epoch: [9/ 100] | Train loss: [0.27129271547210976]
2022-07-24 04:17:10.235 | INFO     | tools.trainer:train_loop:124 - Epoch: [10/ 100] | Train loss: [0.26874108580832784]
2022-07-24 04:34:44.511 | INFO     | tools.trainer:train_loop:124 - Epoch: [11/ 100] | Train loss: [0.26574344704306957]
2022-07-24 04:51:37.881 | INFO     | tools.trainer:train_loop:124 - Epoch: [12/ 100] | Train loss: [0.2655475764538198]
2022-07-24 05:10:16.802 | INFO     | tools.trainer:train_loop:124 - Epoch: [13/ 100] | Train loss: [0.25376614450411955]
2022-07-24 05:27:25.525 | INFO     | tools.trainer:train_loop:124 - Epoch: [14/ 100] | Train loss: [0.24603191278535183]
2022-07-24 05:45:01.537 | INFO     | tools.trainer:train_loop:124 - Epoch: [15/ 100] | Train loss: [0.24701781863046635]
2022-07-24 06:01:47.372 | INFO     | tools.trainer:train_loop:124 - Epoch: [16/ 100] | Train loss: [0.23727790173426225]
2022-07-24 06:19:14.783 | INFO     | tools.trainer:train_loop:124 - Epoch: [17/ 100] | Train loss: [0.23817966690451178]
2022-07-24 06:35:52.825 | INFO     | tools.trainer:train_loop:124 - Epoch: [18/ 100] | Train loss: [0.2326543566326421]
2022-07-24 06:52:19.071 | INFO     | tools.trainer:train_loop:124 - Epoch: [19/ 100] | Train loss: [0.22511725990514986]
2022-07-24 07:08:27.108 | INFO     | tools.trainer:train_loop:124 - Epoch: [20/ 100] | Train loss: [0.22954246490106756]
2022-07-24 07:24:50.741 | INFO     | tools.trainer:train_loop:124 - Epoch: [21/ 100] | Train loss: [0.2205088820002724]
2022-07-24 07:41:31.525 | INFO     | tools.trainer:train_loop:124 - Epoch: [22/ 100] | Train loss: [0.21890423671090495]
2022-07-24 07:59:09.061 | INFO     | tools.trainer:train_loop:124 - Epoch: [23/ 100] | Train loss: [0.2187008063753325]
2022-07-24 08:16:35.803 | INFO     | tools.trainer:train_loop:124 - Epoch: [24/ 100] | Train loss: [0.209516080815379]
2022-07-24 08:32:56.738 | INFO     | tools.trainer:train_loop:124 - Epoch: [25/ 100] | Train loss: [0.2111737849728677]
2022-07-24 08:49:06.945 | INFO     | tools.trainer:train_loop:124 - Epoch: [26/ 100] | Train loss: [0.2014399747106623]
2022-07-24 09:06:48.256 | INFO     | tools.trainer:train_loop:124 - Epoch: [27/ 100] | Train loss: [0.19924685156318192]
2022-07-24 09:19:41.919 | INFO     | tools.trainer:train_loop:124 - Epoch: [28/ 100] | Train loss: [0.1961639000719985]
2022-07-24 09:32:57.436 | INFO     | tools.trainer:train_loop:124 - Epoch: [29/ 100] | Train loss: [0.20374905188938766]
2022-07-24 09:46:12.592 | INFO     | tools.trainer:train_loop:124 - Epoch: [30/ 100] | Train loss: [0.19841560344339143]
2022-07-24 10:02:32.443 | INFO     | tools.trainer:train_loop:124 - Epoch: [31/ 100] | Train loss: [0.19202495497682537]
2022-07-24 10:20:36.436 | INFO     | tools.trainer:train_loop:124 - Epoch: [32/ 100] | Train loss: [0.18408397721030428]
2022-07-24 10:39:02.969 | INFO     | tools.trainer:train_loop:124 - Epoch: [33/ 100] | Train loss: [0.1874002456314024]
2022-07-24 10:56:27.405 | INFO     | tools.trainer:train_loop:124 - Epoch: [34/ 100] | Train loss: [0.18880150580388072]
2022-07-24 11:14:36.526 | INFO     | tools.trainer:train_loop:124 - Epoch: [35/ 100] | Train loss: [0.17795283495700467]
2022-07-24 11:33:19.226 | INFO     | tools.trainer:train_loop:124 - Epoch: [36/ 100] | Train loss: [0.18546860820209002]
2022-07-24 11:52:43.432 | INFO     | tools.trainer:train_loop:124 - Epoch: [37/ 100] | Train loss: [0.17322392803602668]
2022-07-24 12:11:19.348 | INFO     | tools.trainer:train_loop:124 - Epoch: [38/ 100] | Train loss: [0.16128940833874025]
2022-07-24 12:30:25.208 | INFO     | tools.trainer:train_loop:124 - Epoch: [39/ 100] | Train loss: [0.1676807449592736]
2022-07-24 12:48:56.586 | INFO     | tools.trainer:train_loop:124 - Epoch: [40/ 100] | Train loss: [0.1693067346390982]
2022-07-24 13:05:52.636 | INFO     | tools.trainer:train_loop:124 - Epoch: [41/ 100] | Train loss: [0.1620962122472224]
2022-07-24 13:21:24.381 | INFO     | tools.trainer:train_loop:124 - Epoch: [42/ 100] | Train loss: [0.1586118182082488]
2022-07-24 13:37:27.674 | INFO     | tools.trainer:train_loop:124 - Epoch: [43/ 100] | Train loss: [0.15462023459125798]
2022-07-24 13:54:41.763 | INFO     | tools.trainer:train_loop:124 - Epoch: [44/ 100] | Train loss: [0.1527764853259894]
2022-07-24 14:10:46.871 | INFO     | tools.trainer:train_loop:124 - Epoch: [45/ 100] | Train loss: [0.1457619020958802]
2022-07-24 14:28:00.205 | INFO     | tools.trainer:train_loop:124 - Epoch: [46/ 100] | Train loss: [0.15660661303843046]
2022-07-24 14:43:53.224 | INFO     | tools.trainer:train_loop:124 - Epoch: [47/ 100] | Train loss: [0.15285812069783639]
2022-07-24 14:59:44.426 | INFO     | tools.trainer:train_loop:124 - Epoch: [48/ 100] | Train loss: [0.1426242453960481]
2022-07-24 15:15:09.547 | INFO     | tools.trainer:train_loop:124 - Epoch: [49/ 100] | Train loss: [0.15095115303540302]
2022-07-24 15:31:33.976 | INFO     | tools.trainer:train_loop:124 - Epoch: [50/ 100] | Train loss: [0.13614193618999607]
2022-07-24 15:47:15.749 | INFO     | tools.trainer:train_loop:124 - Epoch: [51/ 100] | Train loss: [0.14184755487169357]
2022-07-24 16:02:24.686 | INFO     | tools.trainer:train_loop:124 - Epoch: [52/ 100] | Train loss: [0.1325020619574651]
2022-07-24 16:19:34.214 | INFO     | tools.trainer:train_loop:124 - Epoch: [53/ 100] | Train loss: [0.13488968623671851]
2022-07-24 16:36:18.353 | INFO     | tools.trainer:train_loop:124 - Epoch: [54/ 100] | Train loss: [0.13386162464990986]
2022-07-24 16:53:11.500 | INFO     | tools.trainer:train_loop:124 - Epoch: [55/ 100] | Train loss: [0.1339472856112164]
2022-07-24 17:09:02.312 | INFO     | tools.trainer:train_loop:124 - Epoch: [56/ 100] | Train loss: [0.1286096704846367]
2022-07-24 17:24:35.883 | INFO     | tools.trainer:train_loop:124 - Epoch: [57/ 100] | Train loss: [0.11925827461580737]
2022-07-24 17:39:51.707 | INFO     | tools.trainer:train_loop:124 - Epoch: [58/ 100] | Train loss: [0.1210960839623104]
2022-07-24 17:55:20.698 | INFO     | tools.trainer:train_loop:124 - Epoch: [59/ 100] | Train loss: [0.11943421593235981]
2022-07-24 18:10:17.916 | INFO     | tools.trainer:train_loop:124 - Epoch: [60/ 100] | Train loss: [0.1271982753088862]
2022-07-24 18:25:17.939 | INFO     | tools.trainer:train_loop:124 - Epoch: [61/ 100] | Train loss: [0.11605601434491145]
2022-07-24 18:40:52.844 | INFO     | tools.trainer:train_loop:124 - Epoch: [62/ 100] | Train loss: [0.11231650551922596]
2022-07-24 18:59:21.518 | INFO     | tools.trainer:train_loop:124 - Epoch: [63/ 100] | Train loss: [0.11014240503447034]
2022-07-24 19:18:32.593 | INFO     | tools.trainer:train_loop:124 - Epoch: [64/ 100] | Train loss: [0.10921296398622468]
2022-07-24 19:38:03.468 | INFO     | tools.trainer:train_loop:124 - Epoch: [65/ 100] | Train loss: [0.10975774776156551]
2022-07-24 19:58:06.826 | INFO     | tools.trainer:train_loop:124 - Epoch: [66/ 100] | Train loss: [0.10369312977220149]
2022-07-24 20:17:31.639 | INFO     | tools.trainer:train_loop:124 - Epoch: [67/ 100] | Train loss: [0.10988696887070104]
2022-07-24 20:36:16.160 | INFO     | tools.trainer:train_loop:124 - Epoch: [68/ 100] | Train loss: [0.10009164800216362]
2022-07-24 21:02:06.986 | INFO     | tools.trainer:train_loop:124 - Epoch: [69/ 100] | Train loss: [0.095392703007918]
2022-07-24 21:37:35.178 | INFO     | tools.trainer:train_loop:124 - Epoch: [70/ 100] | Train loss: [0.10137105921402256]
2022-07-24 22:13:21.114 | INFO     | tools.trainer:train_loop:124 - Epoch: [71/ 100] | Train loss: [0.09550201660163678]
2022-07-24 22:47:15.891 | INFO     | tools.trainer:train_loop:124 - Epoch: [72/ 100] | Train loss: [0.09329663646778256]
2022-07-24 23:12:55.319 | INFO     | tools.trainer:train_loop:124 - Epoch: [73/ 100] | Train loss: [0.0929563431165501]
2022-07-24 23:31:54.472 | INFO     | tools.trainer:train_loop:124 - Epoch: [74/ 100] | Train loss: [0.091124424744839]
2022-07-24 23:50:31.876 | INFO     | tools.trainer:train_loop:124 - Epoch: [75/ 100] | Train loss: [0.09742292884657992]
2022-07-25 00:08:34.383 | INFO     | tools.trainer:train_loop:124 - Epoch: [76/ 100] | Train loss: [0.09097694004900006]
2022-07-25 00:27:14.057 | INFO     | tools.trainer:train_loop:124 - Epoch: [77/ 100] | Train loss: [0.09460180951990074]
2022-07-25 00:44:38.362 | INFO     | tools.trainer:train_loop:124 - Epoch: [78/ 100] | Train loss: [0.0861117933907951]
2022-07-25 01:02:29.022 | INFO     | tools.trainer:train_loop:124 - Epoch: [79/ 100] | Train loss: [0.08605162734250711]
2022-07-25 01:20:11.729 | INFO     | tools.trainer:train_loop:124 - Epoch: [80/ 100] | Train loss: [0.08792137955301257]
2022-07-25 01:37:56.300 | INFO     | tools.trainer:train_loop:124 - Epoch: [81/ 100] | Train loss: [0.08928871222157428]
2022-07-25 01:56:52.468 | INFO     | tools.trainer:train_loop:124 - Epoch: [82/ 100] | Train loss: [0.08069926221772893]
2022-07-25 02:14:10.993 | INFO     | tools.trainer:train_loop:124 - Epoch: [83/ 100] | Train loss: [0.08912859221291941]
2022-07-25 02:31:21.350 | INFO     | tools.trainer:train_loop:124 - Epoch: [84/ 100] | Train loss: [0.07769289894431466]
2022-07-25 02:48:01.719 | INFO     | tools.trainer:train_loop:124 - Epoch: [85/ 100] | Train loss: [0.07876727008756171]
2022-07-25 03:04:50.917 | INFO     | tools.trainer:train_loop:124 - Epoch: [86/ 100] | Train loss: [0.08211071793227753]
2022-07-25 03:20:26.151 | INFO     | tools.trainer:train_loop:124 - Epoch: [87/ 100] | Train loss: [0.07660517626439184]
2022-07-25 03:36:33.482 | INFO     | tools.trainer:train_loop:124 - Epoch: [88/ 100] | Train loss: [0.07777892962369876]
2022-07-25 03:52:28.746 | INFO     | tools.trainer:train_loop:124 - Epoch: [89/ 100] | Train loss: [0.07472030451594877]
2022-07-25 04:08:39.318 | INFO     | tools.trainer:train_loop:124 - Epoch: [90/ 100] | Train loss: [0.07645834221484814]
2022-07-25 04:24:38.758 | INFO     | tools.trainer:train_loop:124 - Epoch: [91/ 100] | Train loss: [0.07439352426179727]
2022-07-25 04:40:53.289 | INFO     | tools.trainer:train_loop:124 - Epoch: [92/ 100] | Train loss: [0.0803001586144003]
2022-07-25 04:56:39.435 | INFO     | tools.trainer:train_loop:124 - Epoch: [93/ 100] | Train loss: [0.07264354487026173]
2022-07-25 05:12:35.475 | INFO     | tools.trainer:train_loop:124 - Epoch: [94/ 100] | Train loss: [0.07453903695426904]
2022-07-25 05:27:49.040 | INFO     | tools.trainer:train_loop:124 - Epoch: [95/ 100] | Train loss: [0.07451321756167162]
2022-07-25 05:43:05.270 | INFO     | tools.trainer:train_loop:124 - Epoch: [96/ 100] | Train loss: [0.06995090332708823]
2022-07-25 05:57:56.377 | INFO     | tools.trainer:train_loop:124 - Epoch: [97/ 100] | Train loss: [0.07522634872572219]
2022-07-25 06:13:31.770 | INFO     | tools.trainer:train_loop:124 - Epoch: [98/ 100] | Train loss: [0.07296258359468091]
2022-07-25 06:29:22.234 | INFO     | tools.trainer:train_loop:124 - Epoch: [99/ 100] | Train loss: [0.07104606219881573]
2022-07-25 06:45:28.432 | INFO     | tools.trainer:train_loop:124 - Epoch: [100/ 100] | Train loss: [0.07779010340548757]
2022-07-25 06:45:28.575 | INFO     | tools.trainer:train_loop:136 - [Saving Snapshot:]/home/s/hungpv/polyps/checkpoints/neo_large_v11/MiT-B1-FaPNHead_100.pth
2022-07-25 06:45:28.575 | INFO     | tools.trainer:train_loop:145 - Training cost: 106176.638129008seconds
