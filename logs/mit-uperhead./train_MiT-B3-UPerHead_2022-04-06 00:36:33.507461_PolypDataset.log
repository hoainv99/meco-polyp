2022-04-06 00:36:33.509 | INFO     | __main__:main:45 - Load config from configs/mit-uperhead.yaml
2022-04-06 00:36:33.509 | INFO     | __main__:main:46 - {'dataset': {'data_path': '/home/admin_mcn/hungpv/polyps/dataset/KCECE', 'train_data_path': ['/home/admin_mcn/hungpv/polyps/dataset/KCECE/TrainDataset'], 'test_data_path': ['/home/admin_mcn/hungpv/polyps/dataset/KCECE/TestDataset/Kvasir'], 'val_data_path': ['/home/admin_mcn/hungpv/polyps/dataset/KCECE/TestDataset/CVC-300']}, 'model': {'num_classes': 1, 'save_dir': '/mnt/data/hungpv/polyps/checkpoint/KCECE/mit-uperhead_v5', 'backbone': 'MiT-B3', 'head': 'UPerHead', 'pretrained': '/mnt/data/hungpv/polyps/pretrained-backbone/mit_b3.pth'}, 'optimizer': {'name': 'adam', 'lr': 0.0001, 'clip': 0.5, 'scheduler': 'cosine_warmup', 'loss': 'structure_loss'}, 'dev': 'cuda', 'train': {'start_from': 0, 'save_from': 78, 'num_epochs': 80, 'num_warmup_epoch': 10, 'is_val': False, 'size_rates': [0.75, 1, 1.25], 'dataloader': {'batchsize': 16, 'img_size': 352, 'shuffle': True, 'num_workers': 2, 'pin_memory': True, 'drop_last': True}, 'amp': False, 'ddp': False, 'augment': {'prob': 1, 'Flip_prob': 0.7, 'HueSaturationValue_prob': 0.7, 'RandomBrightnessContrast_prob': 0.5, 'crop_prob': 0.0, 'randomrotate90_prob': 0.7}}, 'test': {'dev': 'cuda', 'visualize': False, 'visualize_dir': '/mnt/data/hungpv/polyps/visualize', 'vis_x': 180, 'vis_overwrite': False, 'checkpoint_dir': '/mnt/data/hungpv/polyps/checkpoint/KCECE/mit-uperhead_v3/MiT-B3-UPerHead_80.pth', 'dataloader': {'batchsize': 1, 'img_size': 352, 'shuffle': True, 'num_workers': 2, 'pin_memory': True, 'drop_last': True}, 'augment': {'prob': 1, 'Flip_prob': 0, 'HueSaturationValue_prob': 0, 'RandomBrightnessContrast_prob': 0, 'crop_prob': 0, 'randomrotate90_prob': 0, 'elastictransform_prob': 0, 'gridistortion_prob': 0, 'opticaldistortion_prob': 0, 'verticalflip_prob': 0, 'horizontalflip_prob': 0, 'randomgamma_prob': 0, 'CoarseDropout_prob': 0, 'RGBShift_prob': 0, 'MotionBlur_prob': 0, 'MedianBlur_prob': 0, 'GaussianBlur_prob': 0, 'GaussNoise_prob': 0, 'ChannelShuffle_prob': 0}}}
2022-04-06 00:36:33.509 | INFO     | __main__:main:47 - Getting datapath
2022-04-06 00:36:33.515 | INFO     | __main__:main:61 - There are 1450 images to train
2022-04-06 00:36:33.515 | INFO     | __main__:main:80 - Train model with no valid dataset
2022-04-06 00:36:33.515 | INFO     | __main__:main:82 - Loading data
2022-04-06 00:36:33.605 | INFO     | __main__:main:96 - 90 batches to train
2022-04-06 00:36:33.610 | INFO     | __main__:main:109 - Loading model
2022-04-06 00:36:33.610 | INFO     | __main__:main:126 - Loading checkpoint from /mnt/data/hungpv/polyps/pretrained-backbone/mit_b3.pth ...
2022-04-06 00:36:36.362 | INFO     | __main__:main:164 - Training with FP32 ...
2022-04-06 00:39:07.577 | INFO     | tools.trainer:train_loop:89 - Epoch: [1/ 80] | Train loss: [2.367814368671841]
2022-04-06 00:41:38.216 | INFO     | tools.trainer:train_loop:89 - Epoch: [2/ 80] | Train loss: [0.7757056206464767]
2022-04-06 00:44:08.635 | INFO     | tools.trainer:train_loop:89 - Epoch: [3/ 80] | Train loss: [0.5778999067015118]
2022-04-06 00:44:08.840 | INFO     | tools.trainer:train_loop:104 - [Saving Snapshot:]/mnt/data/hungpv/polyps/checkpoint/KCECE/mit-uperhead_v5/MiT-B3-UPerHead_3.pth
2022-04-06 00:46:39.659 | INFO     | tools.trainer:train_loop:89 - Epoch: [4/ 80] | Train loss: [0.457408246729109]
2022-04-06 00:49:10.528 | INFO     | tools.trainer:train_loop:89 - Epoch: [5/ 80] | Train loss: [0.3945132644640075]
2022-04-06 00:51:41.492 | INFO     | tools.trainer:train_loop:89 - Epoch: [6/ 80] | Train loss: [0.33062185777558223]
2022-04-06 00:54:12.514 | INFO     | tools.trainer:train_loop:89 - Epoch: [7/ 80] | Train loss: [0.2952704343530867]
2022-04-06 00:56:43.472 | INFO     | tools.trainer:train_loop:89 - Epoch: [8/ 80] | Train loss: [0.25746298929055533]
2022-04-06 00:59:14.450 | INFO     | tools.trainer:train_loop:89 - Epoch: [9/ 80] | Train loss: [0.24913734396298726]
2022-04-06 01:01:45.516 | INFO     | tools.trainer:train_loop:89 - Epoch: [10/ 80] | Train loss: [0.2519351636370023]
2022-04-06 01:04:16.510 | INFO     | tools.trainer:train_loop:89 - Epoch: [11/ 80] | Train loss: [0.23149373183647792]
2022-04-06 01:06:47.125 | INFO     | tools.trainer:train_loop:89 - Epoch: [12/ 80] | Train loss: [0.237846224837833]
2022-04-06 01:09:18.120 | INFO     | tools.trainer:train_loop:89 - Epoch: [13/ 80] | Train loss: [0.20863227157129183]
2022-04-06 01:11:49.139 | INFO     | tools.trainer:train_loop:89 - Epoch: [14/ 80] | Train loss: [0.1907921752995915]
2022-04-06 01:14:19.639 | INFO     | tools.trainer:train_loop:89 - Epoch: [15/ 80] | Train loss: [0.1846468143992954]
2022-04-06 01:16:50.753 | INFO     | tools.trainer:train_loop:89 - Epoch: [16/ 80] | Train loss: [0.18106575359900792]
2022-04-06 01:19:21.284 | INFO     | tools.trainer:train_loop:89 - Epoch: [17/ 80] | Train loss: [0.17165035688214833]
2022-04-06 01:21:51.808 | INFO     | tools.trainer:train_loop:89 - Epoch: [18/ 80] | Train loss: [0.16605627917581134]
2022-04-06 01:24:22.791 | INFO     | tools.trainer:train_loop:89 - Epoch: [19/ 80] | Train loss: [0.16398987629347378]
2022-04-06 01:26:53.385 | INFO     | tools.trainer:train_loop:89 - Epoch: [20/ 80] | Train loss: [0.15682709573043718]
2022-04-06 01:29:24.105 | INFO     | tools.trainer:train_loop:89 - Epoch: [21/ 80] | Train loss: [0.16038535311818122]
2022-04-06 01:31:55.092 | INFO     | tools.trainer:train_loop:89 - Epoch: [22/ 80] | Train loss: [0.1521920382976532]
2022-04-06 01:34:25.734 | INFO     | tools.trainer:train_loop:89 - Epoch: [23/ 80] | Train loss: [0.1426432766020298]
2022-04-06 01:36:56.794 | INFO     | tools.trainer:train_loop:89 - Epoch: [24/ 80] | Train loss: [0.14507606625556946]
2022-04-06 01:39:28.015 | INFO     | tools.trainer:train_loop:89 - Epoch: [25/ 80] | Train loss: [0.14010688612858455]
2022-04-06 01:41:58.577 | INFO     | tools.trainer:train_loop:89 - Epoch: [26/ 80] | Train loss: [0.15182376578450202]
2022-04-06 01:44:29.603 | INFO     | tools.trainer:train_loop:89 - Epoch: [27/ 80] | Train loss: [0.1342294285694758]
2022-04-06 01:47:00.020 | INFO     | tools.trainer:train_loop:89 - Epoch: [28/ 80] | Train loss: [0.13260419012771713]
2022-04-06 01:49:31.218 | INFO     | tools.trainer:train_loop:89 - Epoch: [29/ 80] | Train loss: [0.12854620143771173]
2022-04-06 01:52:02.164 | INFO     | tools.trainer:train_loop:89 - Epoch: [30/ 80] | Train loss: [0.12730235300130313]
2022-04-06 01:54:33.168 | INFO     | tools.trainer:train_loop:89 - Epoch: [31/ 80] | Train loss: [0.12694509112172656]
2022-04-06 01:57:04.201 | INFO     | tools.trainer:train_loop:89 - Epoch: [32/ 80] | Train loss: [0.1264918542570538]
2022-04-06 01:59:35.336 | INFO     | tools.trainer:train_loop:89 - Epoch: [33/ 80] | Train loss: [0.1356531566215886]
2022-04-06 02:02:06.420 | INFO     | tools.trainer:train_loop:89 - Epoch: [34/ 80] | Train loss: [0.12225981205701827]
2022-04-06 02:04:37.089 | INFO     | tools.trainer:train_loop:89 - Epoch: [35/ 80] | Train loss: [0.11911324105328984]
2022-04-06 02:07:07.770 | INFO     | tools.trainer:train_loop:89 - Epoch: [36/ 80] | Train loss: [0.11857669841912058]
2022-04-06 02:09:38.655 | INFO     | tools.trainer:train_loop:89 - Epoch: [37/ 80] | Train loss: [0.11338365160756642]
2022-04-06 02:12:09.786 | INFO     | tools.trainer:train_loop:89 - Epoch: [38/ 80] | Train loss: [0.11077970415353774]
2022-04-06 02:14:40.915 | INFO     | tools.trainer:train_loop:89 - Epoch: [39/ 80] | Train loss: [0.10773272307382689]
2022-04-06 02:17:11.647 | INFO     | tools.trainer:train_loop:89 - Epoch: [40/ 80] | Train loss: [0.10853297925657696]
2022-04-06 02:19:42.720 | INFO     | tools.trainer:train_loop:89 - Epoch: [41/ 80] | Train loss: [0.10900242461098565]
2022-04-06 02:22:13.429 | INFO     | tools.trainer:train_loop:89 - Epoch: [42/ 80] | Train loss: [0.1068370916777187]
2022-04-06 02:24:43.901 | INFO     | tools.trainer:train_loop:89 - Epoch: [43/ 80] | Train loss: [0.10940211274557643]
2022-04-06 02:27:15.132 | INFO     | tools.trainer:train_loop:89 - Epoch: [44/ 80] | Train loss: [0.10215566936466429]
2022-04-06 02:29:45.784 | INFO     | tools.trainer:train_loop:89 - Epoch: [45/ 80] | Train loss: [0.10167865314417415]
2022-04-06 02:32:16.207 | INFO     | tools.trainer:train_loop:89 - Epoch: [46/ 80] | Train loss: [0.09952629307905833]
2022-04-06 02:34:47.095 | INFO     | tools.trainer:train_loop:89 - Epoch: [47/ 80] | Train loss: [0.09885494833191236]
2022-04-06 02:37:18.172 | INFO     | tools.trainer:train_loop:89 - Epoch: [48/ 80] | Train loss: [0.09569110381934377]
2022-04-06 02:39:49.290 | INFO     | tools.trainer:train_loop:89 - Epoch: [49/ 80] | Train loss: [0.09604504273997413]
2022-04-06 02:42:20.023 | INFO     | tools.trainer:train_loop:89 - Epoch: [50/ 80] | Train loss: [0.09563804724150234]
2022-04-06 02:44:50.520 | INFO     | tools.trainer:train_loop:89 - Epoch: [51/ 80] | Train loss: [0.09386163494653171]
2022-04-06 02:47:21.108 | INFO     | tools.trainer:train_loop:89 - Epoch: [52/ 80] | Train loss: [0.0922166854970985]
2022-04-06 02:49:52.281 | INFO     | tools.trainer:train_loop:89 - Epoch: [53/ 80] | Train loss: [0.0920670039123959]
2022-04-06 02:52:22.906 | INFO     | tools.trainer:train_loop:89 - Epoch: [54/ 80] | Train loss: [0.08759237478176753]
2022-04-06 02:54:53.945 | INFO     | tools.trainer:train_loop:89 - Epoch: [55/ 80] | Train loss: [0.0864402395983537]
2022-04-06 02:57:25.039 | INFO     | tools.trainer:train_loop:89 - Epoch: [56/ 80] | Train loss: [0.08786716096931034]
2022-04-06 02:59:56.238 | INFO     | tools.trainer:train_loop:89 - Epoch: [57/ 80] | Train loss: [0.084734455578857]
2022-04-06 03:02:27.467 | INFO     | tools.trainer:train_loop:89 - Epoch: [58/ 80] | Train loss: [0.08700157552957535]
2022-04-06 03:04:58.182 | INFO     | tools.trainer:train_loop:89 - Epoch: [59/ 80] | Train loss: [0.08387387626700932]
2022-04-06 03:07:29.236 | INFO     | tools.trainer:train_loop:89 - Epoch: [60/ 80] | Train loss: [0.0828457657661703]
2022-04-06 03:07:29.443 | INFO     | tools.trainer:train_loop:104 - [Saving Snapshot:]/mnt/data/hungpv/polyps/checkpoint/KCECE/mit-uperhead_v5/MiT-B3-UPerHead_60.pth
2022-04-06 03:10:00.555 | INFO     | tools.trainer:train_loop:89 - Epoch: [61/ 80] | Train loss: [0.08261963973442714]
2022-04-06 03:12:31.471 | INFO     | tools.trainer:train_loop:89 - Epoch: [62/ 80] | Train loss: [0.08130936556392246]
2022-04-06 03:15:02.480 | INFO     | tools.trainer:train_loop:89 - Epoch: [63/ 80] | Train loss: [0.08099828287959099]
2022-04-06 03:17:33.685 | INFO     | tools.trainer:train_loop:89 - Epoch: [64/ 80] | Train loss: [0.08105404087238842]
2022-04-06 03:20:04.430 | INFO     | tools.trainer:train_loop:89 - Epoch: [65/ 80] | Train loss: [0.0787933929098977]
2022-04-06 03:22:35.068 | INFO     | tools.trainer:train_loop:89 - Epoch: [66/ 80] | Train loss: [0.07839962604145209]
2022-04-06 03:25:05.731 | INFO     | tools.trainer:train_loop:89 - Epoch: [67/ 80] | Train loss: [0.07653219310773743]
2022-04-06 03:27:36.583 | INFO     | tools.trainer:train_loop:89 - Epoch: [68/ 80] | Train loss: [0.07605572769211398]
2022-04-06 03:30:07.847 | INFO     | tools.trainer:train_loop:89 - Epoch: [69/ 80] | Train loss: [0.07466105553838942]
2022-04-06 03:32:38.631 | INFO     | tools.trainer:train_loop:89 - Epoch: [70/ 80] | Train loss: [0.07484773322939872]
2022-04-06 03:35:09.416 | INFO     | tools.trainer:train_loop:89 - Epoch: [71/ 80] | Train loss: [0.07442468309568034]
2022-04-06 03:37:40.495 | INFO     | tools.trainer:train_loop:89 - Epoch: [72/ 80] | Train loss: [0.0731608159840107]
2022-04-06 03:40:11.130 | INFO     | tools.trainer:train_loop:89 - Epoch: [73/ 80] | Train loss: [0.0723116994731956]
2022-04-06 03:42:42.220 | INFO     | tools.trainer:train_loop:89 - Epoch: [74/ 80] | Train loss: [0.07180049369732538]
2022-04-06 03:45:12.904 | INFO     | tools.trainer:train_loop:89 - Epoch: [75/ 80] | Train loss: [0.07123352732095453]
2022-04-06 03:47:43.643 | INFO     | tools.trainer:train_loop:89 - Epoch: [76/ 80] | Train loss: [0.07135759571360217]
2022-04-06 03:50:14.684 | INFO     | tools.trainer:train_loop:89 - Epoch: [77/ 80] | Train loss: [0.07042902799116241]
2022-04-06 03:52:45.392 | INFO     | tools.trainer:train_loop:89 - Epoch: [78/ 80] | Train loss: [0.07022751979529858]
2022-04-06 03:55:16.095 | INFO     | tools.trainer:train_loop:89 - Epoch: [79/ 80] | Train loss: [0.06989105252756013]
2022-04-06 03:55:16.301 | INFO     | tools.trainer:train_loop:104 - [Saving Snapshot:]/mnt/data/hungpv/polyps/checkpoint/KCECE/mit-uperhead_v5/MiT-B3-UPerHead_79.pth
2022-04-06 03:57:46.932 | INFO     | tools.trainer:train_loop:89 - Epoch: [80/ 80] | Train loss: [0.06922346403201421]
2022-04-06 03:57:47.134 | INFO     | tools.trainer:train_loop:104 - [Saving Snapshot:]/mnt/data/hungpv/polyps/checkpoint/KCECE/mit-uperhead_v5/MiT-B3-UPerHead_80.pth
2022-04-06 03:57:47.135 | INFO     | tools.trainer:train_loop:110 - Training cost: 12069.795806398033seconds
