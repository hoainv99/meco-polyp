2023-06-06 10:24:48.221 | INFO     | __main__:main:57 - Load config from configs/neo_small.yaml
2023-06-06 10:24:48.221 | INFO     | __main__:main:58 - {'dataset': {'data_path': '/root/neo_code_reco_mb/bkai-igh-neopolyp', 'train_data_path': ['/root/neo_code_reco_mb/bkai-igh-neopolyp'], 'test_data_path': ['/root/neo_code_reco_mb/bkai-igh-neopolyp/test/test'], 'val_data_path': ['/root/neo_code_reco_mb/bkai-igh-neopolyp']}, 'model': {'num_classes': 3, 'save_dir': '/root/neo_code_reco_mb/configs/checkpoint0606', 'backbone': 'MiT-B3', 'head': 'FaPNHead', 'pretrained': 'mit_b3.pth'}, 'optimizer': {'name': 'adam', 'lr': 0.0001, 'clip': 0.5, 'scheduler': 'cosine_warmup', 'loss': 'multi_structure_loss'}, 'dev': 'cuda', 'train': {'start_from': 0, 'save_from': 99, 'num_epochs': 100, 'num_warmup_epoch': 8, 'is_val': False, 'size_rates': [0.75, 1, 1.25], 'dataloader': {'batchsize': 8, 'img_size': 384, 'shuffle': True, 'num_workers': 4, 'pin_memory': True, 'drop_last': True}, 'amp': False, 'ddp': False, 'augment': {'prob': 1, 'Flip_prob': 0.5, 'HueSaturationValue_prob': 0.5, 'RandomBrightnessContrast_prob': 0.5, 'crop_prob': 0.0, 'randomrotate90_prob': 0.5, 'ColorJitter_prob': 0.5}, 'augment_weak': {'prob': 1, 'Flip_prob': 0.5}}, 'val': {'dataloader': {'batchsize': 8, 'img_size': 384, 'shuffle': True, 'num_workers': 4, 'pin_memory': True, 'drop_last': False}}, 'test': {'dev': 'cuda', 'visualize': True, 'visualize_dir': '/root/neo_code_reco_mb/neo_visualize', 'vis_x': 180, 'vis_overwrite': False, 'checkpoint_dir': '/root/neo_code_reco_mb/configs/checkpoint0606/MiT-B3-FaPNHead_100_teacher.pth', 'dataloader': {'batchsize': 1, 'img_size': 384, 'shuffle': True, 'num_workers': 4, 'pin_memory': True, 'drop_last': False}, 'augment': {'prob': 1, 'Flip_prob': 0, 'HueSaturationValue_prob': 0, 'RandomBrightnessContrast_prob': 0, 'crop_prob': 0, 'randomrotate90_prob': 0, 'elastictransform_prob': 0, 'gridistortion_prob': 0, 'opticaldistortion_prob': 0, 'verticalflip_prob': 0, 'horizontalflip_prob': 0, 'randomgamma_prob': 0, 'CoarseDropout_prob': 0, 'RGBShift_prob': 0, 'MotionBlur_prob': 0, 'MedianBlur_prob': 0, 'GaussianBlur_prob': 0, 'GaussNoise_prob': 0, 'ChannelShuffle_prob': 0}}}
2023-06-06 10:24:48.221 | INFO     | __main__:main:59 - Getting datapath
2023-06-06 10:24:48.228 | INFO     | __main__:main:74 - There are 1000 images to train
2023-06-06 10:24:48.229 | INFO     | __main__:main:93 - Train model with no valid dataset
2023-06-06 10:24:48.229 | INFO     | __main__:main:95 - Loading data
2023-06-06 10:24:48.603 | INFO     | __main__:main:112 - 125 batches to train
2023-06-06 10:24:48.603 | INFO     | __main__:main:125 - Loading model
2023-06-06 10:24:48.603 | INFO     | __main__:main:146 - Loading checkpoint from mit_b3.pth ...
2023-06-06 10:24:54.629 | INFO     | __main__:main:190 - Training with FP32 ...
2023-06-06 10:30:18.604 | INFO     | trainer:train_loop:182 - Epoch: [1/ 100] | Train loss: [1.8351903276443482]
2023-06-06 10:35:40.868 | INFO     | trainer:train_loop:182 - Epoch: [2/ 100] | Train loss: [0.7582833781242371]
2023-06-06 10:41:05.986 | INFO     | trainer:train_loop:182 - Epoch: [3/ 100] | Train loss: [0.7323259010314941]
2023-06-06 10:46:29.997 | INFO     | trainer:train_loop:182 - Epoch: [4/ 100] | Train loss: [0.622355051279068]
2023-06-06 10:51:53.069 | INFO     | trainer:train_loop:182 - Epoch: [5/ 100] | Train loss: [0.5467596608400345]
2023-06-06 10:57:16.454 | INFO     | trainer:train_loop:182 - Epoch: [6/ 100] | Train loss: [0.4060247288942337]
2023-06-06 11:02:40.018 | INFO     | trainer:train_loop:182 - Epoch: [7/ 100] | Train loss: [0.41762981021404266]
2023-06-06 11:08:03.328 | INFO     | trainer:train_loop:182 - Epoch: [8/ 100] | Train loss: [0.3741796289682388]
2023-06-06 11:13:26.879 | INFO     | trainer:train_loop:182 - Epoch: [9/ 100] | Train loss: [0.3236126455068588]
2023-06-06 11:18:50.842 | INFO     | trainer:train_loop:182 - Epoch: [10/ 100] | Train loss: [0.4158838955760002]
2023-06-06 11:24:16.727 | INFO     | trainer:train_loop:182 - Epoch: [11/ 100] | Train loss: [0.33391298866271973]
2023-06-06 11:29:42.421 | INFO     | trainer:train_loop:182 - Epoch: [12/ 100] | Train loss: [0.27834234744310377]
2023-06-06 11:35:07.586 | INFO     | trainer:train_loop:182 - Epoch: [13/ 100] | Train loss: [0.2419269561767578]
2023-06-06 11:40:31.150 | INFO     | trainer:train_loop:182 - Epoch: [14/ 100] | Train loss: [0.2434378514289856]
2023-06-06 11:45:56.242 | INFO     | trainer:train_loop:182 - Epoch: [15/ 100] | Train loss: [0.21337050324678422]
2023-06-06 11:51:22.111 | INFO     | trainer:train_loop:182 - Epoch: [16/ 100] | Train loss: [0.22881702238321305]
2023-06-06 11:56:48.679 | INFO     | trainer:train_loop:182 - Epoch: [17/ 100] | Train loss: [0.20402904570102692]
2023-06-06 12:02:14.878 | INFO     | trainer:train_loop:182 - Epoch: [18/ 100] | Train loss: [0.2639908970296383]
2023-06-06 12:07:39.939 | INFO     | trainer:train_loop:182 - Epoch: [19/ 100] | Train loss: [0.29676205974817277]
2023-06-06 12:13:04.933 | INFO     | trainer:train_loop:182 - Epoch: [20/ 100] | Train loss: [0.22840569829940796]
2023-06-06 12:18:31.248 | INFO     | trainer:train_loop:182 - Epoch: [21/ 100] | Train loss: [0.1905113195478916]
2023-06-06 12:23:57.110 | INFO     | trainer:train_loop:182 - Epoch: [22/ 100] | Train loss: [0.1757171226143837]
2023-06-06 12:29:23.493 | INFO     | trainer:train_loop:182 - Epoch: [23/ 100] | Train loss: [0.1723759873509407]
2023-06-06 12:34:48.363 | INFO     | trainer:train_loop:182 - Epoch: [24/ 100] | Train loss: [0.17040308648347854]
2023-06-06 12:40:14.028 | INFO     | trainer:train_loop:182 - Epoch: [25/ 100] | Train loss: [0.15281703752279283]
2023-06-06 12:45:40.228 | INFO     | trainer:train_loop:182 - Epoch: [26/ 100] | Train loss: [0.17550483313202858]
2023-06-06 12:51:07.541 | INFO     | trainer:train_loop:182 - Epoch: [27/ 100] | Train loss: [0.16338635051250458]
2023-06-06 12:56:33.104 | INFO     | trainer:train_loop:182 - Epoch: [28/ 100] | Train loss: [0.14595650854706765]
2023-06-06 13:01:58.423 | INFO     | trainer:train_loop:182 - Epoch: [29/ 100] | Train loss: [0.13858513501286507]
2023-06-06 13:07:25.516 | INFO     | trainer:train_loop:182 - Epoch: [30/ 100] | Train loss: [0.13588110226392747]
2023-06-06 13:12:53.101 | INFO     | trainer:train_loop:182 - Epoch: [31/ 100] | Train loss: [0.14764525324106217]
2023-06-06 13:18:19.194 | INFO     | trainer:train_loop:182 - Epoch: [32/ 100] | Train loss: [0.13373180204629898]
2023-06-06 13:23:43.812 | INFO     | trainer:train_loop:182 - Epoch: [33/ 100] | Train loss: [0.15151452937722207]
2023-06-06 13:29:09.500 | INFO     | trainer:train_loop:182 - Epoch: [34/ 100] | Train loss: [0.14006431576609613]
2023-06-06 13:34:36.864 | INFO     | trainer:train_loop:182 - Epoch: [35/ 100] | Train loss: [0.11481504195928574]
2023-06-06 13:40:03.570 | INFO     | trainer:train_loop:182 - Epoch: [36/ 100] | Train loss: [0.11127138024568557]
2023-06-06 13:45:30.910 | INFO     | trainer:train_loop:182 - Epoch: [37/ 100] | Train loss: [0.09928301322460174]
2023-06-06 13:50:59.704 | INFO     | trainer:train_loop:182 - Epoch: [38/ 100] | Train loss: [0.10758693692088127]
2023-06-06 13:56:26.125 | INFO     | trainer:train_loop:182 - Epoch: [39/ 100] | Train loss: [0.10914072015881539]
2023-06-06 14:01:52.786 | INFO     | trainer:train_loop:182 - Epoch: [40/ 100] | Train loss: [0.09960848566889763]
2023-06-06 14:07:22.402 | INFO     | trainer:train_loop:182 - Epoch: [41/ 100] | Train loss: [0.1004900014847517]
2023-06-06 14:12:51.102 | INFO     | trainer:train_loop:182 - Epoch: [42/ 100] | Train loss: [0.09692647445201874]
2023-06-06 14:18:17.686 | INFO     | trainer:train_loop:182 - Epoch: [43/ 100] | Train loss: [0.0970050450861454]
2023-06-06 14:23:44.385 | INFO     | trainer:train_loop:182 - Epoch: [44/ 100] | Train loss: [0.0850776210129261]
2023-06-06 14:29:10.614 | INFO     | trainer:train_loop:182 - Epoch: [45/ 100] | Train loss: [0.09870153479278088]
2023-06-06 14:34:37.400 | INFO     | trainer:train_loop:182 - Epoch: [46/ 100] | Train loss: [0.09127174443006515]
2023-06-06 14:40:03.749 | INFO     | trainer:train_loop:182 - Epoch: [47/ 100] | Train loss: [0.08696766504645348]
2023-06-06 14:45:30.000 | INFO     | trainer:train_loop:182 - Epoch: [48/ 100] | Train loss: [0.07890702021121979]
2023-06-06 14:50:54.914 | INFO     | trainer:train_loop:182 - Epoch: [49/ 100] | Train loss: [0.07960293270647525]
2023-06-06 14:56:19.382 | INFO     | trainer:train_loop:182 - Epoch: [50/ 100] | Train loss: [0.08302973881363869]
2023-06-06 15:01:46.968 | INFO     | trainer:train_loop:182 - Epoch: [51/ 100] | Train loss: [0.07543598392605781]
2023-06-06 15:07:14.321 | INFO     | trainer:train_loop:182 - Epoch: [52/ 100] | Train loss: [0.07162767612934112]
2023-06-06 15:12:39.455 | INFO     | trainer:train_loop:182 - Epoch: [53/ 100] | Train loss: [0.07344795493781567]
2023-06-06 15:18:05.810 | INFO     | trainer:train_loop:182 - Epoch: [54/ 100] | Train loss: [0.07106632028520107]
2023-06-06 15:23:31.150 | INFO     | trainer:train_loop:182 - Epoch: [55/ 100] | Train loss: [0.07013180783390999]
2023-06-06 15:28:58.392 | INFO     | trainer:train_loop:182 - Epoch: [56/ 100] | Train loss: [0.07204018045961857]
2023-06-06 15:34:25.186 | INFO     | trainer:train_loop:182 - Epoch: [57/ 100] | Train loss: [0.07191498276591302]
2023-06-06 15:39:53.910 | INFO     | trainer:train_loop:182 - Epoch: [58/ 100] | Train loss: [0.06451874755322934]
2023-06-06 15:45:20.997 | INFO     | trainer:train_loop:182 - Epoch: [59/ 100] | Train loss: [0.07008619628846645]
2023-06-06 15:50:48.221 | INFO     | trainer:train_loop:182 - Epoch: [60/ 100] | Train loss: [0.0605575146228075]
2023-06-06 15:56:15.549 | INFO     | trainer:train_loop:182 - Epoch: [61/ 100] | Train loss: [0.07041048216819763]
2023-06-06 16:01:42.112 | INFO     | trainer:train_loop:182 - Epoch: [62/ 100] | Train loss: [0.061944539293646815]
2023-06-06 16:07:08.095 | INFO     | trainer:train_loop:182 - Epoch: [63/ 100] | Train loss: [0.055963542222976684]
2023-06-06 16:12:35.312 | INFO     | trainer:train_loop:182 - Epoch: [64/ 100] | Train loss: [0.05781669192016125]
2023-06-06 16:18:01.415 | INFO     | trainer:train_loop:182 - Epoch: [65/ 100] | Train loss: [0.06482956656813621]
2023-06-06 16:23:27.619 | INFO     | trainer:train_loop:182 - Epoch: [66/ 100] | Train loss: [0.05737382210791111]
2023-06-06 16:28:55.290 | INFO     | trainer:train_loop:182 - Epoch: [67/ 100] | Train loss: [0.059048224225640294]
2023-06-06 16:34:22.992 | INFO     | trainer:train_loop:182 - Epoch: [68/ 100] | Train loss: [0.05340121684968471]
2023-06-06 16:39:48.218 | INFO     | trainer:train_loop:182 - Epoch: [69/ 100] | Train loss: [0.05634341211616993]
2023-06-06 16:45:14.699 | INFO     | trainer:train_loop:182 - Epoch: [70/ 100] | Train loss: [0.05580011303722859]
2023-06-06 16:50:42.759 | INFO     | trainer:train_loop:182 - Epoch: [71/ 100] | Train loss: [0.05230022770166397]
2023-06-06 16:56:08.647 | INFO     | trainer:train_loop:182 - Epoch: [72/ 100] | Train loss: [0.05400804005563259]
2023-06-06 17:01:35.905 | INFO     | trainer:train_loop:182 - Epoch: [73/ 100] | Train loss: [0.05203356745839119]
2023-06-06 17:07:02.256 | INFO     | trainer:train_loop:182 - Epoch: [74/ 100] | Train loss: [0.05082750353217125]
2023-06-06 17:12:26.741 | INFO     | trainer:train_loop:182 - Epoch: [75/ 100] | Train loss: [0.049808000802993774]
2023-06-06 17:17:55.798 | INFO     | trainer:train_loop:182 - Epoch: [76/ 100] | Train loss: [0.05246571664512158]
2023-06-06 17:23:22.144 | INFO     | trainer:train_loop:182 - Epoch: [77/ 100] | Train loss: [0.050558658227324485]
2023-06-06 17:28:49.909 | INFO     | trainer:train_loop:182 - Epoch: [78/ 100] | Train loss: [0.051311912626028064]
2023-06-06 17:34:17.938 | INFO     | trainer:train_loop:182 - Epoch: [79/ 100] | Train loss: [0.04766616481542587]
2023-06-06 17:39:45.759 | INFO     | trainer:train_loop:182 - Epoch: [80/ 100] | Train loss: [0.04688612338900566]
2023-06-06 17:45:13.053 | INFO     | trainer:train_loop:182 - Epoch: [81/ 100] | Train loss: [0.04650404854118824]
2023-06-06 17:50:40.155 | INFO     | trainer:train_loop:182 - Epoch: [82/ 100] | Train loss: [0.04831852611899376]
2023-06-06 17:56:05.447 | INFO     | trainer:train_loop:182 - Epoch: [83/ 100] | Train loss: [0.04612747226655483]
2023-06-06 18:01:31.710 | INFO     | trainer:train_loop:182 - Epoch: [84/ 100] | Train loss: [0.0462154120951891]
2023-06-06 18:06:56.921 | INFO     | trainer:train_loop:182 - Epoch: [85/ 100] | Train loss: [0.04882806089520454]
2023-06-06 18:12:23.584 | INFO     | trainer:train_loop:182 - Epoch: [86/ 100] | Train loss: [0.04665449611842632]
2023-06-06 18:17:49.935 | INFO     | trainer:train_loop:182 - Epoch: [87/ 100] | Train loss: [0.045521426141262054]
2023-06-06 18:23:16.609 | INFO     | trainer:train_loop:182 - Epoch: [88/ 100] | Train loss: [0.047993879243731496]
2023-06-06 18:28:43.366 | INFO     | trainer:train_loop:182 - Epoch: [89/ 100] | Train loss: [0.04616306920349598]
2023-06-06 18:34:09.071 | INFO     | trainer:train_loop:182 - Epoch: [90/ 100] | Train loss: [0.045282040163874625]
2023-06-06 18:39:35.733 | INFO     | trainer:train_loop:182 - Epoch: [91/ 100] | Train loss: [0.04525860366225243]
2023-06-06 18:45:04.906 | INFO     | trainer:train_loop:182 - Epoch: [92/ 100] | Train loss: [0.04432199861109257]
2023-06-06 18:50:33.226 | INFO     | trainer:train_loop:182 - Epoch: [93/ 100] | Train loss: [0.04511380636692047]
2023-06-06 18:56:00.418 | INFO     | trainer:train_loop:182 - Epoch: [94/ 100] | Train loss: [0.0462980409860611]
2023-06-06 19:01:28.477 | INFO     | trainer:train_loop:182 - Epoch: [95/ 100] | Train loss: [0.04436096441745758]
2023-06-06 19:06:54.480 | INFO     | trainer:train_loop:182 - Epoch: [96/ 100] | Train loss: [0.044775258123874666]
2023-06-06 19:12:18.576 | INFO     | trainer:train_loop:182 - Epoch: [97/ 100] | Train loss: [0.0427330150604248]
2023-06-06 19:17:43.073 | INFO     | trainer:train_loop:182 - Epoch: [98/ 100] | Train loss: [0.044403702914714814]
2023-06-06 19:23:06.140 | INFO     | trainer:train_loop:182 - Epoch: [99/ 100] | Train loss: [0.043990443125367165]
2023-06-06 19:28:30.344 | INFO     | trainer:train_loop:182 - Epoch: [100/ 100] | Train loss: [0.042813689693808554]
2023-06-06 19:28:31.230 | INFO     | trainer:train_loop:203 - [Saving Snapshot:]/root/neo_code_reco_mb/configs/checkpoint0606/MiT-B3-FaPNHead_100.pth
2023-06-06 19:28:31.231 | INFO     | trainer:train_loop:212 - Training cost: 32614.991399809718seconds
