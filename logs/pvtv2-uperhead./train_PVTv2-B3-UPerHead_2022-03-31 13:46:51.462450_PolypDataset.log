2022-03-31 13:46:51.464 | INFO     | __main__:main:45 - Load config from configs/pvtv2-uperhead.yaml
2022-03-31 13:46:51.464 | INFO     | __main__:main:46 - {'dataset': {'data_path': '/home/admin_mcn/hungpv/polyps/dataset/KCECE', 'train_data_path': ['/home/admin_mcn/hungpv/polyps/dataset/KCECE/TrainDataset'], 'test_data_path': ['/home/admin_mcn/hungpv/polyps/dataset/KCECE/TestDataset/Kvasir'], 'val_data_path': ['/home/admin_mcn/hungpv/polyps/dataset/KCECE/TestDataset/CVC-300']}, 'model': {'num_classes': 1, 'save_dir': '/mnt/data/hungpv/polyps/checkpoint/KCECE/pvtv2-uperhead_v13', 'backbone': 'PVTv2-B3', 'head': 'UPerHead', 'pretrained': '/mnt/data/hungpv/polyps/pretrained-backbone/pvt_v2_b3.pth'}, 'optimizer': {'name': 'adam', 'lr': 0.0001, 'clip': 0.5, 'scheduler': 'cosine_warmup', 'loss': 'structure_loss'}, 'dev': 'cuda', 'train': {'start_from': 0, 'save_from': 78, 'num_epochs': 80, 'num_warmup_epoch': 10, 'is_val': False, 'size_rates': [0.75, 1, 1.25], 'dataloader': {'batchsize': 16, 'img_size': 352, 'shuffle': True, 'num_workers': 2, 'pin_memory': True, 'drop_last': True}, 'amp': False, 'ddp': False, 'augment': {'prob': 1, 'Flip_prob': 0.7, 'HueSaturationValue_prob': 0.7, 'RandomBrightnessContrast_prob': 0.5, 'crop_prob': 0.0, 'randomrotate90_prob': 0.7}}, 'test': {'dev': 'cuda', 'visualize': False, 'visualize_dir': '/mnt/data/hungpv/polyps/visualize', 'vis_x': 180, 'vis_overwrite': False, 'checkpoint_dir': '/mnt/data/hungpv/polyps/checkpoint/KCECE/pvtv2-uperhead_v14/PVTv2-B3-UPerHead_80.pth', 'dataloader': {'batchsize': 1, 'img_size': 352, 'shuffle': True, 'num_workers': 2, 'pin_memory': True, 'drop_last': True}, 'augment': {'prob': 1, 'Flip_prob': 0, 'HueSaturationValue_prob': 0, 'RandomBrightnessContrast_prob': 0, 'crop_prob': 0, 'randomrotate90_prob': 0, 'elastictransform_prob': 0, 'gridistortion_prob': 0, 'opticaldistortion_prob': 0, 'verticalflip_prob': 0, 'horizontalflip_prob': 0, 'randomgamma_prob': 0, 'CoarseDropout_prob': 0, 'RGBShift_prob': 0, 'MotionBlur_prob': 0, 'MedianBlur_prob': 0, 'GaussianBlur_prob': 0, 'GaussNoise_prob': 0, 'ChannelShuffle_prob': 0}}}
2022-03-31 13:46:51.464 | INFO     | __main__:main:47 - Getting datapath
2022-03-31 13:46:51.470 | INFO     | __main__:main:61 - There are 1450 images to train
2022-03-31 13:46:51.470 | INFO     | __main__:main:80 - Train model with no valid dataset
2022-03-31 13:46:51.470 | INFO     | __main__:main:82 - Loading data
2022-03-31 13:46:51.564 | INFO     | __main__:main:96 - 90 batches to train
2022-03-31 13:46:51.568 | INFO     | __main__:main:109 - Loading model
2022-03-31 13:46:51.568 | INFO     | __main__:main:126 - Loading checkpoint from /mnt/data/hungpv/polyps/pretrained-backbone/pvt_v2_b3.pth ...
2022-03-31 13:46:54.113 | INFO     | __main__:main:164 - Training with FP32 ...
2022-03-31 13:51:00.725 | INFO     | tools.trainer:train_loop:89 - Epoch: [1/ 80] | Train loss: [2.7225042157702974]
2022-03-31 13:55:21.524 | INFO     | tools.trainer:train_loop:89 - Epoch: [2/ 80] | Train loss: [0.7749398996432623]
2022-03-31 13:59:49.118 | INFO     | tools.trainer:train_loop:89 - Epoch: [3/ 80] | Train loss: [0.5717606438530816]
2022-03-31 13:59:49.323 | INFO     | tools.trainer:train_loop:104 - [Saving Snapshot:]/mnt/data/hungpv/polyps/checkpoint/KCECE/pvtv2-uperhead_v13/PVTv2-B3-UPerHead_3.pth
2022-03-31 14:04:19.325 | INFO     | tools.trainer:train_loop:89 - Epoch: [4/ 80] | Train loss: [0.4507773197359509]
2022-03-31 14:08:53.273 | INFO     | tools.trainer:train_loop:89 - Epoch: [5/ 80] | Train loss: [0.38290669206115935]
2022-03-31 14:13:29.703 | INFO     | tools.trainer:train_loop:89 - Epoch: [6/ 80] | Train loss: [0.33715252826611203]
2022-03-31 14:18:04.691 | INFO     | tools.trainer:train_loop:89 - Epoch: [7/ 80] | Train loss: [0.28751437067985536]
2022-03-31 14:22:40.995 | INFO     | tools.trainer:train_loop:89 - Epoch: [8/ 80] | Train loss: [0.2627290866441197]
2022-03-31 14:27:17.922 | INFO     | tools.trainer:train_loop:89 - Epoch: [9/ 80] | Train loss: [0.24405509895748562]
2022-03-31 14:31:57.075 | INFO     | tools.trainer:train_loop:89 - Epoch: [10/ 80] | Train loss: [0.2256038693918122]
2022-03-31 14:36:36.548 | INFO     | tools.trainer:train_loop:89 - Epoch: [11/ 80] | Train loss: [0.2149373475048277]
2022-03-31 14:41:17.463 | INFO     | tools.trainer:train_loop:89 - Epoch: [12/ 80] | Train loss: [0.20863036049736872]
2022-03-31 14:45:57.293 | INFO     | tools.trainer:train_loop:89 - Epoch: [13/ 80] | Train loss: [0.2049082514312532]
2022-03-31 14:50:36.934 | INFO     | tools.trainer:train_loop:89 - Epoch: [14/ 80] | Train loss: [0.19342193984323078]
2022-03-31 14:55:17.310 | INFO     | tools.trainer:train_loop:89 - Epoch: [15/ 80] | Train loss: [0.17524816277954314]
2022-03-31 14:59:59.100 | INFO     | tools.trainer:train_loop:89 - Epoch: [16/ 80] | Train loss: [0.18515235715442233]
2022-03-31 15:04:42.061 | INFO     | tools.trainer:train_loop:89 - Epoch: [17/ 80] | Train loss: [0.1802943930029869]
2022-03-31 15:09:25.233 | INFO     | tools.trainer:train_loop:89 - Epoch: [18/ 80] | Train loss: [0.16759260495503744]
2022-03-31 15:14:08.703 | INFO     | tools.trainer:train_loop:89 - Epoch: [19/ 80] | Train loss: [0.1631045800116327]
2022-03-31 15:18:51.736 | INFO     | tools.trainer:train_loop:89 - Epoch: [20/ 80] | Train loss: [0.15799055993556976]
2022-03-31 15:23:32.499 | INFO     | tools.trainer:train_loop:89 - Epoch: [21/ 80] | Train loss: [0.14902965741025076]
2022-03-31 15:28:14.208 | INFO     | tools.trainer:train_loop:89 - Epoch: [22/ 80] | Train loss: [0.14449269531501663]
2022-03-31 15:32:56.842 | INFO     | tools.trainer:train_loop:89 - Epoch: [23/ 80] | Train loss: [0.1454269086321195]
2022-03-31 15:37:36.544 | INFO     | tools.trainer:train_loop:89 - Epoch: [24/ 80] | Train loss: [0.15073547661304473]
2022-03-31 15:42:15.761 | INFO     | tools.trainer:train_loop:89 - Epoch: [25/ 80] | Train loss: [0.14875706359744073]
2022-03-31 15:46:56.667 | INFO     | tools.trainer:train_loop:89 - Epoch: [26/ 80] | Train loss: [0.13761367806129984]
2022-03-31 15:51:34.926 | INFO     | tools.trainer:train_loop:89 - Epoch: [27/ 80] | Train loss: [0.13382767621013852]
2022-03-31 15:56:14.934 | INFO     | tools.trainer:train_loop:89 - Epoch: [28/ 80] | Train loss: [0.13475484318203396]
2022-03-31 16:00:55.822 | INFO     | tools.trainer:train_loop:89 - Epoch: [29/ 80] | Train loss: [0.13356357051266565]
2022-03-31 16:05:38.829 | INFO     | tools.trainer:train_loop:89 - Epoch: [30/ 80] | Train loss: [0.13131638798448775]
2022-03-31 16:10:21.658 | INFO     | tools.trainer:train_loop:89 - Epoch: [31/ 80] | Train loss: [0.12433135302530395]
2022-03-31 16:15:06.944 | INFO     | tools.trainer:train_loop:89 - Epoch: [32/ 80] | Train loss: [0.12339527226156659]
2022-03-31 16:19:51.963 | INFO     | tools.trainer:train_loop:89 - Epoch: [33/ 80] | Train loss: [0.1161245788137118]
2022-03-31 16:24:36.183 | INFO     | tools.trainer:train_loop:89 - Epoch: [34/ 80] | Train loss: [0.11607721679740482]
2022-03-31 16:29:21.921 | INFO     | tools.trainer:train_loop:89 - Epoch: [35/ 80] | Train loss: [0.11938697430822584]
2022-03-31 16:34:06.102 | INFO     | tools.trainer:train_loop:89 - Epoch: [36/ 80] | Train loss: [0.12506270706653594]
2022-03-31 16:38:51.124 | INFO     | tools.trainer:train_loop:89 - Epoch: [37/ 80] | Train loss: [0.11504312041733]
2022-03-31 16:43:36.472 | INFO     | tools.trainer:train_loop:89 - Epoch: [38/ 80] | Train loss: [0.10861086183124119]
2022-03-31 16:48:22.902 | INFO     | tools.trainer:train_loop:89 - Epoch: [39/ 80] | Train loss: [0.10895383788479698]
2022-03-31 16:53:07.934 | INFO     | tools.trainer:train_loop:89 - Epoch: [40/ 80] | Train loss: [0.10383512907558018]
2022-03-31 16:57:52.977 | INFO     | tools.trainer:train_loop:89 - Epoch: [41/ 80] | Train loss: [0.10984807163476944]
2022-03-31 17:02:36.792 | INFO     | tools.trainer:train_loop:89 - Epoch: [42/ 80] | Train loss: [0.10985218816333348]
2022-03-31 17:07:22.702 | INFO     | tools.trainer:train_loop:89 - Epoch: [43/ 80] | Train loss: [0.10628994877139727]
2022-03-31 17:12:08.211 | INFO     | tools.trainer:train_loop:89 - Epoch: [44/ 80] | Train loss: [0.10749448960026105]
2022-03-31 17:16:50.592 | INFO     | tools.trainer:train_loop:89 - Epoch: [45/ 80] | Train loss: [0.10325517944163747]
2022-03-31 17:21:30.892 | INFO     | tools.trainer:train_loop:89 - Epoch: [46/ 80] | Train loss: [0.09882341192828284]
2022-03-31 17:26:11.334 | INFO     | tools.trainer:train_loop:89 - Epoch: [47/ 80] | Train loss: [0.09568162941270404]
2022-03-31 17:30:50.992 | INFO     | tools.trainer:train_loop:89 - Epoch: [48/ 80] | Train loss: [0.09560439479019907]
2022-03-31 17:35:30.679 | INFO     | tools.trainer:train_loop:89 - Epoch: [49/ 80] | Train loss: [0.09304815563890668]
2022-03-31 17:40:09.823 | INFO     | tools.trainer:train_loop:89 - Epoch: [50/ 80] | Train loss: [0.09100478597813183]
2022-03-31 17:44:49.319 | INFO     | tools.trainer:train_loop:89 - Epoch: [51/ 80] | Train loss: [0.09021471333172586]
2022-03-31 17:49:26.643 | INFO     | tools.trainer:train_loop:89 - Epoch: [52/ 80] | Train loss: [0.0901553207801448]
2022-03-31 17:54:08.053 | INFO     | tools.trainer:train_loop:89 - Epoch: [53/ 80] | Train loss: [0.0884158151017295]
2022-03-31 17:58:48.535 | INFO     | tools.trainer:train_loop:89 - Epoch: [54/ 80] | Train loss: [0.08785784774356419]
2022-03-31 18:03:28.876 | INFO     | tools.trainer:train_loop:89 - Epoch: [55/ 80] | Train loss: [0.0864536358250512]
2022-03-31 18:08:07.748 | INFO     | tools.trainer:train_loop:89 - Epoch: [56/ 80] | Train loss: [0.08658115698231592]
2022-03-31 18:12:47.674 | INFO     | tools.trainer:train_loop:89 - Epoch: [57/ 80] | Train loss: [0.08903349563479424]
2022-03-31 18:17:27.013 | INFO     | tools.trainer:train_loop:89 - Epoch: [58/ 80] | Train loss: [0.08611830150087675]
2022-03-31 18:22:05.080 | INFO     | tools.trainer:train_loop:89 - Epoch: [59/ 80] | Train loss: [0.08368575655751759]
2022-03-31 18:26:45.180 | INFO     | tools.trainer:train_loop:89 - Epoch: [60/ 80] | Train loss: [0.08372060904900233]
2022-03-31 18:31:25.434 | INFO     | tools.trainer:train_loop:89 - Epoch: [61/ 80] | Train loss: [0.08188975002202722]
2022-03-31 18:36:04.298 | INFO     | tools.trainer:train_loop:89 - Epoch: [62/ 80] | Train loss: [0.07949560375677214]
2022-03-31 18:40:41.650 | INFO     | tools.trainer:train_loop:89 - Epoch: [63/ 80] | Train loss: [0.0784383765525288]
2022-03-31 18:45:21.672 | INFO     | tools.trainer:train_loop:89 - Epoch: [64/ 80] | Train loss: [0.07803046132127443]
2022-03-31 18:50:00.484 | INFO     | tools.trainer:train_loop:89 - Epoch: [65/ 80] | Train loss: [0.07736815876430936]
2022-03-31 18:54:34.452 | INFO     | tools.trainer:train_loop:89 - Epoch: [66/ 80] | Train loss: [0.07580523764093718]
2022-03-31 18:58:40.502 | INFO     | tools.trainer:train_loop:89 - Epoch: [67/ 80] | Train loss: [0.07659291310442819]
2022-03-31 19:02:41.419 | INFO     | tools.trainer:train_loop:89 - Epoch: [68/ 80] | Train loss: [0.07600461882021692]
2022-03-31 19:06:41.065 | INFO     | tools.trainer:train_loop:89 - Epoch: [69/ 80] | Train loss: [0.074495094600651]
2022-03-31 19:10:41.458 | INFO     | tools.trainer:train_loop:89 - Epoch: [70/ 80] | Train loss: [0.07438130701581637]
2022-03-31 19:14:41.393 | INFO     | tools.trainer:train_loop:89 - Epoch: [71/ 80] | Train loss: [0.07485165111720563]
2022-03-31 19:18:40.840 | INFO     | tools.trainer:train_loop:89 - Epoch: [72/ 80] | Train loss: [0.07278687941531341]
2022-03-31 19:22:40.122 | INFO     | tools.trainer:train_loop:89 - Epoch: [73/ 80] | Train loss: [0.07254548743367195]
2022-03-31 19:26:38.994 | INFO     | tools.trainer:train_loop:89 - Epoch: [74/ 80] | Train loss: [0.07167358634372552]
2022-03-31 19:30:37.983 | INFO     | tools.trainer:train_loop:89 - Epoch: [75/ 80] | Train loss: [0.07060318411224419]
2022-03-31 19:34:36.616 | INFO     | tools.trainer:train_loop:89 - Epoch: [76/ 80] | Train loss: [0.06952039918137921]
2022-03-31 19:38:35.694 | INFO     | tools.trainer:train_loop:89 - Epoch: [77/ 80] | Train loss: [0.07009743485185835]
2022-03-31 19:42:34.462 | INFO     | tools.trainer:train_loop:89 - Epoch: [78/ 80] | Train loss: [0.06974659458630615]
2022-03-31 19:46:33.193 | INFO     | tools.trainer:train_loop:89 - Epoch: [79/ 80] | Train loss: [0.06974377897050646]
2022-03-31 19:46:33.395 | INFO     | tools.trainer:train_loop:104 - [Saving Snapshot:]/mnt/data/hungpv/polyps/checkpoint/KCECE/pvtv2-uperhead_v13/PVTv2-B3-UPerHead_79.pth
2022-03-31 19:50:32.127 | INFO     | tools.trainer:train_loop:89 - Epoch: [80/ 80] | Train loss: [0.068814059967796]
2022-03-31 19:50:32.328 | INFO     | tools.trainer:train_loop:104 - [Saving Snapshot:]/mnt/data/hungpv/polyps/checkpoint/KCECE/pvtv2-uperhead_v13/PVTv2-B3-UPerHead_80.pth
2022-03-31 19:50:32.329 | INFO     | tools.trainer:train_loop:110 - Training cost: 21817.197106128006seconds
