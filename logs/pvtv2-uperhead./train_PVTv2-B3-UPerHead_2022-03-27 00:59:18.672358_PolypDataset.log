2022-03-27 00:59:18.674 | INFO     | __main__:main:45 - Load config from configs/pvtv2-uperhead.yaml
2022-03-27 00:59:18.674 | INFO     | __main__:main:46 - {'dataset': {'data_path': '/home/admin_mcn/hungpv/polyps/dataset/KCECE', 'train_data_path': ['/home/admin_mcn/hungpv/polyps/dataset/KCECE/TrainDataset'], 'test_data_path': ['/home/admin_mcn/hungpv/polyps/dataset/KCECE/TestDataset/Kvasir'], 'val_data_path': ['/home/admin_mcn/hungpv/polyps/dataset/KCECE/TestDataset/CVC-300']}, 'model': {'num_classes': 1, 'save_dir': '/mnt/data/hungpv/polyps/checkpoint/KCECE/pvtv2-uperhead_v8', 'backbone': 'PVTv2-B3', 'head': 'UPerHead', 'pretrained': '/mnt/data/hungpv/polyps/pretrained-backbone/pvt_v2_b3.pth'}, 'optimizer': {'name': 'adam', 'lr': 0.0001, 'clip': 0.5, 'scheduler': 'cosine_warmup', 'num_warmup_epoch': 1, 'loss': 'structure_loss'}, 'dev': 'cuda', 'train': {'start_from': 0, 'save_from': 78, 'num_epochs': 80, 'num_warmup_epoch': 8, 'is_val': False, 'size_rates': [0.75, 1, 1.25], 'dataloader': {'batchsize': 16, 'img_size': 352, 'shuffle': True, 'num_workers': 2, 'pin_memory': True, 'drop_last': True}, 'amp': False, 'ddp': False, 'augment': {'prob': 1, 'Flip_prob': 0.7, 'HueSaturationValue_prob': 0.7, 'RandomBrightnessContrast_prob': 0.5, 'crop_prob': 0.2, 'randomrotate90_prob': 0.7}}, 'test': {'dev': 'cuda', 'visualize': False, 'visualize_dir': '/mnt/data/hungpv/polyps/visualize', 'vis_x': 180, 'vis_overwrite': False, 'checkpoint_dir': '/mnt/data/hungpv/polyps/checkpoint/KCECE/pvtv2-uperhead_v7/PVTv2-B3-UPerHead_100.pth', 'dataloader': {'batchsize': 1, 'img_size': 352, 'shuffle': True, 'num_workers': 2, 'pin_memory': True, 'drop_last': True}, 'augment': {'prob': 1, 'Flip_prob': 0, 'HueSaturationValue_prob': 0, 'RandomBrightnessContrast_prob': 0, 'crop_prob': 0, 'randomrotate90_prob': 0, 'elastictransform_prob': 0, 'gridistortion_prob': 0, 'opticaldistortion_prob': 0, 'verticalflip_prob': 0, 'horizontalflip_prob': 0, 'randomgamma_prob': 0, 'CoarseDropout_prob': 0, 'RGBShift_prob': 0, 'MotionBlur_prob': 0, 'MedianBlur_prob': 0, 'GaussianBlur_prob': 0, 'GaussNoise_prob': 0, 'ChannelShuffle_prob': 0}}}
2022-03-27 00:59:18.674 | INFO     | __main__:main:47 - Getting datapath
2022-03-27 00:59:18.680 | INFO     | __main__:main:61 - There are 1450 images to train
2022-03-27 00:59:18.680 | INFO     | __main__:main:80 - Train model with no valid dataset
2022-03-27 00:59:18.680 | INFO     | __main__:main:82 - Loading data
2022-03-27 00:59:18.767 | INFO     | __main__:main:96 - 90 batches to train
2022-03-27 00:59:18.771 | INFO     | __main__:main:109 - Loading model
2022-03-27 00:59:18.771 | INFO     | __main__:main:126 - Loading checkpoint from /mnt/data/hungpv/polyps/pretrained-backbone/pvt_v2_b3.pth ...
2022-03-27 00:59:21.244 | INFO     | __main__:main:164 - Training with FP32 ...
2022-03-27 01:03:15.387 | INFO     | tools.trainer:train_loop:89 - Epoch: [1/ 80] | Train loss: [1.3493766917122736]
2022-03-27 01:07:09.609 | INFO     | tools.trainer:train_loop:89 - Epoch: [2/ 80] | Train loss: [0.7591119643714693]
2022-03-27 01:11:04.632 | INFO     | tools.trainer:train_loop:89 - Epoch: [3/ 80] | Train loss: [0.5549246397283342]
2022-03-27 01:11:04.838 | INFO     | tools.trainer:train_loop:104 - [Saving Snapshot:]/mnt/data/hungpv/polyps/checkpoint/KCECE/pvtv2-uperhead_v8/PVTv2-B3-UPerHead_3.pth
2022-03-27 01:15:00.089 | INFO     | tools.trainer:train_loop:89 - Epoch: [4/ 80] | Train loss: [0.4475342545244429]
2022-03-27 01:18:55.175 | INFO     | tools.trainer:train_loop:89 - Epoch: [5/ 80] | Train loss: [0.3628140608469645]
2022-03-27 01:22:50.435 | INFO     | tools.trainer:train_loop:89 - Epoch: [6/ 80] | Train loss: [0.3450325189365281]
2022-03-27 01:26:45.334 | INFO     | tools.trainer:train_loop:89 - Epoch: [7/ 80] | Train loss: [0.2960453081462118]
2022-03-27 01:30:40.471 | INFO     | tools.trainer:train_loop:89 - Epoch: [8/ 80] | Train loss: [0.28156802455584207]
2022-03-27 01:34:35.784 | INFO     | tools.trainer:train_loop:89 - Epoch: [9/ 80] | Train loss: [0.2900262069371011]
2022-03-27 01:38:31.133 | INFO     | tools.trainer:train_loop:89 - Epoch: [10/ 80] | Train loss: [0.25982319563627243]
2022-03-27 01:42:26.608 | INFO     | tools.trainer:train_loop:89 - Epoch: [11/ 80] | Train loss: [0.23666339814662934]
2022-03-27 01:46:21.498 | INFO     | tools.trainer:train_loop:89 - Epoch: [12/ 80] | Train loss: [0.23850630389319527]
2022-03-27 01:50:16.674 | INFO     | tools.trainer:train_loop:89 - Epoch: [13/ 80] | Train loss: [0.23882751382059522]
2022-03-27 01:54:12.009 | INFO     | tools.trainer:train_loop:89 - Epoch: [14/ 80] | Train loss: [0.2375006056494183]
2022-03-27 01:58:07.666 | INFO     | tools.trainer:train_loop:89 - Epoch: [15/ 80] | Train loss: [0.21393137640423246]
2022-03-27 02:02:03.292 | INFO     | tools.trainer:train_loop:89 - Epoch: [16/ 80] | Train loss: [0.21590809722741444]
2022-03-27 02:05:59.028 | INFO     | tools.trainer:train_loop:89 - Epoch: [17/ 80] | Train loss: [0.2102733689877722]
2022-03-27 02:09:54.785 | INFO     | tools.trainer:train_loop:89 - Epoch: [18/ 80] | Train loss: [0.21043498425020113]
2022-03-27 02:13:50.567 | INFO     | tools.trainer:train_loop:89 - Epoch: [19/ 80] | Train loss: [0.2019842252963119]
2022-03-27 02:17:46.245 | INFO     | tools.trainer:train_loop:89 - Epoch: [20/ 80] | Train loss: [0.206064435839653]
2022-03-27 02:21:41.742 | INFO     | tools.trainer:train_loop:89 - Epoch: [21/ 80] | Train loss: [0.18849695689148374]
2022-03-27 02:25:37.200 | INFO     | tools.trainer:train_loop:89 - Epoch: [22/ 80] | Train loss: [0.2083417951232857]
2022-03-27 02:29:32.626 | INFO     | tools.trainer:train_loop:89 - Epoch: [23/ 80] | Train loss: [0.19028001775344214]
2022-03-27 02:33:27.844 | INFO     | tools.trainer:train_loop:89 - Epoch: [24/ 80] | Train loss: [0.18647680737906033]
2022-03-27 02:37:23.429 | INFO     | tools.trainer:train_loop:89 - Epoch: [25/ 80] | Train loss: [0.18313530824250646]
2022-03-27 02:41:19.614 | INFO     | tools.trainer:train_loop:89 - Epoch: [26/ 80] | Train loss: [0.18094746644298235]
2022-03-27 02:45:15.144 | INFO     | tools.trainer:train_loop:89 - Epoch: [27/ 80] | Train loss: [0.1717995865477456]
2022-03-27 02:49:10.882 | INFO     | tools.trainer:train_loop:89 - Epoch: [28/ 80] | Train loss: [0.18055924442079332]
2022-03-27 02:53:06.332 | INFO     | tools.trainer:train_loop:89 - Epoch: [29/ 80] | Train loss: [0.1745674932996432]
2022-03-27 02:57:01.916 | INFO     | tools.trainer:train_loop:89 - Epoch: [30/ 80] | Train loss: [0.17258828745947943]
2022-03-27 03:00:57.570 | INFO     | tools.trainer:train_loop:89 - Epoch: [31/ 80] | Train loss: [0.17246238787968954]
2022-03-27 03:04:53.317 | INFO     | tools.trainer:train_loop:89 - Epoch: [32/ 80] | Train loss: [0.16029928119646178]
2022-03-27 03:08:49.246 | INFO     | tools.trainer:train_loop:89 - Epoch: [33/ 80] | Train loss: [0.1729797604183356]
2022-03-27 03:12:44.784 | INFO     | tools.trainer:train_loop:89 - Epoch: [34/ 80] | Train loss: [0.1641906987461779]
2022-03-27 03:16:40.432 | INFO     | tools.trainer:train_loop:89 - Epoch: [35/ 80] | Train loss: [0.14857213902804586]
2022-03-27 03:20:35.930 | INFO     | tools.trainer:train_loop:89 - Epoch: [36/ 80] | Train loss: [0.1679556963344415]
2022-03-27 03:24:31.518 | INFO     | tools.trainer:train_loop:89 - Epoch: [37/ 80] | Train loss: [0.15250641115837626]
2022-03-27 03:28:26.831 | INFO     | tools.trainer:train_loop:89 - Epoch: [38/ 80] | Train loss: [0.1508239792452918]
2022-03-27 03:32:22.276 | INFO     | tools.trainer:train_loop:89 - Epoch: [39/ 80] | Train loss: [0.15595026156968542]
2022-03-27 03:36:17.859 | INFO     | tools.trainer:train_loop:89 - Epoch: [40/ 80] | Train loss: [0.15521043058898715]
2022-03-27 03:40:13.282 | INFO     | tools.trainer:train_loop:89 - Epoch: [41/ 80] | Train loss: [0.15696866421235933]
2022-03-27 03:44:08.779 | INFO     | tools.trainer:train_loop:89 - Epoch: [42/ 80] | Train loss: [0.14555397174424595]
2022-03-27 03:48:04.118 | INFO     | tools.trainer:train_loop:89 - Epoch: [43/ 80] | Train loss: [0.14268604094783466]
2022-03-27 03:52:00.070 | INFO     | tools.trainer:train_loop:89 - Epoch: [44/ 80] | Train loss: [0.16171271113885774]
2022-03-27 03:55:55.775 | INFO     | tools.trainer:train_loop:89 - Epoch: [45/ 80] | Train loss: [0.14350904309087328]
2022-03-27 03:59:51.093 | INFO     | tools.trainer:train_loop:89 - Epoch: [46/ 80] | Train loss: [0.1403045235408677]
2022-03-27 04:03:46.697 | INFO     | tools.trainer:train_loop:89 - Epoch: [47/ 80] | Train loss: [0.13946083047323757]
2022-03-27 04:07:42.226 | INFO     | tools.trainer:train_loop:89 - Epoch: [48/ 80] | Train loss: [0.1317504609624545]
2022-03-27 04:11:37.579 | INFO     | tools.trainer:train_loop:89 - Epoch: [49/ 80] | Train loss: [0.13363174456689092]
2022-03-27 04:15:33.031 | INFO     | tools.trainer:train_loop:89 - Epoch: [50/ 80] | Train loss: [0.14103690112630526]
2022-03-27 04:19:28.239 | INFO     | tools.trainer:train_loop:89 - Epoch: [51/ 80] | Train loss: [0.1379067617158095]
2022-03-27 04:23:23.796 | INFO     | tools.trainer:train_loop:89 - Epoch: [52/ 80] | Train loss: [0.1252098099225097]
2022-03-27 04:27:19.434 | INFO     | tools.trainer:train_loop:89 - Epoch: [53/ 80] | Train loss: [0.12279502815670437]
2022-03-27 04:31:14.956 | INFO     | tools.trainer:train_loop:89 - Epoch: [54/ 80] | Train loss: [0.1384170746637715]
2022-03-27 04:35:10.576 | INFO     | tools.trainer:train_loop:89 - Epoch: [55/ 80] | Train loss: [0.1369071605304877]
2022-03-27 04:39:06.112 | INFO     | tools.trainer:train_loop:89 - Epoch: [56/ 80] | Train loss: [0.13341179763277372]
2022-03-27 04:43:01.926 | INFO     | tools.trainer:train_loop:89 - Epoch: [57/ 80] | Train loss: [0.12502819125850995]
2022-03-27 04:46:58.072 | INFO     | tools.trainer:train_loop:89 - Epoch: [58/ 80] | Train loss: [0.13488926672273213]
2022-03-27 04:50:53.760 | INFO     | tools.trainer:train_loop:89 - Epoch: [59/ 80] | Train loss: [0.1325317876206504]
2022-03-27 04:54:48.739 | INFO     | tools.trainer:train_loop:89 - Epoch: [60/ 80] | Train loss: [0.13137494424978893]
2022-03-27 04:58:44.115 | INFO     | tools.trainer:train_loop:89 - Epoch: [61/ 80] | Train loss: [0.13090792356265915]
2022-03-27 05:02:39.585 | INFO     | tools.trainer:train_loop:89 - Epoch: [62/ 80] | Train loss: [0.12395075228479173]
2022-03-27 05:06:35.698 | INFO     | tools.trainer:train_loop:89 - Epoch: [63/ 80] | Train loss: [0.11676104846927855]
2022-03-27 05:10:31.118 | INFO     | tools.trainer:train_loop:89 - Epoch: [64/ 80] | Train loss: [0.12103391422165764]
2022-03-27 05:14:26.669 | INFO     | tools.trainer:train_loop:89 - Epoch: [65/ 80] | Train loss: [0.11067893836233351]
2022-03-27 05:18:22.139 | INFO     | tools.trainer:train_loop:89 - Epoch: [66/ 80] | Train loss: [0.11468808369504081]
2022-03-27 05:22:17.541 | INFO     | tools.trainer:train_loop:89 - Epoch: [67/ 80] | Train loss: [0.11729348566797045]
2022-03-27 05:26:13.019 | INFO     | tools.trainer:train_loop:89 - Epoch: [68/ 80] | Train loss: [0.11029920801520347]
2022-03-27 05:30:08.533 | INFO     | tools.trainer:train_loop:89 - Epoch: [69/ 80] | Train loss: [0.11891622617840766]
2022-03-27 05:34:03.730 | INFO     | tools.trainer:train_loop:89 - Epoch: [70/ 80] | Train loss: [0.11476585194468499]
2022-03-27 05:37:58.897 | INFO     | tools.trainer:train_loop:89 - Epoch: [71/ 80] | Train loss: [0.11598615638083881]
2022-03-27 05:41:53.880 | INFO     | tools.trainer:train_loop:89 - Epoch: [72/ 80] | Train loss: [0.11449925220674939]
2022-03-27 05:45:49.343 | INFO     | tools.trainer:train_loop:89 - Epoch: [73/ 80] | Train loss: [0.11027662224239773]
2022-03-27 05:49:44.864 | INFO     | tools.trainer:train_loop:89 - Epoch: [74/ 80] | Train loss: [0.10957156990965207]
2022-03-27 05:53:40.439 | INFO     | tools.trainer:train_loop:89 - Epoch: [75/ 80] | Train loss: [0.11819386978944142]
2022-03-27 05:57:35.813 | INFO     | tools.trainer:train_loop:89 - Epoch: [76/ 80] | Train loss: [0.11113114265931977]
2022-03-27 06:01:31.348 | INFO     | tools.trainer:train_loop:89 - Epoch: [77/ 80] | Train loss: [0.10984808512859874]
2022-03-27 06:05:27.122 | INFO     | tools.trainer:train_loop:89 - Epoch: [78/ 80] | Train loss: [0.11293742209672927]
2022-03-27 06:09:22.644 | INFO     | tools.trainer:train_loop:89 - Epoch: [79/ 80] | Train loss: [0.10571148660447863]
2022-03-27 06:09:22.843 | INFO     | tools.trainer:train_loop:104 - [Saving Snapshot:]/mnt/data/hungpv/polyps/checkpoint/KCECE/pvtv2-uperhead_v8/PVTv2-B3-UPerHead_79.pth
2022-03-27 06:13:18.391 | INFO     | tools.trainer:train_loop:89 - Epoch: [80/ 80] | Train loss: [0.1154470570385456]
2022-03-27 06:13:18.591 | INFO     | tools.trainer:train_loop:104 - [Saving Snapshot:]/mnt/data/hungpv/polyps/checkpoint/KCECE/pvtv2-uperhead_v8/PVTv2-B3-UPerHead_80.pth
2022-03-27 06:13:18.591 | INFO     | tools.trainer:train_loop:110 - Training cost: 18836.369864262seconds
