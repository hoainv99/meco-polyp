2022-03-30 12:28:20.521 | INFO     | __main__:main:45 - Load config from configs/pvtv2-uperhead.yaml
2022-03-30 12:28:20.521 | INFO     | __main__:main:46 - {'dataset': {'data_path': '/home/admin_mcn/hungpv/polyps/dataset/KCECE', 'train_data_path': ['/home/admin_mcn/hungpv/polyps/dataset/KCECE/TrainDataset'], 'test_data_path': ['/home/admin_mcn/hungpv/polyps/dataset/KCECE/TestDataset/Kvasir'], 'val_data_path': ['/home/admin_mcn/hungpv/polyps/dataset/KCECE/TestDataset/CVC-300']}, 'model': {'num_classes': 1, 'save_dir': '/mnt/data/hungpv/polyps/checkpoint/KCECE/pvtv2-uperhead_v11', 'backbone': 'PVTv2-B3', 'head': 'UPerHead', 'pretrained': '/mnt/data/hungpv/polyps/pretrained-backbone/pvt_v2_b3.pth'}, 'optimizer': {'name': 'adam', 'lr': 0.0001, 'clip': 0.5, 'scheduler': 'cosine_warmup', 'loss': 'structure_loss'}, 'dev': 'cuda', 'train': {'start_from': 0, 'save_from': 78, 'num_epochs': 80, 'num_warmup_epoch': 10, 'is_val': False, 'size_rates': [0.75, 1, 1.25], 'dataloader': {'batchsize': 16, 'img_size': 352, 'shuffle': True, 'num_workers': 2, 'pin_memory': True, 'drop_last': True}, 'amp': False, 'ddp': False, 'augment': {'prob': 1, 'Flip_prob': 0.7, 'HueSaturationValue_prob': 0.7, 'RandomBrightnessContrast_prob': 0.5, 'crop_prob': 0.0, 'randomrotate90_prob': 0.7}}, 'test': {'dev': 'cuda', 'visualize': False, 'visualize_dir': '/mnt/data/hungpv/polyps/visualize', 'vis_x': 180, 'vis_overwrite': False, 'checkpoint_dir': '/mnt/data/hungpv/polyps/checkpoint/KCECE/pvtv2-uperhead_v10/PVTv2-B3-UPerHead_80.pth', 'dataloader': {'batchsize': 1, 'img_size': 352, 'shuffle': True, 'num_workers': 2, 'pin_memory': True, 'drop_last': True}, 'augment': {'prob': 1, 'Flip_prob': 0, 'HueSaturationValue_prob': 0, 'RandomBrightnessContrast_prob': 0, 'crop_prob': 0, 'randomrotate90_prob': 0, 'elastictransform_prob': 0, 'gridistortion_prob': 0, 'opticaldistortion_prob': 0, 'verticalflip_prob': 0, 'horizontalflip_prob': 0, 'randomgamma_prob': 0, 'CoarseDropout_prob': 0, 'RGBShift_prob': 0, 'MotionBlur_prob': 0, 'MedianBlur_prob': 0, 'GaussianBlur_prob': 0, 'GaussNoise_prob': 0, 'ChannelShuffle_prob': 0}}}
2022-03-30 12:28:20.521 | INFO     | __main__:main:47 - Getting datapath
2022-03-30 12:28:20.527 | INFO     | __main__:main:61 - There are 1450 images to train
2022-03-30 12:28:20.528 | INFO     | __main__:main:80 - Train model with no valid dataset
2022-03-30 12:28:20.528 | INFO     | __main__:main:82 - Loading data
2022-03-30 12:28:20.620 | INFO     | __main__:main:96 - 90 batches to train
2022-03-30 12:28:20.624 | INFO     | __main__:main:109 - Loading model
2022-03-30 12:28:20.624 | INFO     | __main__:main:126 - Loading checkpoint from /mnt/data/hungpv/polyps/pretrained-backbone/pvt_v2_b3.pth ...
2022-03-30 12:28:23.264 | INFO     | __main__:main:164 - Training with FP32 ...
2022-03-30 12:32:12.785 | INFO     | tools.trainer:train_loop:89 - Epoch: [1/ 80] | Train loss: [2.8735248764355976]
2022-03-30 12:36:01.300 | INFO     | tools.trainer:train_loop:89 - Epoch: [2/ 80] | Train loss: [0.7982452180650499]
2022-03-30 12:39:50.027 | INFO     | tools.trainer:train_loop:89 - Epoch: [3/ 80] | Train loss: [0.5719611664613088]
2022-03-30 12:39:50.242 | INFO     | tools.trainer:train_loop:104 - [Saving Snapshot:]/mnt/data/hungpv/polyps/checkpoint/KCECE/pvtv2-uperhead_v11/PVTv2-B3-UPerHead_3.pth
2022-03-30 12:43:38.925 | INFO     | tools.trainer:train_loop:89 - Epoch: [4/ 80] | Train loss: [0.4597408301300473]
2022-03-30 12:47:27.802 | INFO     | tools.trainer:train_loop:89 - Epoch: [5/ 80] | Train loss: [0.401366944776641]
2022-03-30 12:51:16.508 | INFO     | tools.trainer:train_loop:89 - Epoch: [6/ 80] | Train loss: [0.3331390958693292]
2022-03-30 12:55:05.195 | INFO     | tools.trainer:train_loop:89 - Epoch: [7/ 80] | Train loss: [0.3472876308692826]
2022-03-30 12:58:54.080 | INFO     | tools.trainer:train_loop:89 - Epoch: [8/ 80] | Train loss: [0.2964298228422801]
2022-03-30 13:02:42.892 | INFO     | tools.trainer:train_loop:89 - Epoch: [9/ 80] | Train loss: [0.2497257239288754]
2022-03-30 13:06:31.706 | INFO     | tools.trainer:train_loop:89 - Epoch: [10/ 80] | Train loss: [0.2354408880074819]
2022-03-30 13:10:20.559 | INFO     | tools.trainer:train_loop:89 - Epoch: [11/ 80] | Train loss: [0.21761923498577543]
2022-03-30 13:14:09.444 | INFO     | tools.trainer:train_loop:89 - Epoch: [12/ 80] | Train loss: [0.21985503435134887]
2022-03-30 13:17:58.219 | INFO     | tools.trainer:train_loop:89 - Epoch: [13/ 80] | Train loss: [0.2107210237118933]
2022-03-30 13:21:47.078 | INFO     | tools.trainer:train_loop:89 - Epoch: [14/ 80] | Train loss: [0.19499200292759472]
2022-03-30 13:25:35.943 | INFO     | tools.trainer:train_loop:89 - Epoch: [15/ 80] | Train loss: [0.18992863181564543]
2022-03-30 13:29:24.919 | INFO     | tools.trainer:train_loop:89 - Epoch: [16/ 80] | Train loss: [0.17856883621878095]
2022-03-30 13:33:13.578 | INFO     | tools.trainer:train_loop:89 - Epoch: [17/ 80] | Train loss: [0.1745725292298529]
2022-03-30 13:37:02.386 | INFO     | tools.trainer:train_loop:89 - Epoch: [18/ 80] | Train loss: [0.16763677290744253]
2022-03-30 13:40:51.310 | INFO     | tools.trainer:train_loop:89 - Epoch: [19/ 80] | Train loss: [0.16570650446746085]
2022-03-30 13:44:40.336 | INFO     | tools.trainer:train_loop:89 - Epoch: [20/ 80] | Train loss: [0.15432904958724974]
2022-03-30 13:48:29.094 | INFO     | tools.trainer:train_loop:89 - Epoch: [21/ 80] | Train loss: [0.1506416265335348]
2022-03-30 13:52:17.977 | INFO     | tools.trainer:train_loop:89 - Epoch: [22/ 80] | Train loss: [0.1522803941534625]
2022-03-30 13:56:06.864 | INFO     | tools.trainer:train_loop:89 - Epoch: [23/ 80] | Train loss: [0.15397366144590907]
2022-03-30 13:59:55.793 | INFO     | tools.trainer:train_loop:89 - Epoch: [24/ 80] | Train loss: [0.14397623100214535]
2022-03-30 14:03:44.808 | INFO     | tools.trainer:train_loop:89 - Epoch: [25/ 80] | Train loss: [0.1527048216925727]
2022-03-30 14:07:33.618 | INFO     | tools.trainer:train_loop:89 - Epoch: [26/ 80] | Train loss: [0.1385148192445437]
2022-03-30 14:11:22.481 | INFO     | tools.trainer:train_loop:89 - Epoch: [27/ 80] | Train loss: [0.1376649676097764]
2022-03-30 14:15:11.381 | INFO     | tools.trainer:train_loop:89 - Epoch: [28/ 80] | Train loss: [0.14013093527820375]
2022-03-30 14:19:00.316 | INFO     | tools.trainer:train_loop:89 - Epoch: [29/ 80] | Train loss: [0.13124906652503543]
2022-03-30 14:22:49.232 | INFO     | tools.trainer:train_loop:89 - Epoch: [30/ 80] | Train loss: [0.12173457195361455]
2022-03-30 14:26:38.138 | INFO     | tools.trainer:train_loop:89 - Epoch: [31/ 80] | Train loss: [0.12053661255372895]
2022-03-30 14:30:27.015 | INFO     | tools.trainer:train_loop:89 - Epoch: [32/ 80] | Train loss: [0.12098464800251854]
2022-03-30 14:34:16.013 | INFO     | tools.trainer:train_loop:89 - Epoch: [33/ 80] | Train loss: [0.12997817968328793]
2022-03-30 14:38:05.058 | INFO     | tools.trainer:train_loop:89 - Epoch: [34/ 80] | Train loss: [0.1233596275250117]
2022-03-30 14:41:53.845 | INFO     | tools.trainer:train_loop:89 - Epoch: [35/ 80] | Train loss: [0.11571510525213348]
2022-03-30 14:45:42.939 | INFO     | tools.trainer:train_loop:89 - Epoch: [36/ 80] | Train loss: [0.11366044125623173]
2022-03-30 14:49:31.885 | INFO     | tools.trainer:train_loop:89 - Epoch: [37/ 80] | Train loss: [0.11143940256701576]
2022-03-30 14:53:20.723 | INFO     | tools.trainer:train_loop:89 - Epoch: [38/ 80] | Train loss: [0.11225775207082431]
2022-03-30 14:57:09.683 | INFO     | tools.trainer:train_loop:89 - Epoch: [39/ 80] | Train loss: [0.10885253606571091]
2022-03-30 15:00:58.592 | INFO     | tools.trainer:train_loop:89 - Epoch: [40/ 80] | Train loss: [0.13439872049623067]
2022-03-30 15:04:47.566 | INFO     | tools.trainer:train_loop:89 - Epoch: [41/ 80] | Train loss: [0.11415578689840104]
2022-03-30 15:08:36.574 | INFO     | tools.trainer:train_loop:89 - Epoch: [42/ 80] | Train loss: [0.11027229933275116]
2022-03-30 15:12:25.504 | INFO     | tools.trainer:train_loop:89 - Epoch: [43/ 80] | Train loss: [0.10740885196460617]
2022-03-30 15:16:14.486 | INFO     | tools.trainer:train_loop:89 - Epoch: [44/ 80] | Train loss: [0.10231134684549438]
2022-03-30 15:20:03.546 | INFO     | tools.trainer:train_loop:89 - Epoch: [45/ 80] | Train loss: [0.10245664964119593]
2022-03-30 15:23:52.441 | INFO     | tools.trainer:train_loop:89 - Epoch: [46/ 80] | Train loss: [0.09922408958276113]
2022-03-30 15:27:41.729 | INFO     | tools.trainer:train_loop:89 - Epoch: [47/ 80] | Train loss: [0.0993025750749641]
2022-03-30 15:31:30.711 | INFO     | tools.trainer:train_loop:89 - Epoch: [48/ 80] | Train loss: [0.10338907688856125]
2022-03-30 15:35:19.610 | INFO     | tools.trainer:train_loop:89 - Epoch: [49/ 80] | Train loss: [0.09718134254217148]
2022-03-30 15:39:08.730 | INFO     | tools.trainer:train_loop:89 - Epoch: [50/ 80] | Train loss: [0.09892269795139631]
2022-03-30 15:42:57.937 | INFO     | tools.trainer:train_loop:89 - Epoch: [51/ 80] | Train loss: [0.0975982074936231]
2022-03-30 15:46:46.832 | INFO     | tools.trainer:train_loop:89 - Epoch: [52/ 80] | Train loss: [0.09234711709949706]
2022-03-30 15:50:35.666 | INFO     | tools.trainer:train_loop:89 - Epoch: [53/ 80] | Train loss: [0.09422565731737349]
2022-03-30 15:54:24.478 | INFO     | tools.trainer:train_loop:89 - Epoch: [54/ 80] | Train loss: [0.09404766658941904]
2022-03-30 15:58:13.429 | INFO     | tools.trainer:train_loop:89 - Epoch: [55/ 80] | Train loss: [0.0929264382355743]
2022-03-30 16:02:02.279 | INFO     | tools.trainer:train_loop:89 - Epoch: [56/ 80] | Train loss: [0.09210171649853388]
2022-03-30 16:05:51.267 | INFO     | tools.trainer:train_loop:89 - Epoch: [57/ 80] | Train loss: [0.0901179244948758]
2022-03-30 16:09:40.131 | INFO     | tools.trainer:train_loop:89 - Epoch: [58/ 80] | Train loss: [0.08766461354162958]
2022-03-30 16:13:29.006 | INFO     | tools.trainer:train_loop:89 - Epoch: [59/ 80] | Train loss: [0.08613759535882208]
2022-03-30 16:17:17.940 | INFO     | tools.trainer:train_loop:89 - Epoch: [60/ 80] | Train loss: [0.08602392218179172]
2022-03-30 16:21:06.862 | INFO     | tools.trainer:train_loop:89 - Epoch: [61/ 80] | Train loss: [0.08593935593962669]
2022-03-30 16:24:55.815 | INFO     | tools.trainer:train_loop:89 - Epoch: [62/ 80] | Train loss: [0.08562148056096501]
2022-03-30 16:28:44.578 | INFO     | tools.trainer:train_loop:89 - Epoch: [63/ 80] | Train loss: [0.08360949729879698]
2022-03-30 16:32:33.453 | INFO     | tools.trainer:train_loop:89 - Epoch: [64/ 80] | Train loss: [0.08274062871932983]
2022-03-30 16:36:22.320 | INFO     | tools.trainer:train_loop:89 - Epoch: [65/ 80] | Train loss: [0.08180000409483909]
2022-03-30 16:40:11.219 | INFO     | tools.trainer:train_loop:89 - Epoch: [66/ 80] | Train loss: [0.08129732468061977]
2022-03-30 16:44:00.288 | INFO     | tools.trainer:train_loop:89 - Epoch: [67/ 80] | Train loss: [0.07840345394280222]
2022-03-30 16:47:49.185 | INFO     | tools.trainer:train_loop:89 - Epoch: [68/ 80] | Train loss: [0.07939703928099738]
2022-03-30 16:51:38.161 | INFO     | tools.trainer:train_loop:89 - Epoch: [69/ 80] | Train loss: [0.07765474145611127]
2022-03-30 16:55:27.155 | INFO     | tools.trainer:train_loop:89 - Epoch: [70/ 80] | Train loss: [0.07636503966318237]
2022-03-30 16:59:16.453 | INFO     | tools.trainer:train_loop:89 - Epoch: [71/ 80] | Train loss: [0.07727637324068282]
2022-03-30 17:03:05.958 | INFO     | tools.trainer:train_loop:89 - Epoch: [72/ 80] | Train loss: [0.07645279102855258]
2022-03-30 17:06:55.426 | INFO     | tools.trainer:train_loop:89 - Epoch: [73/ 80] | Train loss: [0.07714300089412265]
2022-03-30 17:10:44.443 | INFO     | tools.trainer:train_loop:89 - Epoch: [74/ 80] | Train loss: [0.07470649484958913]
2022-03-30 17:14:33.473 | INFO     | tools.trainer:train_loop:89 - Epoch: [75/ 80] | Train loss: [0.0737623376150926]
2022-03-30 17:18:22.410 | INFO     | tools.trainer:train_loop:89 - Epoch: [76/ 80] | Train loss: [0.07382736247446801]
2022-03-30 17:22:11.248 | INFO     | tools.trainer:train_loop:89 - Epoch: [77/ 80] | Train loss: [0.0741169735789299]
2022-03-30 17:26:00.265 | INFO     | tools.trainer:train_loop:89 - Epoch: [78/ 80] | Train loss: [0.073786527911822]
2022-03-30 17:29:49.227 | INFO     | tools.trainer:train_loop:89 - Epoch: [79/ 80] | Train loss: [0.07263586757083734]
2022-03-30 17:29:49.433 | INFO     | tools.trainer:train_loop:104 - [Saving Snapshot:]/mnt/data/hungpv/polyps/checkpoint/KCECE/pvtv2-uperhead_v11/PVTv2-B3-UPerHead_79.pth
2022-03-30 17:33:38.201 | INFO     | tools.trainer:train_loop:89 - Epoch: [80/ 80] | Train loss: [0.07265270170238283]
2022-03-30 17:33:38.403 | INFO     | tools.trainer:train_loop:104 - [Saving Snapshot:]/mnt/data/hungpv/polyps/checkpoint/KCECE/pvtv2-uperhead_v11/PVTv2-B3-UPerHead_80.pth
2022-03-30 17:33:38.403 | INFO     | tools.trainer:train_loop:110 - Training cost: 18314.111386175005seconds
