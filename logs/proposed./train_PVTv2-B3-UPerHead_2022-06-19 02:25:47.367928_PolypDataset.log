2022-06-19 02:25:47.371 | INFO     | __main__:main:57 - Load config from configs/proposed.yaml
2022-06-19 02:25:47.372 | INFO     | __main__:main:58 - {'dataset': {'data_path': '/home/admin_mcn/hungpv/polyps/dataset/KCECE', 'train_data_path': ['/home/admin_mcn/hungpv/polyps/dataset/KCECE/TrainDataset'], 'test_data_path': ['/home/admin_mcn/hungpv/polyps/dataset/KCECE/TestDataset/ETIS-LaribPolypDB'], 'val_data_path': ['/home/admin_mcn/hungpv/polyps/dataset/KCECE/TestDataset/CVC-300']}, 'model': {'num_classes': 1, 'save_dir': '/home/admin_mcn/hungpv/polyps/checkpoints/proposed_v7', 'backbone': 'PVTv2-B3', 'head': 'UPerHead', 'pretrained': '/home/admin_mcn/hungpv/polyps/pretrained-backbone/pvt_v2_b3.pth'}, 'optimizer': {'name': 'adam', 'lr': 0.0001, 'clip': 0.5, 'scheduler': 'cosine_warmup', 'loss': 'structure_loss'}, 'dev': 'cuda', 'train': {'start_from': 0, 'save_from': 59, 'num_epochs': 60, 'num_warmup_epoch': 8, 'is_val': False, 'size_rates': [0.75, 1, 1.25], 'dataloader': {'batchsize': 16, 'img_size': 352, 'shuffle': True, 'num_workers': 4, 'pin_memory': True, 'drop_last': True}, 'amp': False, 'ddp': False, 'augment': {'prob': 1, 'Flip_prob': 0.5, 'HueSaturationValue_prob': 0.5, 'RandomBrightnessContrast_prob': 0.5, 'randomrotate90_prob': 0.5}}, 'test': {'dev': 'cuda', 'visualize': False, 'visualize_dir': '/mnt/data/hungpv/polyps/visualize', 'vis_x': 180, 'vis_overwrite': False, 'checkpoint_dir': '/home/admin_mcn/hungpv/polyps/checkpoints/proposed_v6/PVTv2-B3-UPerHead_60.pth', 'dataloader': {'batchsize': 1, 'img_size': 352, 'shuffle': True, 'num_workers': 2, 'pin_memory': True, 'drop_last': True}, 'augment': {'prob': 1, 'Flip_prob': 0, 'HueSaturationValue_prob': 0, 'RandomBrightnessContrast_prob': 0, 'crop_prob': 0, 'randomrotate90_prob': 0, 'elastictransform_prob': 0, 'gridistortion_prob': 0, 'opticaldistortion_prob': 0, 'verticalflip_prob': 0, 'horizontalflip_prob': 0, 'randomgamma_prob': 0, 'CoarseDropout_prob': 0, 'RGBShift_prob': 0, 'MotionBlur_prob': 0, 'MedianBlur_prob': 0, 'GaussianBlur_prob': 0, 'GaussNoise_prob': 0, 'ChannelShuffle_prob': 0}}}
2022-06-19 02:25:47.372 | INFO     | __main__:main:59 - Getting datapath
2022-06-19 02:25:47.376 | INFO     | __main__:main:73 - There are 1450 images to train
2022-06-19 02:25:47.377 | INFO     | __main__:main:92 - Train model with no valid dataset
2022-06-19 02:25:47.377 | INFO     | __main__:main:94 - Loading data
2022-06-19 02:25:47.443 | INFO     | __main__:main:108 - 90 batches to train
2022-06-19 02:25:47.446 | INFO     | __main__:main:121 - Loading model
2022-06-19 02:25:47.446 | INFO     | __main__:main:142 - Loading checkpoint from /home/admin_mcn/hungpv/polyps/pretrained-backbone/pvt_v2_b3.pth ...
2022-06-19 02:25:50.919 | INFO     | __main__:main:185 - Training with FP32 ...
2022-06-19 02:31:21.655 | INFO     | tools.trainer:train_loop:103 - Epoch: [1/ 60] | Train loss: [4.771244626575046]
2022-06-19 02:37:29.356 | INFO     | tools.trainer:train_loop:103 - Epoch: [2/ 60] | Train loss: [1.4445693837271796]
2022-06-19 02:43:43.750 | INFO     | tools.trainer:train_loop:103 - Epoch: [3/ 60] | Train loss: [1.070299388964971]
2022-06-19 02:43:43.954 | INFO     | tools.trainer:train_loop:115 - [Saving Snapshot:]/home/admin_mcn/hungpv/polyps/checkpoints/proposed_v7/PVTv2-B3-UPerHead_3.pth
2022-06-19 02:50:00.026 | INFO     | tools.trainer:train_loop:103 - Epoch: [4/ 60] | Train loss: [0.8800543791717953]
2022-06-19 02:56:25.082 | INFO     | tools.trainer:train_loop:103 - Epoch: [5/ 60] | Train loss: [0.7117231422000461]
2022-06-19 03:02:55.099 | INFO     | tools.trainer:train_loop:103 - Epoch: [6/ 60] | Train loss: [0.6011367989910974]
2022-06-19 03:09:13.741 | INFO     | tools.trainer:train_loop:103 - Epoch: [7/ 60] | Train loss: [0.5260591997040642]
2022-06-19 03:15:27.247 | INFO     | tools.trainer:train_loop:103 - Epoch: [8/ 60] | Train loss: [0.4663669808043374]
2022-06-19 03:21:33.987 | INFO     | tools.trainer:train_loop:103 - Epoch: [9/ 60] | Train loss: [0.3983210590150621]
2022-06-19 03:27:42.592 | INFO     | tools.trainer:train_loop:103 - Epoch: [10/ 60] | Train loss: [0.36262467834684586]
2022-06-19 03:34:02.881 | INFO     | tools.trainer:train_loop:103 - Epoch: [11/ 60] | Train loss: [0.3862724574075805]
2022-06-19 03:40:20.602 | INFO     | tools.trainer:train_loop:103 - Epoch: [12/ 60] | Train loss: [0.39148913588788775]
2022-06-19 03:46:20.352 | INFO     | tools.trainer:train_loop:103 - Epoch: [13/ 60] | Train loss: [0.332537512977918]
2022-06-19 03:52:13.550 | INFO     | tools.trainer:train_loop:103 - Epoch: [14/ 60] | Train loss: [0.29264843894375697]
2022-06-19 03:58:13.657 | INFO     | tools.trainer:train_loop:103 - Epoch: [15/ 60] | Train loss: [0.27319920708735784]
2022-06-19 04:04:13.809 | INFO     | tools.trainer:train_loop:103 - Epoch: [16/ 60] | Train loss: [0.4377823988596598]
2022-06-19 04:10:11.139 | INFO     | tools.trainer:train_loop:103 - Epoch: [17/ 60] | Train loss: [0.3251054796907637]
2022-06-19 04:16:14.411 | INFO     | tools.trainer:train_loop:103 - Epoch: [18/ 60] | Train loss: [0.29173248757918674]
2022-06-19 04:22:11.826 | INFO     | tools.trainer:train_loop:103 - Epoch: [19/ 60] | Train loss: [0.2677084998952018]
2022-06-19 04:28:13.374 | INFO     | tools.trainer:train_loop:103 - Epoch: [20/ 60] | Train loss: [0.27097483575344083]
2022-06-19 04:34:09.674 | INFO     | tools.trainer:train_loop:103 - Epoch: [21/ 60] | Train loss: [0.2379246359070142]
2022-06-19 04:40:17.358 | INFO     | tools.trainer:train_loop:103 - Epoch: [22/ 60] | Train loss: [0.22716876102818384]
2022-06-19 04:46:08.882 | INFO     | tools.trainer:train_loop:103 - Epoch: [23/ 60] | Train loss: [0.2245479898320304]
2022-06-19 04:51:50.590 | INFO     | tools.trainer:train_loop:103 - Epoch: [24/ 60] | Train loss: [0.21611647705237072]
2022-06-19 04:57:28.829 | INFO     | tools.trainer:train_loop:103 - Epoch: [25/ 60] | Train loss: [0.20108153654469385]
2022-06-19 05:03:14.566 | INFO     | tools.trainer:train_loop:103 - Epoch: [26/ 60] | Train loss: [0.19009059245387713]
2022-06-19 05:09:01.208 | INFO     | tools.trainer:train_loop:103 - Epoch: [27/ 60] | Train loss: [0.18889386355876922]
2022-06-19 05:14:45.396 | INFO     | tools.trainer:train_loop:103 - Epoch: [28/ 60] | Train loss: [0.1852487724688318]
2022-06-19 05:20:29.805 | INFO     | tools.trainer:train_loop:103 - Epoch: [29/ 60] | Train loss: [0.18015131544735696]
2022-06-19 05:26:13.604 | INFO     | tools.trainer:train_loop:103 - Epoch: [30/ 60] | Train loss: [0.177451065596607]
2022-06-19 05:31:57.218 | INFO     | tools.trainer:train_loop:103 - Epoch: [31/ 60] | Train loss: [0.16663217370708783]
2022-06-19 05:37:37.863 | INFO     | tools.trainer:train_loop:103 - Epoch: [32/ 60] | Train loss: [0.17027450957232051]
2022-06-19 05:43:20.750 | INFO     | tools.trainer:train_loop:103 - Epoch: [33/ 60] | Train loss: [0.16030490828884972]
2022-06-19 05:49:03.398 | INFO     | tools.trainer:train_loop:103 - Epoch: [34/ 60] | Train loss: [0.15601325208942096]
2022-06-19 05:54:40.120 | INFO     | tools.trainer:train_loop:103 - Epoch: [35/ 60] | Train loss: [0.15078603169984287]
2022-06-19 06:00:21.790 | INFO     | tools.trainer:train_loop:103 - Epoch: [36/ 60] | Train loss: [0.15451092248161633]
2022-06-19 06:06:09.044 | INFO     | tools.trainer:train_loop:103 - Epoch: [37/ 60] | Train loss: [0.15057783019211557]
2022-06-19 06:12:00.266 | INFO     | tools.trainer:train_loop:103 - Epoch: [38/ 60] | Train loss: [0.14739944173230066]
2022-06-19 06:17:43.711 | INFO     | tools.trainer:train_loop:103 - Epoch: [39/ 60] | Train loss: [0.14304210676087273]
2022-06-19 06:23:25.040 | INFO     | tools.trainer:train_loop:103 - Epoch: [40/ 60] | Train loss: [0.14044126263923115]
2022-06-19 06:29:11.138 | INFO     | tools.trainer:train_loop:103 - Epoch: [41/ 60] | Train loss: [0.1358148909277386]
2022-06-19 06:35:05.484 | INFO     | tools.trainer:train_loop:103 - Epoch: [42/ 60] | Train loss: [0.1325716260406706]
2022-06-19 06:40:56.194 | INFO     | tools.trainer:train_loop:103 - Epoch: [43/ 60] | Train loss: [0.13093788358900282]
2022-06-19 06:46:51.475 | INFO     | tools.trainer:train_loop:103 - Epoch: [44/ 60] | Train loss: [0.12874319156010947]
2022-06-19 06:52:40.476 | INFO     | tools.trainer:train_loop:103 - Epoch: [45/ 60] | Train loss: [0.1306238411201371]
2022-06-19 06:58:38.837 | INFO     | tools.trainer:train_loop:103 - Epoch: [46/ 60] | Train loss: [0.12661605502168338]
2022-06-19 07:04:39.917 | INFO     | tools.trainer:train_loop:103 - Epoch: [47/ 60] | Train loss: [0.12452338669035169]
2022-06-19 07:10:46.325 | INFO     | tools.trainer:train_loop:103 - Epoch: [48/ 60] | Train loss: [0.11956662378377385]
2022-06-19 07:16:48.441 | INFO     | tools.trainer:train_loop:103 - Epoch: [49/ 60] | Train loss: [0.11839023166232639]
2022-06-19 07:22:48.177 | INFO     | tools.trainer:train_loop:103 - Epoch: [50/ 60] | Train loss: [0.11717642628484302]
2022-06-19 07:28:50.495 | INFO     | tools.trainer:train_loop:103 - Epoch: [51/ 60] | Train loss: [0.11220372948381636]
2022-06-19 07:34:54.328 | INFO     | tools.trainer:train_loop:103 - Epoch: [52/ 60] | Train loss: [0.11382615624202622]
2022-06-19 07:41:00.728 | INFO     | tools.trainer:train_loop:103 - Epoch: [53/ 60] | Train loss: [0.11117017956243622]
2022-06-19 07:47:08.859 | INFO     | tools.trainer:train_loop:103 - Epoch: [54/ 60] | Train loss: [0.10961571352349388]
2022-06-19 07:53:12.132 | INFO     | tools.trainer:train_loop:103 - Epoch: [55/ 60] | Train loss: [0.11026277260647879]
2022-06-19 07:59:21.134 | INFO     | tools.trainer:train_loop:103 - Epoch: [56/ 60] | Train loss: [0.10687985478176011]
2022-06-19 08:05:19.978 | INFO     | tools.trainer:train_loop:103 - Epoch: [57/ 60] | Train loss: [0.10529363668627209]
2022-06-19 08:11:22.034 | INFO     | tools.trainer:train_loop:103 - Epoch: [58/ 60] | Train loss: [0.10470774173736572]
2022-06-19 08:17:32.505 | INFO     | tools.trainer:train_loop:103 - Epoch: [59/ 60] | Train loss: [0.10575862170921432]
2022-06-19 08:23:43.885 | INFO     | tools.trainer:train_loop:103 - Epoch: [60/ 60] | Train loss: [0.10284474740425746]
2022-06-19 08:23:44.094 | INFO     | tools.trainer:train_loop:115 - [Saving Snapshot:]/home/admin_mcn/hungpv/polyps/checkpoints/proposed_v7/PVTv2-B3-UPerHead_60.pth
2022-06-19 08:23:44.094 | INFO     | tools.trainer:train_loop:124 - Training cost: 21472.081708876998seconds
