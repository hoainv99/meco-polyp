2022-09-13 10:49:01.156 | INFO     | __main__:main:57 - Load config from configs/neo_small.yaml
2022-09-13 10:49:01.156 | INFO     | __main__:main:58 - {'dataset': {'data_path': '/home/s/hungpv/polyps/dataset', 'train_data_path': ['/home/s/hungpv/polyps/dataset/neo_small/train'], 'test_data_path': ['/home/s/hungpv/polyps/dataset/neo_small/test'], 'val_data_path': ['/home/s/hungpv/polyps/dataset/neo_small/test']}, 'model': {'num_classes': 3, 'save_dir': '/home/s/hungpv/polyps/checkpoint/neo/neo_small_v2', 'backbone': 'MiT-B3', 'head': 'FaPNHead', 'pretrained': '/home/s/hungpv/polyps/pretrained_models/mit_b3.pth'}, 'optimizer': {'name': 'adam', 'lr': 0.0001, 'clip': 0.5, 'scheduler': 'cosine_warmup', 'loss': 'multi_structure_loss'}, 'dev': 'cuda', 'train': {'start_from': 0, 'save_from': 59, 'num_epochs': 60, 'num_warmup_epoch': 4, 'is_val': False, 'size_rates': [0.75, 1, 1.25], 'dataloader': {'batchsize': 16, 'img_size': 384, 'shuffle': True, 'num_workers': 4, 'pin_memory': True, 'drop_last': True}, 'amp': False, 'ddp': False, 'augment': {'prob': 1, 'Flip_prob': 0.5, 'HueSaturationValue_prob': 0.5, 'RandomBrightnessContrast_prob': 0.5, 'crop_prob': 0.0, 'randomrotate90_prob': 0.5, 'ColorJitter_prob': 0.5}}, 'val': {'dataloader': {'batchsize': 8, 'img_size': 384, 'shuffle': True, 'num_workers': 4, 'pin_memory': True, 'drop_last': False}}, 'test': {'dev': 'cuda', 'visualize': True, 'visualize_dir': '/home/s/hungpv/polyps/neo_visualize', 'vis_x': 180, 'vis_overwrite': False, 'checkpoint_dir': '/home/s/hungpv/polyps/checkpoint/neo/neo_small_v1/MiT-B3-FaPNHead_60.pth', 'dataloader': {'batchsize': 1, 'img_size': 384, 'shuffle': True, 'num_workers': 4, 'pin_memory': True, 'drop_last': False}, 'augment': {'prob': 1, 'Flip_prob': 0, 'HueSaturationValue_prob': 0, 'RandomBrightnessContrast_prob': 0, 'crop_prob': 0, 'randomrotate90_prob': 0, 'elastictransform_prob': 0, 'gridistortion_prob': 0, 'opticaldistortion_prob': 0, 'verticalflip_prob': 0, 'horizontalflip_prob': 0, 'randomgamma_prob': 0, 'CoarseDropout_prob': 0, 'RGBShift_prob': 0, 'MotionBlur_prob': 0, 'MedianBlur_prob': 0, 'GaussianBlur_prob': 0, 'GaussNoise_prob': 0, 'ChannelShuffle_prob': 0}}}
2022-09-13 10:49:01.156 | INFO     | __main__:main:59 - Getting datapath
2022-09-13 10:49:01.161 | INFO     | __main__:main:74 - There are 1000 images to train
2022-09-13 10:49:01.162 | INFO     | __main__:main:93 - Train model with no valid dataset
2022-09-13 10:49:01.162 | INFO     | __main__:main:95 - Loading data
2022-09-13 10:49:01.244 | INFO     | __main__:main:109 - 62 batches to train
2022-09-13 10:49:01.245 | INFO     | __main__:main:122 - Loading model
2022-09-13 10:49:01.245 | INFO     | __main__:main:143 - Loading checkpoint from /home/s/hungpv/polyps/pretrained_models/mit_b3.pth ...
2022-09-13 10:49:04.434 | INFO     | __main__:main:187 - Training with FP32 ...
2022-09-13 10:50:36.639 | INFO     | tools.trainer:train_loop:126 - Epoch: [1/ 60] | Train loss: [2.148556715057742]
2022-09-13 10:52:07.897 | INFO     | tools.trainer:train_loop:126 - Epoch: [2/ 60] | Train loss: [0.9135350988757226]
2022-09-13 10:53:39.502 | INFO     | tools.trainer:train_loop:126 - Epoch: [3/ 60] | Train loss: [0.671091099900584]
2022-09-13 10:55:10.842 | INFO     | tools.trainer:train_loop:126 - Epoch: [4/ 60] | Train loss: [0.6202504596402568]
2022-09-13 10:56:43.014 | INFO     | tools.trainer:train_loop:126 - Epoch: [5/ 60] | Train loss: [0.573277376351818]
2022-09-13 10:58:14.551 | INFO     | tools.trainer:train_loop:126 - Epoch: [6/ 60] | Train loss: [0.4667993168677053]
2022-09-13 10:59:46.916 | INFO     | tools.trainer:train_loop:126 - Epoch: [7/ 60] | Train loss: [0.36691160836527426]
2022-09-13 11:01:19.095 | INFO     | tools.trainer:train_loop:126 - Epoch: [8/ 60] | Train loss: [0.32689973399523764]
2022-09-13 11:02:52.282 | INFO     | tools.trainer:train_loop:126 - Epoch: [9/ 60] | Train loss: [0.4674352304108681]
2022-09-13 11:04:23.666 | INFO     | tools.trainer:train_loop:126 - Epoch: [10/ 60] | Train loss: [0.6192433165927087]
2022-09-13 11:05:56.694 | INFO     | tools.trainer:train_loop:126 - Epoch: [11/ 60] | Train loss: [0.45106356182406027]
2022-09-13 11:07:28.479 | INFO     | tools.trainer:train_loop:126 - Epoch: [12/ 60] | Train loss: [0.3743778587348999]
2022-09-13 11:09:01.156 | INFO     | tools.trainer:train_loop:126 - Epoch: [13/ 60] | Train loss: [0.305089007342054]
2022-09-13 11:10:33.663 | INFO     | tools.trainer:train_loop:126 - Epoch: [14/ 60] | Train loss: [0.2660314640210521]
2022-09-13 11:12:07.157 | INFO     | tools.trainer:train_loop:126 - Epoch: [15/ 60] | Train loss: [0.2595177142610473]
2022-09-13 11:13:39.534 | INFO     | tools.trainer:train_loop:126 - Epoch: [16/ 60] | Train loss: [0.24611091950247366]
2022-09-13 11:15:12.771 | INFO     | tools.trainer:train_loop:126 - Epoch: [17/ 60] | Train loss: [0.2441155249553342]
2022-09-13 11:16:44.778 | INFO     | tools.trainer:train_loop:126 - Epoch: [18/ 60] | Train loss: [0.22415806485279913]
2022-09-13 11:18:16.880 | INFO     | tools.trainer:train_loop:126 - Epoch: [19/ 60] | Train loss: [0.23523655089159165]
2022-09-13 11:19:50.048 | INFO     | tools.trainer:train_loop:126 - Epoch: [20/ 60] | Train loss: [0.22377790630825103]
2022-09-13 11:21:22.451 | INFO     | tools.trainer:train_loop:126 - Epoch: [21/ 60] | Train loss: [0.20849802705549425]
2022-09-13 11:22:55.071 | INFO     | tools.trainer:train_loop:126 - Epoch: [22/ 60] | Train loss: [0.2114131941550201]
2022-09-13 11:24:27.751 | INFO     | tools.trainer:train_loop:126 - Epoch: [23/ 60] | Train loss: [0.2041555092700066]
2022-09-13 11:26:00.595 | INFO     | tools.trainer:train_loop:126 - Epoch: [24/ 60] | Train loss: [0.20885327097869688]
2022-09-13 11:27:33.253 | INFO     | tools.trainer:train_loop:126 - Epoch: [25/ 60] | Train loss: [0.20240027157049026]
2022-09-13 11:29:06.368 | INFO     | tools.trainer:train_loop:126 - Epoch: [26/ 60] | Train loss: [0.18423843876488746]
2022-09-13 11:30:38.252 | INFO     | tools.trainer:train_loop:126 - Epoch: [27/ 60] | Train loss: [0.175852402564018]
2022-09-13 11:32:11.794 | INFO     | tools.trainer:train_loop:126 - Epoch: [28/ 60] | Train loss: [0.1903003057645213]
2022-09-13 11:33:43.925 | INFO     | tools.trainer:train_loop:126 - Epoch: [29/ 60] | Train loss: [0.157798120571721]
2022-09-13 11:35:16.523 | INFO     | tools.trainer:train_loop:126 - Epoch: [30/ 60] | Train loss: [0.16529843439498254]
2022-09-13 11:36:48.856 | INFO     | tools.trainer:train_loop:126 - Epoch: [31/ 60] | Train loss: [0.14946878803593497]
2022-09-13 11:38:21.306 | INFO     | tools.trainer:train_loop:126 - Epoch: [32/ 60] | Train loss: [0.1356695765449155]
2022-09-13 11:39:53.872 | INFO     | tools.trainer:train_loop:126 - Epoch: [33/ 60] | Train loss: [0.16582705975780565]
2022-09-13 11:41:26.408 | INFO     | tools.trainer:train_loop:126 - Epoch: [34/ 60] | Train loss: [0.14709222412878467]
2022-09-13 11:42:58.485 | INFO     | tools.trainer:train_loop:126 - Epoch: [35/ 60] | Train loss: [0.13742072501730535]
2022-09-13 11:44:31.221 | INFO     | tools.trainer:train_loop:126 - Epoch: [36/ 60] | Train loss: [0.13486201280067045]
2022-09-13 11:46:04.332 | INFO     | tools.trainer:train_loop:126 - Epoch: [37/ 60] | Train loss: [0.131449548828025]
2022-09-13 11:47:37.798 | INFO     | tools.trainer:train_loop:126 - Epoch: [38/ 60] | Train loss: [0.11860167986202624]
2022-09-13 11:49:09.547 | INFO     | tools.trainer:train_loop:126 - Epoch: [39/ 60] | Train loss: [0.13277060352265835]
2022-09-13 11:50:42.730 | INFO     | tools.trainer:train_loop:126 - Epoch: [40/ 60] | Train loss: [0.12082979347436659]
2022-09-13 11:52:15.031 | INFO     | tools.trainer:train_loop:126 - Epoch: [41/ 60] | Train loss: [0.11636257315835645]
2022-09-13 11:53:47.468 | INFO     | tools.trainer:train_loop:126 - Epoch: [42/ 60] | Train loss: [0.1120460256934166]
2022-09-13 11:55:19.733 | INFO     | tools.trainer:train_loop:126 - Epoch: [43/ 60] | Train loss: [0.10481196083128452]
2022-09-13 11:56:53.230 | INFO     | tools.trainer:train_loop:126 - Epoch: [44/ 60] | Train loss: [0.09872832984453248]
2022-09-13 11:58:25.852 | INFO     | tools.trainer:train_loop:126 - Epoch: [45/ 60] | Train loss: [0.10049036806148867]
2022-09-13 11:59:59.789 | INFO     | tools.trainer:train_loop:126 - Epoch: [46/ 60] | Train loss: [0.09316841038244386]
2022-09-13 12:01:31.747 | INFO     | tools.trainer:train_loop:126 - Epoch: [47/ 60] | Train loss: [0.09271177619455322]
2022-09-13 12:03:05.636 | INFO     | tools.trainer:train_loop:126 - Epoch: [48/ 60] | Train loss: [0.08915435937383483]
2022-09-13 12:04:39.842 | INFO     | tools.trainer:train_loop:126 - Epoch: [49/ 60] | Train loss: [0.09250098893478993]
2022-09-13 12:06:12.074 | INFO     | tools.trainer:train_loop:126 - Epoch: [50/ 60] | Train loss: [0.10075117677690522]
2022-09-13 12:07:45.213 | INFO     | tools.trainer:train_loop:126 - Epoch: [51/ 60] | Train loss: [0.08772164126557688]
2022-09-13 12:09:17.524 | INFO     | tools.trainer:train_loop:126 - Epoch: [52/ 60] | Train loss: [0.07992517767894652]
2022-09-13 12:10:51.025 | INFO     | tools.trainer:train_loop:126 - Epoch: [53/ 60] | Train loss: [0.08702729888741047]
2022-09-13 12:12:23.433 | INFO     | tools.trainer:train_loop:126 - Epoch: [54/ 60] | Train loss: [0.07800217777971298]
2022-09-13 12:13:56.981 | INFO     | tools.trainer:train_loop:126 - Epoch: [55/ 60] | Train loss: [0.07615757222858167]
2022-09-13 12:15:29.332 | INFO     | tools.trainer:train_loop:126 - Epoch: [56/ 60] | Train loss: [0.07700060986943784]
2022-09-13 12:17:02.978 | INFO     | tools.trainer:train_loop:126 - Epoch: [57/ 60] | Train loss: [0.07288369674596094]
2022-09-13 12:18:34.983 | INFO     | tools.trainer:train_loop:126 - Epoch: [58/ 60] | Train loss: [0.08116834652760337]
2022-09-13 12:20:08.319 | INFO     | tools.trainer:train_loop:126 - Epoch: [59/ 60] | Train loss: [0.06891028447857787]
2022-09-13 12:21:42.127 | INFO     | tools.trainer:train_loop:126 - Epoch: [60/ 60] | Train loss: [0.07138947818067766]
2022-09-13 12:21:42.553 | INFO     | tools.trainer:train_loop:138 - [Saving Snapshot:]/home/s/hungpv/polyps/checkpoint/neo/neo_small_v2/MiT-B3-FaPNHead_60.pth
2022-09-13 12:21:42.553 | INFO     | tools.trainer:train_loop:147 - Training cost: 5557.163384506013seconds
