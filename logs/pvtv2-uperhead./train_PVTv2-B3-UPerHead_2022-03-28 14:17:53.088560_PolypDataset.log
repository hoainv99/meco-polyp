2022-03-28 14:17:53.090 | INFO     | __main__:main:45 - Load config from configs/pvtv2-uperhead.yaml
2022-03-28 14:17:53.090 | INFO     | __main__:main:46 - {'dataset': {'data_path': '/home/admin_mcn/hungpv/polyps/dataset/KCECE', 'train_data_path': ['/home/admin_mcn/hungpv/polyps/dataset/KCECE/TrainDataset'], 'test_data_path': ['/home/admin_mcn/hungpv/polyps/dataset/KCECE/TestDataset/Kvasir'], 'val_data_path': ['/home/admin_mcn/hungpv/polyps/dataset/KCECE/TestDataset/CVC-300']}, 'model': {'num_classes': 1, 'save_dir': '/mnt/data/hungpv/polyps/checkpoint/KCECE/pvtv2-uperhead_v8', 'backbone': 'PVTv2-B3', 'head': 'UPerHead', 'pretrained': '/mnt/data/hungpv/polyps/pretrained-backbone/pvt_v2_b3.pth'}, 'optimizer': {'name': 'adam', 'lr': 0.0001, 'clip': 0.5, 'scheduler': 'cosine_warmup', 'loss': 'structure_loss'}, 'dev': 'cuda', 'train': {'start_from': 0, 'save_from': 78, 'num_epochs': 80, 'num_warmup_epoch': 10, 'is_val': False, 'size_rates': [0.75, 1, 1.25], 'dataloader': {'batchsize': 16, 'img_size': 352, 'shuffle': True, 'num_workers': 2, 'pin_memory': True, 'drop_last': True}, 'amp': False, 'ddp': False, 'augment': {'prob': 1, 'Flip_prob': 0.7, 'HueSaturationValue_prob': 0.7, 'RandomBrightnessContrast_prob': 0.5, 'crop_prob': 0.4, 'randomrotate90_prob': 0.7}}, 'test': {'dev': 'cuda', 'visualize': False, 'visualize_dir': '/mnt/data/hungpv/polyps/visualize', 'vis_x': 180, 'vis_overwrite': False, 'checkpoint_dir': '/mnt/data/hungpv/polyps/checkpoint/KCECE/pvtv2-uperhead_v8/PVTv2-B3-UPerHead_80.pth', 'dataloader': {'batchsize': 1, 'img_size': 352, 'shuffle': True, 'num_workers': 2, 'pin_memory': True, 'drop_last': True}, 'augment': {'prob': 1, 'Flip_prob': 0, 'HueSaturationValue_prob': 0, 'RandomBrightnessContrast_prob': 0, 'crop_prob': 0, 'randomrotate90_prob': 0, 'elastictransform_prob': 0, 'gridistortion_prob': 0, 'opticaldistortion_prob': 0, 'verticalflip_prob': 0, 'horizontalflip_prob': 0, 'randomgamma_prob': 0, 'CoarseDropout_prob': 0, 'RGBShift_prob': 0, 'MotionBlur_prob': 0, 'MedianBlur_prob': 0, 'GaussianBlur_prob': 0, 'GaussNoise_prob': 0, 'ChannelShuffle_prob': 0}}}
2022-03-28 14:17:53.090 | INFO     | __main__:main:47 - Getting datapath
2022-03-28 14:17:53.096 | INFO     | __main__:main:61 - There are 1450 images to train
2022-03-28 14:17:53.096 | INFO     | __main__:main:80 - Train model with no valid dataset
2022-03-28 14:17:53.096 | INFO     | __main__:main:82 - Loading data
2022-03-28 14:17:53.185 | INFO     | __main__:main:96 - 90 batches to train
2022-03-28 14:17:53.189 | INFO     | __main__:main:109 - Loading model
2022-03-28 14:17:53.189 | INFO     | __main__:main:126 - Loading checkpoint from /mnt/data/hungpv/polyps/pretrained-backbone/pvt_v2_b3.pth ...
2022-03-28 14:17:55.750 | INFO     | __main__:main:164 - Training with FP32 ...
2022-03-28 14:21:52.656 | INFO     | tools.trainer:train_loop:89 - Epoch: [1/ 80] | Train loss: [2.142064878013399]
2022-03-28 14:25:47.447 | INFO     | tools.trainer:train_loop:89 - Epoch: [2/ 80] | Train loss: [0.8957754611968994]
2022-03-28 14:29:42.573 | INFO     | tools.trainer:train_loop:89 - Epoch: [3/ 80] | Train loss: [0.6987251887718836]
2022-03-28 14:29:42.780 | INFO     | tools.trainer:train_loop:104 - [Saving Snapshot:]/mnt/data/hungpv/polyps/checkpoint/KCECE/pvtv2-uperhead_v8/PVTv2-B3-UPerHead_3.pth
2022-03-28 14:33:38.371 | INFO     | tools.trainer:train_loop:89 - Epoch: [4/ 80] | Train loss: [0.5775126543309953]
2022-03-28 14:37:33.855 | INFO     | tools.trainer:train_loop:89 - Epoch: [5/ 80] | Train loss: [0.5039117839601305]
2022-03-28 14:41:29.793 | INFO     | tools.trainer:train_loop:89 - Epoch: [6/ 80] | Train loss: [0.42222988936636185]
2022-03-28 14:45:25.791 | INFO     | tools.trainer:train_loop:89 - Epoch: [7/ 80] | Train loss: [0.4081514517466227]
2022-03-28 14:49:21.744 | INFO     | tools.trainer:train_loop:89 - Epoch: [8/ 80] | Train loss: [0.3590164739224646]
2022-03-28 14:53:18.887 | INFO     | tools.trainer:train_loop:89 - Epoch: [9/ 80] | Train loss: [0.34343739963240094]
2022-03-28 14:57:30.530 | INFO     | tools.trainer:train_loop:89 - Epoch: [10/ 80] | Train loss: [0.2983738296561771]
2022-03-28 15:01:52.091 | INFO     | tools.trainer:train_loop:89 - Epoch: [11/ 80] | Train loss: [0.31935543285475837]
2022-03-28 15:06:17.229 | INFO     | tools.trainer:train_loop:89 - Epoch: [12/ 80] | Train loss: [0.2941719023717774]
2022-03-28 15:10:42.901 | INFO     | tools.trainer:train_loop:89 - Epoch: [13/ 80] | Train loss: [0.2707785450749927]
2022-03-28 15:15:06.597 | INFO     | tools.trainer:train_loop:89 - Epoch: [14/ 80] | Train loss: [0.2889556787080235]
2022-03-28 15:19:32.083 | INFO     | tools.trainer:train_loop:89 - Epoch: [15/ 80] | Train loss: [0.2676186165875859]
2022-03-28 15:23:58.000 | INFO     | tools.trainer:train_loop:89 - Epoch: [16/ 80] | Train loss: [0.2516383644607332]
2022-03-28 15:28:23.043 | INFO     | tools.trainer:train_loop:89 - Epoch: [17/ 80] | Train loss: [0.2748803248008092]
2022-03-28 15:32:48.265 | INFO     | tools.trainer:train_loop:89 - Epoch: [18/ 80] | Train loss: [0.2683625712990761]
2022-03-28 15:37:13.971 | INFO     | tools.trainer:train_loop:89 - Epoch: [19/ 80] | Train loss: [0.24829584608475366]
2022-03-28 15:41:38.269 | INFO     | tools.trainer:train_loop:89 - Epoch: [20/ 80] | Train loss: [0.24909475379519994]
2022-03-28 15:46:01.912 | INFO     | tools.trainer:train_loop:89 - Epoch: [21/ 80] | Train loss: [0.24607090502977372]
2022-03-28 15:50:26.143 | INFO     | tools.trainer:train_loop:89 - Epoch: [22/ 80] | Train loss: [0.22943209384878477]
2022-03-28 15:54:49.867 | INFO     | tools.trainer:train_loop:89 - Epoch: [23/ 80] | Train loss: [0.22141755041148928]
2022-03-28 15:59:13.364 | INFO     | tools.trainer:train_loop:89 - Epoch: [24/ 80] | Train loss: [0.23719124098618824]
2022-03-28 16:03:37.348 | INFO     | tools.trainer:train_loop:89 - Epoch: [25/ 80] | Train loss: [0.258518053094546]
2022-03-28 16:08:01.464 | INFO     | tools.trainer:train_loop:89 - Epoch: [26/ 80] | Train loss: [0.23475665234857135]
2022-03-28 16:12:25.526 | INFO     | tools.trainer:train_loop:89 - Epoch: [27/ 80] | Train loss: [0.2247476331061787]
2022-03-28 16:16:49.497 | INFO     | tools.trainer:train_loop:89 - Epoch: [28/ 80] | Train loss: [0.22478389864166579]
2022-03-28 16:21:13.537 | INFO     | tools.trainer:train_loop:89 - Epoch: [29/ 80] | Train loss: [0.20237535685300828]
2022-03-28 16:25:35.065 | INFO     | tools.trainer:train_loop:89 - Epoch: [30/ 80] | Train loss: [0.19914846867322922]
2022-03-28 16:30:00.050 | INFO     | tools.trainer:train_loop:89 - Epoch: [31/ 80] | Train loss: [0.21869537971085973]
2022-03-28 16:34:23.195 | INFO     | tools.trainer:train_loop:89 - Epoch: [32/ 80] | Train loss: [0.20210730632146198]
2022-03-28 16:38:45.452 | INFO     | tools.trainer:train_loop:89 - Epoch: [33/ 80] | Train loss: [0.18859802153375413]
2022-03-28 16:43:10.453 | INFO     | tools.trainer:train_loop:89 - Epoch: [34/ 80] | Train loss: [0.24300881028175353]
2022-03-28 16:47:36.185 | INFO     | tools.trainer:train_loop:89 - Epoch: [35/ 80] | Train loss: [0.20783117653595076]
2022-03-28 16:52:06.391 | INFO     | tools.trainer:train_loop:89 - Epoch: [36/ 80] | Train loss: [0.20628726739022468]
2022-03-28 16:56:34.973 | INFO     | tools.trainer:train_loop:89 - Epoch: [37/ 80] | Train loss: [0.20876940397752655]
2022-03-28 17:00:59.969 | INFO     | tools.trainer:train_loop:89 - Epoch: [38/ 80] | Train loss: [0.2073807894355721]
2022-03-28 17:05:23.700 | INFO     | tools.trainer:train_loop:89 - Epoch: [39/ 80] | Train loss: [0.20503063880734973]
2022-03-28 17:09:48.226 | INFO     | tools.trainer:train_loop:89 - Epoch: [40/ 80] | Train loss: [0.1923525204261144]
2022-03-28 17:14:12.069 | INFO     | tools.trainer:train_loop:89 - Epoch: [41/ 80] | Train loss: [0.18473918504185147]
2022-03-28 17:18:32.979 | INFO     | tools.trainer:train_loop:89 - Epoch: [42/ 80] | Train loss: [0.1899214531812403]
2022-03-28 17:22:55.276 | INFO     | tools.trainer:train_loop:89 - Epoch: [43/ 80] | Train loss: [0.18238377968470257]
2022-03-28 17:27:19.828 | INFO     | tools.trainer:train_loop:89 - Epoch: [44/ 80] | Train loss: [0.17722180833419163]
2022-03-28 17:31:46.346 | INFO     | tools.trainer:train_loop:89 - Epoch: [45/ 80] | Train loss: [0.1716656078067091]
2022-03-28 17:36:14.559 | INFO     | tools.trainer:train_loop:89 - Epoch: [46/ 80] | Train loss: [0.16238955491118962]
2022-03-28 17:40:41.639 | INFO     | tools.trainer:train_loop:89 - Epoch: [47/ 80] | Train loss: [0.17125009074807168]
2022-03-28 17:45:09.131 | INFO     | tools.trainer:train_loop:89 - Epoch: [48/ 80] | Train loss: [0.18111515641212464]
2022-03-28 17:49:37.351 | INFO     | tools.trainer:train_loop:89 - Epoch: [49/ 80] | Train loss: [0.17270250651571487]
2022-03-28 17:54:01.821 | INFO     | tools.trainer:train_loop:89 - Epoch: [50/ 80] | Train loss: [0.16818020832207467]
2022-03-28 17:58:26.224 | INFO     | tools.trainer:train_loop:89 - Epoch: [51/ 80] | Train loss: [0.2011072234974967]
2022-03-28 18:02:49.473 | INFO     | tools.trainer:train_loop:89 - Epoch: [52/ 80] | Train loss: [0.1879920734299554]
2022-03-28 18:07:11.842 | INFO     | tools.trainer:train_loop:89 - Epoch: [53/ 80] | Train loss: [0.1828886915412214]
2022-03-28 18:11:35.764 | INFO     | tools.trainer:train_loop:89 - Epoch: [54/ 80] | Train loss: [0.16856073902712929]
2022-03-28 18:16:00.648 | INFO     | tools.trainer:train_loop:89 - Epoch: [55/ 80] | Train loss: [0.16063012406229973]
2022-03-28 18:20:24.905 | INFO     | tools.trainer:train_loop:89 - Epoch: [56/ 80] | Train loss: [0.1712562248110771]
2022-03-28 18:24:52.863 | INFO     | tools.trainer:train_loop:89 - Epoch: [57/ 80] | Train loss: [0.15866883347431818]
2022-03-28 18:29:18.421 | INFO     | tools.trainer:train_loop:89 - Epoch: [58/ 80] | Train loss: [0.16991009422474437]
2022-03-28 18:33:43.442 | INFO     | tools.trainer:train_loop:89 - Epoch: [59/ 80] | Train loss: [0.1560965218477779]
2022-03-28 18:38:06.320 | INFO     | tools.trainer:train_loop:89 - Epoch: [60/ 80] | Train loss: [0.16436345138483577]
2022-03-28 18:42:28.695 | INFO     | tools.trainer:train_loop:89 - Epoch: [61/ 80] | Train loss: [0.1532573272784551]
2022-03-28 18:46:33.819 | INFO     | tools.trainer:train_loop:89 - Epoch: [62/ 80] | Train loss: [0.1455407156712479]
2022-03-28 18:50:31.813 | INFO     | tools.trainer:train_loop:89 - Epoch: [63/ 80] | Train loss: [0.14859031844470236]
2022-03-28 18:54:28.666 | INFO     | tools.trainer:train_loop:89 - Epoch: [64/ 80] | Train loss: [0.1531890031364229]
2022-03-28 18:58:25.447 | INFO     | tools.trainer:train_loop:89 - Epoch: [65/ 80] | Train loss: [0.16365418425864645]
2022-03-28 19:02:22.056 | INFO     | tools.trainer:train_loop:89 - Epoch: [66/ 80] | Train loss: [0.14550588031609854]
2022-03-28 19:06:18.344 | INFO     | tools.trainer:train_loop:89 - Epoch: [67/ 80] | Train loss: [0.15126541232069332]
2022-03-28 19:10:14.286 | INFO     | tools.trainer:train_loop:89 - Epoch: [68/ 80] | Train loss: [0.1433095803691281]
2022-03-28 19:14:11.538 | INFO     | tools.trainer:train_loop:89 - Epoch: [69/ 80] | Train loss: [0.14864927579959233]
2022-03-28 19:18:08.082 | INFO     | tools.trainer:train_loop:89 - Epoch: [70/ 80] | Train loss: [0.1401130816174878]
2022-03-28 19:22:03.858 | INFO     | tools.trainer:train_loop:89 - Epoch: [71/ 80] | Train loss: [0.14252778846356604]
2022-03-28 19:26:00.094 | INFO     | tools.trainer:train_loop:89 - Epoch: [72/ 80] | Train loss: [0.13604080354173978]
2022-03-28 19:29:56.543 | INFO     | tools.trainer:train_loop:89 - Epoch: [73/ 80] | Train loss: [0.14252046686079767]
2022-03-28 19:33:52.877 | INFO     | tools.trainer:train_loop:89 - Epoch: [74/ 80] | Train loss: [0.1439278569486406]
2022-03-28 19:37:49.427 | INFO     | tools.trainer:train_loop:89 - Epoch: [75/ 80] | Train loss: [0.1421253330177731]
2022-03-28 19:41:46.178 | INFO     | tools.trainer:train_loop:89 - Epoch: [76/ 80] | Train loss: [0.13730642828676437]
2022-03-28 19:45:42.702 | INFO     | tools.trainer:train_loop:89 - Epoch: [77/ 80] | Train loss: [0.13443170636892318]
2022-03-28 19:49:39.158 | INFO     | tools.trainer:train_loop:89 - Epoch: [78/ 80] | Train loss: [0.14079903935392699]
2022-03-28 19:53:35.636 | INFO     | tools.trainer:train_loop:89 - Epoch: [79/ 80] | Train loss: [0.13394369491272504]
2022-03-28 19:53:35.840 | INFO     | tools.trainer:train_loop:104 - [Saving Snapshot:]/mnt/data/hungpv/polyps/checkpoint/KCECE/pvtv2-uperhead_v8/PVTv2-B3-UPerHead_79.pth
2022-03-28 19:57:32.072 | INFO     | tools.trainer:train_loop:89 - Epoch: [80/ 80] | Train loss: [0.14184719920158387]
2022-03-28 19:57:32.271 | INFO     | tools.trainer:train_loop:104 - [Saving Snapshot:]/mnt/data/hungpv/polyps/checkpoint/KCECE/pvtv2-uperhead_v8/PVTv2-B3-UPerHead_80.pth
2022-03-28 19:57:32.271 | INFO     | tools.trainer:train_loop:110 - Training cost: 20375.53118881001seconds
