2022-04-22 10:03:52.910 | INFO     | __main__:main:46 - Load config from configs/proposed.yaml
2022-04-22 10:03:52.910 | INFO     | __main__:main:47 - {'dataset': {'data_path': '/home/admin_mcn/hungpv/polyps/dataset/KCECE', 'train_data_path': ['/home/admin_mcn/hungpv/polyps/dataset/KCECE/TrainDataset'], 'test_data_path': ['/home/admin_mcn/hungpv/polyps/dataset/KCECE/TestDataset/ETIS-LaribPolypDB'], 'val_data_path': ['/home/admin_mcn/hungpv/polyps/dataset/KCECE/TestDataset/CVC-300']}, 'model': {'num_classes': 1, 'save_dir': '/mnt/data/hungpv/polyps/checkpoint/KCECE/proposed_v10', 'backbone': 'PVTv2-B3', 'head': 'UPerHead', 'pretrained': '/mnt/data/hungpv/polyps/pretrained-backbone/pvt_v2_b3.pth'}, 'optimizer': {'name': 'adam', 'lr': 0.0001, 'clip': 0.5, 'scheduler': 'cosine_warmup', 'loss': 'structure_loss'}, 'dev': 'cuda', 'train': {'start_from': 0, 'save_from': 79, 'num_epochs': 80, 'num_warmup_epoch': 10, 'is_val': False, 'size_rates': [0.75, 1, 1.25], 'dataloader': {'batchsize': 16, 'img_size': 352, 'shuffle': True, 'num_workers': 2, 'pin_memory': True, 'drop_last': True}, 'amp': False, 'ddp': False, 'augment': {'prob': 1, 'Flip_prob': 0.7, 'HueSaturationValue_prob': 0.7, 'RandomBrightnessContrast_prob': 0.5, 'crop_prob': 0.0, 'randomrotate90_prob': 0.7}}, 'test': {'dev': 'cuda', 'visualize': False, 'visualize_dir': '/mnt/data/hungpv/polyps/visualize', 'vis_x': 180, 'vis_overwrite': False, 'checkpoint_dir': '/mnt/data/hungpv/polyps/checkpoint/KCECE/proposed_v8/PVTv2-B3-UPerHead_80.pth', 'dataloader': {'batchsize': 1, 'img_size': 352, 'shuffle': True, 'num_workers': 2, 'pin_memory': True, 'drop_last': True}, 'augment': {'prob': 1, 'Flip_prob': 0, 'HueSaturationValue_prob': 0, 'RandomBrightnessContrast_prob': 0, 'crop_prob': 0, 'randomrotate90_prob': 0, 'elastictransform_prob': 0, 'gridistortion_prob': 0, 'opticaldistortion_prob': 0, 'verticalflip_prob': 0, 'horizontalflip_prob': 0, 'randomgamma_prob': 0, 'CoarseDropout_prob': 0, 'RGBShift_prob': 0, 'MotionBlur_prob': 0, 'MedianBlur_prob': 0, 'GaussianBlur_prob': 0, 'GaussNoise_prob': 0, 'ChannelShuffle_prob': 0}}}
2022-04-22 10:03:52.910 | INFO     | __main__:main:48 - Getting datapath
2022-04-22 10:03:52.916 | INFO     | __main__:main:62 - There are 1450 images to train
2022-04-22 10:03:52.916 | INFO     | __main__:main:81 - Train model with no valid dataset
2022-04-22 10:03:52.916 | INFO     | __main__:main:83 - Loading data
2022-04-22 10:03:53.005 | INFO     | __main__:main:97 - 90 batches to train
2022-04-22 10:03:53.010 | INFO     | __main__:main:110 - Loading model
2022-04-22 10:03:53.010 | INFO     | __main__:main:131 - Loading checkpoint from /mnt/data/hungpv/polyps/pretrained-backbone/pvt_v2_b3.pth ...
2022-04-22 10:03:55.583 | INFO     | __main__:main:174 - Training with FP32 ...
2022-04-22 10:07:31.638 | INFO     | tools.trainer:train_loop:103 - Epoch: [1/ 80] | Train loss: [1.3015080902311538]
2022-04-22 10:11:06.910 | INFO     | tools.trainer:train_loop:103 - Epoch: [2/ 80] | Train loss: [0.6310383843051063]
2022-04-22 10:14:42.367 | INFO     | tools.trainer:train_loop:103 - Epoch: [3/ 80] | Train loss: [0.4698096583286921]
2022-04-22 10:14:42.576 | INFO     | tools.trainer:train_loop:118 - [Saving Snapshot:]/mnt/data/hungpv/polyps/checkpoint/KCECE/proposed_v10/PVTv2-B3-UPerHead_3.pth
2022-04-22 10:18:18.024 | INFO     | tools.trainer:train_loop:103 - Epoch: [4/ 80] | Train loss: [0.3801552340388298]
2022-04-22 10:21:53.652 | INFO     | tools.trainer:train_loop:103 - Epoch: [5/ 80] | Train loss: [0.323518932527966]
2022-04-22 10:25:29.225 | INFO     | tools.trainer:train_loop:103 - Epoch: [6/ 80] | Train loss: [0.28651291363769105]
2022-04-22 10:29:04.878 | INFO     | tools.trainer:train_loop:103 - Epoch: [7/ 80] | Train loss: [0.26622697876559365]
2022-04-22 10:32:40.342 | INFO     | tools.trainer:train_loop:103 - Epoch: [8/ 80] | Train loss: [0.25354692223999237]
2022-04-22 10:36:15.834 | INFO     | tools.trainer:train_loop:103 - Epoch: [9/ 80] | Train loss: [0.23400690025753446]
2022-04-22 10:39:51.427 | INFO     | tools.trainer:train_loop:103 - Epoch: [10/ 80] | Train loss: [0.21370161498586338]
2022-04-22 10:43:27.164 | INFO     | tools.trainer:train_loop:103 - Epoch: [11/ 80] | Train loss: [0.19726519286632538]
2022-04-22 10:47:02.759 | INFO     | tools.trainer:train_loop:103 - Epoch: [12/ 80] | Train loss: [0.1966000144680341]
2022-04-22 10:50:38.469 | INFO     | tools.trainer:train_loop:103 - Epoch: [13/ 80] | Train loss: [0.18907426380448872]
2022-04-22 10:54:14.038 | INFO     | tools.trainer:train_loop:103 - Epoch: [14/ 80] | Train loss: [0.1799055757621924]
2022-04-22 10:57:49.690 | INFO     | tools.trainer:train_loop:103 - Epoch: [15/ 80] | Train loss: [0.1713426469100846]
2022-04-22 11:01:25.416 | INFO     | tools.trainer:train_loop:103 - Epoch: [16/ 80] | Train loss: [0.16048408879174125]
2022-04-22 11:05:01.113 | INFO     | tools.trainer:train_loop:103 - Epoch: [17/ 80] | Train loss: [0.16540871974494722]
2022-04-22 11:08:36.453 | INFO     | tools.trainer:train_loop:103 - Epoch: [18/ 80] | Train loss: [0.16431770026683806]
2022-04-22 11:12:12.018 | INFO     | tools.trainer:train_loop:103 - Epoch: [19/ 80] | Train loss: [0.15725062034196324]
2022-04-22 11:15:47.743 | INFO     | tools.trainer:train_loop:103 - Epoch: [20/ 80] | Train loss: [0.1500582590699196]
2022-04-22 11:19:23.491 | INFO     | tools.trainer:train_loop:103 - Epoch: [21/ 80] | Train loss: [0.14429587440358269]
2022-04-22 11:22:59.292 | INFO     | tools.trainer:train_loop:103 - Epoch: [22/ 80] | Train loss: [0.14111595476667085]
2022-04-22 11:26:34.965 | INFO     | tools.trainer:train_loop:103 - Epoch: [23/ 80] | Train loss: [0.147722995115651]
2022-04-22 11:30:10.744 | INFO     | tools.trainer:train_loop:103 - Epoch: [24/ 80] | Train loss: [0.13600618665417036]
2022-04-22 11:33:46.398 | INFO     | tools.trainer:train_loop:103 - Epoch: [25/ 80] | Train loss: [0.12844626986318164]
2022-04-22 11:37:22.154 | INFO     | tools.trainer:train_loop:103 - Epoch: [26/ 80] | Train loss: [0.13969029353724585]
2022-04-22 11:40:57.766 | INFO     | tools.trainer:train_loop:103 - Epoch: [27/ 80] | Train loss: [0.14401248577568265]
2022-04-22 11:44:33.330 | INFO     | tools.trainer:train_loop:103 - Epoch: [28/ 80] | Train loss: [0.13457422446873452]
2022-04-22 11:48:09.080 | INFO     | tools.trainer:train_loop:103 - Epoch: [29/ 80] | Train loss: [0.13660597172048355]
2022-04-22 11:51:44.803 | INFO     | tools.trainer:train_loop:103 - Epoch: [30/ 80] | Train loss: [0.12148978089292845]
2022-04-22 11:55:20.572 | INFO     | tools.trainer:train_loop:103 - Epoch: [31/ 80] | Train loss: [0.13124401155445312]
2022-04-22 11:58:56.255 | INFO     | tools.trainer:train_loop:103 - Epoch: [32/ 80] | Train loss: [0.12114598709676001]
2022-04-22 12:02:31.903 | INFO     | tools.trainer:train_loop:103 - Epoch: [33/ 80] | Train loss: [0.11616182012690437]
2022-04-22 12:06:07.475 | INFO     | tools.trainer:train_loop:103 - Epoch: [34/ 80] | Train loss: [0.11723307917515437]
2022-04-22 12:09:43.135 | INFO     | tools.trainer:train_loop:103 - Epoch: [35/ 80] | Train loss: [0.11584130740827984]
2022-04-22 12:13:18.816 | INFO     | tools.trainer:train_loop:103 - Epoch: [36/ 80] | Train loss: [0.11227540506256951]
2022-04-22 12:16:54.636 | INFO     | tools.trainer:train_loop:103 - Epoch: [37/ 80] | Train loss: [0.11113292881184154]
2022-04-22 12:20:30.437 | INFO     | tools.trainer:train_loop:103 - Epoch: [38/ 80] | Train loss: [0.10773895738853348]
2022-04-22 12:24:06.439 | INFO     | tools.trainer:train_loop:103 - Epoch: [39/ 80] | Train loss: [0.10950249723262256]
2022-04-22 12:27:42.173 | INFO     | tools.trainer:train_loop:103 - Epoch: [40/ 80] | Train loss: [0.10344025732742415]
2022-04-22 12:31:17.971 | INFO     | tools.trainer:train_loop:103 - Epoch: [41/ 80] | Train loss: [0.10427205537756284]
2022-04-22 12:34:53.767 | INFO     | tools.trainer:train_loop:103 - Epoch: [42/ 80] | Train loss: [0.1059480263127221]
2022-04-22 12:38:29.549 | INFO     | tools.trainer:train_loop:103 - Epoch: [43/ 80] | Train loss: [0.10356567402680715]
2022-04-22 12:42:05.301 | INFO     | tools.trainer:train_loop:103 - Epoch: [44/ 80] | Train loss: [0.10099838574727377]
2022-04-22 12:45:40.890 | INFO     | tools.trainer:train_loop:103 - Epoch: [45/ 80] | Train loss: [0.10241573635074827]
2022-04-22 12:49:16.558 | INFO     | tools.trainer:train_loop:103 - Epoch: [46/ 80] | Train loss: [0.10054391904009713]
2022-04-22 12:52:52.243 | INFO     | tools.trainer:train_loop:103 - Epoch: [47/ 80] | Train loss: [0.0989167046215799]
2022-04-22 12:56:27.923 | INFO     | tools.trainer:train_loop:103 - Epoch: [48/ 80] | Train loss: [0.09377022253142463]
2022-04-22 13:00:03.714 | INFO     | tools.trainer:train_loop:103 - Epoch: [49/ 80] | Train loss: [0.09333047999276055]
2022-04-22 13:03:39.452 | INFO     | tools.trainer:train_loop:103 - Epoch: [50/ 80] | Train loss: [0.09193498972389433]
2022-04-22 13:07:15.098 | INFO     | tools.trainer:train_loop:103 - Epoch: [51/ 80] | Train loss: [0.09116885653800434]
2022-04-22 13:10:50.708 | INFO     | tools.trainer:train_loop:103 - Epoch: [52/ 80] | Train loss: [0.08994308321012391]
2022-04-22 13:14:26.620 | INFO     | tools.trainer:train_loop:103 - Epoch: [53/ 80] | Train loss: [0.08740860049923262]
2022-04-22 13:18:02.448 | INFO     | tools.trainer:train_loop:103 - Epoch: [54/ 80] | Train loss: [0.08655565016799503]
2022-04-22 13:21:38.204 | INFO     | tools.trainer:train_loop:103 - Epoch: [55/ 80] | Train loss: [0.08690835129883555]
2022-04-22 13:25:13.882 | INFO     | tools.trainer:train_loop:103 - Epoch: [56/ 80] | Train loss: [0.08589968573715952]
2022-04-22 13:28:49.597 | INFO     | tools.trainer:train_loop:103 - Epoch: [57/ 80] | Train loss: [0.08531757237182723]
2022-04-22 13:32:25.309 | INFO     | tools.trainer:train_loop:103 - Epoch: [58/ 80] | Train loss: [0.08218600493338372]
2022-04-22 13:36:01.080 | INFO     | tools.trainer:train_loop:103 - Epoch: [59/ 80] | Train loss: [0.08265021046002706]
2022-04-22 13:39:37.029 | INFO     | tools.trainer:train_loop:103 - Epoch: [60/ 80] | Train loss: [0.08343321167760426]
2022-04-22 13:43:12.907 | INFO     | tools.trainer:train_loop:103 - Epoch: [61/ 80] | Train loss: [0.08055218151874012]
2022-04-22 13:46:48.655 | INFO     | tools.trainer:train_loop:103 - Epoch: [62/ 80] | Train loss: [0.07921489891078737]
2022-04-22 13:50:24.307 | INFO     | tools.trainer:train_loop:103 - Epoch: [63/ 80] | Train loss: [0.07781510030229886]
2022-04-22 13:53:59.959 | INFO     | tools.trainer:train_loop:103 - Epoch: [64/ 80] | Train loss: [0.07839464131328795]
2022-04-22 13:57:35.599 | INFO     | tools.trainer:train_loop:103 - Epoch: [65/ 80] | Train loss: [0.07663129013445642]
2022-04-22 14:01:11.322 | INFO     | tools.trainer:train_loop:103 - Epoch: [66/ 80] | Train loss: [0.07512608017358514]
2022-04-22 14:04:46.983 | INFO     | tools.trainer:train_loop:103 - Epoch: [67/ 80] | Train loss: [0.07691824071937137]
2022-04-22 14:08:22.796 | INFO     | tools.trainer:train_loop:103 - Epoch: [68/ 80] | Train loss: [0.07497616538570986]
2022-04-22 14:11:58.692 | INFO     | tools.trainer:train_loop:103 - Epoch: [69/ 80] | Train loss: [0.0748404863393969]
2022-04-22 14:15:34.565 | INFO     | tools.trainer:train_loop:103 - Epoch: [70/ 80] | Train loss: [0.07337862079342207]
2022-04-22 14:19:10.359 | INFO     | tools.trainer:train_loop:103 - Epoch: [71/ 80] | Train loss: [0.07338233035471704]
2022-04-22 14:22:46.303 | INFO     | tools.trainer:train_loop:103 - Epoch: [72/ 80] | Train loss: [0.07242270149290561]
2022-04-22 14:26:22.033 | INFO     | tools.trainer:train_loop:103 - Epoch: [73/ 80] | Train loss: [0.07251872159540654]
2022-04-22 14:29:57.853 | INFO     | tools.trainer:train_loop:103 - Epoch: [74/ 80] | Train loss: [0.07092523268527455]
2022-04-22 14:33:33.842 | INFO     | tools.trainer:train_loop:103 - Epoch: [75/ 80] | Train loss: [0.0704116644958655]
2022-04-22 14:37:09.705 | INFO     | tools.trainer:train_loop:103 - Epoch: [76/ 80] | Train loss: [0.07006360362801287]
2022-04-22 14:40:45.495 | INFO     | tools.trainer:train_loop:103 - Epoch: [77/ 80] | Train loss: [0.06905483963588874]
2022-04-22 14:44:21.284 | INFO     | tools.trainer:train_loop:103 - Epoch: [78/ 80] | Train loss: [0.06908996043105921]
2022-04-22 14:47:57.162 | INFO     | tools.trainer:train_loop:103 - Epoch: [79/ 80] | Train loss: [0.06887979263232814]
2022-04-22 14:51:33.200 | INFO     | tools.trainer:train_loop:103 - Epoch: [80/ 80] | Train loss: [0.06800041881700357]
2022-04-22 14:51:33.404 | INFO     | tools.trainer:train_loop:118 - [Saving Snapshot:]/mnt/data/hungpv/polyps/checkpoint/KCECE/proposed_v10/PVTv2-B3-UPerHead_80.pth
2022-04-22 14:51:33.405 | INFO     | tools.trainer:train_loop:124 - Training cost: 17256.90125244693seconds
