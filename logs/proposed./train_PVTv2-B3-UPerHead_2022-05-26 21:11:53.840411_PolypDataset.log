2022-05-26 21:11:53.844 | INFO     | __main__:main:47 - Load config from configs/proposed.yaml
2022-05-26 21:11:53.844 | INFO     | __main__:main:48 - {'dataset': {'data_path': '/home/admin_mcn/hungpv/polyps/dataset/KCECE', 'train_data_path': ['/home/admin_mcn/hungpv/polyps/dataset/KCECE/TrainDataset'], 'test_data_path': ['/home/admin_mcn/hungpv/polyps/dataset/KCECE/TestDataset/Kvasir'], 'val_data_path': ['/home/admin_mcn/hungpv/polyps/dataset/KCECE/TestDataset/CVC-300']}, 'model': {'num_classes': 1, 'save_dir': '/mnt/data/hungpv/polyps/checkpoint/KCECE/proposed_v6', 'backbone': 'PVTv2-B3', 'head': 'UPerHead', 'pretrained': '/mnt/data/hungpv/polyps/pretrained-backbone/pvt_v2_b3.pth'}, 'optimizer': {'name': 'adamw', 'lr': 0.0001, 'clip': 0.5, 'scheduler': 'cosine_warmup', 'loss': 'structure_loss'}, 'dev': 'cuda', 'train': {'start_from': 0, 'save_from': 79, 'num_epochs': 80, 'num_warmup_epoch': 10, 'is_val': False, 'size_rates': [0.75, 1, 1.25], 'dataloader': {'batchsize': 16, 'img_size': 352, 'shuffle': True, 'num_workers': 2, 'pin_memory': True, 'drop_last': True}, 'amp': False, 'ddp': False, 'augment': {'prob': 1, 'Flip_prob': 0.5, 'HueSaturationValue_prob': 0.5, 'RandomBrightnessContrast_prob': 0.5, 'crop_prob': 0.0, 'randomrotate90_prob': 0.7}}, 'test': {'dev': 'cuda', 'visualize': False, 'visualize_dir': '/mnt/data/hungpv/polyps/visualize', 'vis_x': 180, 'vis_overwrite': False, 'checkpoint_dir': '/mnt/data/hungpv/polyps/checkpoint/KCECE/proposed_v6/PVTv2-B3-UPerHead_60.pth', 'dataloader': {'batchsize': 1, 'img_size': 352, 'shuffle': True, 'num_workers': 2, 'pin_memory': True, 'drop_last': True}, 'augment': {'prob': 1, 'Flip_prob': 0, 'HueSaturationValue_prob': 0, 'RandomBrightnessContrast_prob': 0, 'crop_prob': 0, 'randomrotate90_prob': 0, 'elastictransform_prob': 0, 'gridistortion_prob': 0, 'opticaldistortion_prob': 0, 'verticalflip_prob': 0, 'horizontalflip_prob': 0, 'randomgamma_prob': 0, 'CoarseDropout_prob': 0, 'RGBShift_prob': 0, 'MotionBlur_prob': 0, 'MedianBlur_prob': 0, 'GaussianBlur_prob': 0, 'GaussNoise_prob': 0, 'ChannelShuffle_prob': 0}}}
2022-05-26 21:11:53.844 | INFO     | __main__:main:49 - Getting datapath
2022-05-26 21:11:53.849 | INFO     | __main__:main:63 - There are 1450 images to train
2022-05-26 21:11:53.849 | INFO     | __main__:main:82 - Train model with no valid dataset
2022-05-26 21:11:53.849 | INFO     | __main__:main:84 - Loading data
2022-05-26 21:11:53.914 | INFO     | __main__:main:98 - 90 batches to train
2022-05-26 21:11:53.917 | INFO     | __main__:main:111 - Loading model
2022-05-26 21:11:53.917 | INFO     | __main__:main:132 - Loading checkpoint from /mnt/data/hungpv/polyps/pretrained-backbone/pvt_v2_b3.pth ...
2022-05-26 21:11:57.055 | INFO     | __main__:main:175 - Training with FP32 ...
2022-05-26 21:15:23.418 | INFO     | tools.trainer:train_loop:103 - Epoch: [1/ 80] | Train loss: [3.0096822294923995]
2022-05-26 21:18:53.633 | INFO     | tools.trainer:train_loop:103 - Epoch: [2/ 80] | Train loss: [0.9956957426336076]
2022-05-26 21:22:22.136 | INFO     | tools.trainer:train_loop:103 - Epoch: [3/ 80] | Train loss: [0.7313129636976454]
2022-05-26 21:22:22.821 | INFO     | tools.trainer:train_loop:115 - [Saving Snapshot:]/mnt/data/hungpv/polyps/checkpoint/KCECE/proposed_v6/PVTv2-B3-UPerHead_3.pth
2022-05-26 21:25:41.160 | INFO     | tools.trainer:train_loop:103 - Epoch: [4/ 80] | Train loss: [0.5677666048208873]
2022-05-26 21:28:58.272 | INFO     | tools.trainer:train_loop:103 - Epoch: [5/ 80] | Train loss: [0.48397636976506975]
2022-05-26 21:32:14.826 | INFO     | tools.trainer:train_loop:103 - Epoch: [6/ 80] | Train loss: [0.40701691839430065]
2022-05-26 21:35:36.907 | INFO     | tools.trainer:train_loop:103 - Epoch: [7/ 80] | Train loss: [0.4033815681934357]
2022-05-26 21:39:06.323 | INFO     | tools.trainer:train_loop:103 - Epoch: [8/ 80] | Train loss: [0.3681928705837991]
2022-05-26 21:42:41.054 | INFO     | tools.trainer:train_loop:103 - Epoch: [9/ 80] | Train loss: [0.3106171344717344]
2022-05-26 21:46:13.309 | INFO     | tools.trainer:train_loop:103 - Epoch: [10/ 80] | Train loss: [0.2679016520579656]
2022-05-26 21:49:44.137 | INFO     | tools.trainer:train_loop:103 - Epoch: [11/ 80] | Train loss: [0.2567681771185663]
2022-05-26 21:53:12.611 | INFO     | tools.trainer:train_loop:103 - Epoch: [12/ 80] | Train loss: [0.27015769431988396]
2022-05-26 21:56:42.383 | INFO     | tools.trainer:train_loop:103 - Epoch: [13/ 80] | Train loss: [0.2288153981169065]
2022-05-26 22:00:10.594 | INFO     | tools.trainer:train_loop:103 - Epoch: [14/ 80] | Train loss: [0.21076206697358024]
2022-05-26 22:03:38.783 | INFO     | tools.trainer:train_loop:103 - Epoch: [15/ 80] | Train loss: [0.19181953453355366]
2022-05-26 22:07:11.385 | INFO     | tools.trainer:train_loop:103 - Epoch: [16/ 80] | Train loss: [0.2027968082163069]
2022-05-26 22:10:45.255 | INFO     | tools.trainer:train_loop:103 - Epoch: [17/ 80] | Train loss: [0.19457716229889127]
2022-05-26 22:14:19.953 | INFO     | tools.trainer:train_loop:103 - Epoch: [18/ 80] | Train loss: [0.1830359665883912]
2022-05-26 22:17:55.190 | INFO     | tools.trainer:train_loop:103 - Epoch: [19/ 80] | Train loss: [0.18350555524230003]
2022-05-26 22:21:31.480 | INFO     | tools.trainer:train_loop:103 - Epoch: [20/ 80] | Train loss: [0.17054083810912238]
2022-05-26 22:25:05.063 | INFO     | tools.trainer:train_loop:103 - Epoch: [21/ 80] | Train loss: [0.15941999182105066]
2022-05-26 22:28:37.553 | INFO     | tools.trainer:train_loop:103 - Epoch: [22/ 80] | Train loss: [0.172420930945211]
2022-05-26 22:32:09.520 | INFO     | tools.trainer:train_loop:103 - Epoch: [23/ 80] | Train loss: [0.18565342335237398]
2022-05-26 22:35:39.771 | INFO     | tools.trainer:train_loop:103 - Epoch: [24/ 80] | Train loss: [0.16786466472678716]
2022-05-26 22:38:59.426 | INFO     | tools.trainer:train_loop:103 - Epoch: [25/ 80] | Train loss: [0.15786558248930507]
2022-05-26 22:42:11.177 | INFO     | tools.trainer:train_loop:103 - Epoch: [26/ 80] | Train loss: [0.15019885152578355]
2022-05-26 22:45:21.789 | INFO     | tools.trainer:train_loop:103 - Epoch: [27/ 80] | Train loss: [0.15812467907865843]
2022-05-26 22:48:32.245 | INFO     | tools.trainer:train_loop:103 - Epoch: [28/ 80] | Train loss: [0.14472239679760404]
2022-05-26 22:51:43.555 | INFO     | tools.trainer:train_loop:103 - Epoch: [29/ 80] | Train loss: [0.14256307267480425]
2022-05-26 22:54:53.968 | INFO     | tools.trainer:train_loop:103 - Epoch: [30/ 80] | Train loss: [0.13582056396537356]
2022-05-26 22:58:04.540 | INFO     | tools.trainer:train_loop:103 - Epoch: [31/ 80] | Train loss: [0.1477522525522444]
2022-05-26 23:01:15.459 | INFO     | tools.trainer:train_loop:103 - Epoch: [32/ 80] | Train loss: [0.14989473952187432]
2022-05-26 23:04:26.091 | INFO     | tools.trainer:train_loop:103 - Epoch: [33/ 80] | Train loss: [0.13693929041425387]
2022-05-26 23:07:36.909 | INFO     | tools.trainer:train_loop:103 - Epoch: [34/ 80] | Train loss: [0.1465603109035227]
2022-05-26 23:10:48.177 | INFO     | tools.trainer:train_loop:103 - Epoch: [35/ 80] | Train loss: [0.13782436748345692]
2022-05-26 23:13:59.379 | INFO     | tools.trainer:train_loop:103 - Epoch: [36/ 80] | Train loss: [0.12895173099305896]
2022-05-26 23:17:10.395 | INFO     | tools.trainer:train_loop:103 - Epoch: [37/ 80] | Train loss: [0.13019223378764258]
2022-05-26 23:20:21.302 | INFO     | tools.trainer:train_loop:103 - Epoch: [38/ 80] | Train loss: [0.12231969932715098]
2022-05-26 23:23:32.192 | INFO     | tools.trainer:train_loop:103 - Epoch: [39/ 80] | Train loss: [0.12193004083302286]
2022-05-26 23:26:43.001 | INFO     | tools.trainer:train_loop:103 - Epoch: [40/ 80] | Train loss: [0.12585672131843037]
2022-05-26 23:29:53.945 | INFO     | tools.trainer:train_loop:103 - Epoch: [41/ 80] | Train loss: [0.11981145582265323]
2022-05-26 23:33:05.227 | INFO     | tools.trainer:train_loop:103 - Epoch: [42/ 80] | Train loss: [0.13933725986215803]
2022-05-26 23:36:16.530 | INFO     | tools.trainer:train_loop:103 - Epoch: [43/ 80] | Train loss: [0.1254631677435504]
2022-05-26 23:39:27.379 | INFO     | tools.trainer:train_loop:103 - Epoch: [44/ 80] | Train loss: [0.11434593796730042]
2022-05-26 23:42:38.389 | INFO     | tools.trainer:train_loop:103 - Epoch: [45/ 80] | Train loss: [0.11115806698799133]
2022-05-26 23:45:49.336 | INFO     | tools.trainer:train_loop:103 - Epoch: [46/ 80] | Train loss: [0.10849852859973907]
2022-05-26 23:49:00.178 | INFO     | tools.trainer:train_loop:103 - Epoch: [47/ 80] | Train loss: [0.10737432746423616]
2022-05-26 23:52:10.767 | INFO     | tools.trainer:train_loop:103 - Epoch: [48/ 80] | Train loss: [0.10821665624777475]
2022-05-26 23:55:21.218 | INFO     | tools.trainer:train_loop:103 - Epoch: [49/ 80] | Train loss: [0.10495326411392954]
2022-05-26 23:58:31.524 | INFO     | tools.trainer:train_loop:103 - Epoch: [50/ 80] | Train loss: [0.10256171565916804]
2022-05-27 00:01:41.487 | INFO     | tools.trainer:train_loop:103 - Epoch: [51/ 80] | Train loss: [0.10402727358871036]
2022-05-27 00:04:51.596 | INFO     | tools.trainer:train_loop:103 - Epoch: [52/ 80] | Train loss: [0.10340388715267182]
2022-05-27 00:08:01.941 | INFO     | tools.trainer:train_loop:103 - Epoch: [53/ 80] | Train loss: [0.10077563143438763]
2022-05-27 00:11:12.388 | INFO     | tools.trainer:train_loop:103 - Epoch: [54/ 80] | Train loss: [0.0976685956120491]
2022-05-27 00:14:23.396 | INFO     | tools.trainer:train_loop:103 - Epoch: [55/ 80] | Train loss: [0.09617253078354729]
2022-05-27 00:17:35.995 | INFO     | tools.trainer:train_loop:103 - Epoch: [56/ 80] | Train loss: [0.09689944742454423]
2022-05-27 00:20:59.274 | INFO     | tools.trainer:train_loop:103 - Epoch: [57/ 80] | Train loss: [0.09620369788673189]
2022-05-27 00:24:26.969 | INFO     | tools.trainer:train_loop:103 - Epoch: [58/ 80] | Train loss: [0.10156398076150153]
2022-05-27 00:27:58.499 | INFO     | tools.trainer:train_loop:103 - Epoch: [59/ 80] | Train loss: [0.09662250528732935]
2022-05-27 00:31:34.038 | INFO     | tools.trainer:train_loop:103 - Epoch: [60/ 80] | Train loss: [0.09461561400029395]
2022-05-27 00:35:13.576 | INFO     | tools.trainer:train_loop:103 - Epoch: [61/ 80] | Train loss: [0.09161410141322347]
2022-05-27 00:38:55.515 | INFO     | tools.trainer:train_loop:103 - Epoch: [62/ 80] | Train loss: [0.09061694136924214]
2022-05-27 00:42:37.120 | INFO     | tools.trainer:train_loop:103 - Epoch: [63/ 80] | Train loss: [0.08901653264959654]
2022-05-27 00:46:15.431 | INFO     | tools.trainer:train_loop:103 - Epoch: [64/ 80] | Train loss: [0.0887949970861276]
2022-05-27 00:49:50.627 | INFO     | tools.trainer:train_loop:103 - Epoch: [65/ 80] | Train loss: [0.08668592448035876]
2022-05-27 00:53:24.010 | INFO     | tools.trainer:train_loop:103 - Epoch: [66/ 80] | Train loss: [0.08646892350580958]
2022-05-27 00:56:58.285 | INFO     | tools.trainer:train_loop:103 - Epoch: [67/ 80] | Train loss: [0.08631757017638948]
2022-05-27 01:00:30.871 | INFO     | tools.trainer:train_loop:103 - Epoch: [68/ 80] | Train loss: [0.0866819607714812]
2022-05-27 01:04:04.483 | INFO     | tools.trainer:train_loop:103 - Epoch: [69/ 80] | Train loss: [0.08445810286535158]
2022-05-27 01:07:38.757 | INFO     | tools.trainer:train_loop:103 - Epoch: [70/ 80] | Train loss: [0.08304759156372812]
2022-05-27 01:11:13.717 | INFO     | tools.trainer:train_loop:103 - Epoch: [71/ 80] | Train loss: [0.08240211614304119]
2022-05-27 01:14:52.476 | INFO     | tools.trainer:train_loop:103 - Epoch: [72/ 80] | Train loss: [0.08206622302532196]
2022-05-27 01:18:33.773 | INFO     | tools.trainer:train_loop:103 - Epoch: [73/ 80] | Train loss: [0.08141402353843054]
2022-05-27 01:22:16.310 | INFO     | tools.trainer:train_loop:103 - Epoch: [74/ 80] | Train loss: [0.08010273302594821]
2022-05-27 01:25:59.277 | INFO     | tools.trainer:train_loop:103 - Epoch: [75/ 80] | Train loss: [0.08022334981295798]
2022-05-27 01:29:43.355 | INFO     | tools.trainer:train_loop:103 - Epoch: [76/ 80] | Train loss: [0.07831418356961674]
2022-05-27 01:33:28.297 | INFO     | tools.trainer:train_loop:103 - Epoch: [77/ 80] | Train loss: [0.078763921931386]
2022-05-27 01:37:10.278 | INFO     | tools.trainer:train_loop:103 - Epoch: [78/ 80] | Train loss: [0.0781375820438067]
2022-05-27 01:40:48.972 | INFO     | tools.trainer:train_loop:103 - Epoch: [79/ 80] | Train loss: [0.07747185205419858]
2022-05-27 01:44:25.838 | INFO     | tools.trainer:train_loop:103 - Epoch: [80/ 80] | Train loss: [0.07614423947201834]
2022-05-27 01:44:26.039 | INFO     | tools.trainer:train_loop:115 - [Saving Snapshot:]/mnt/data/hungpv/polyps/checkpoint/KCECE/proposed_v6/PVTv2-B3-UPerHead_80.pth
2022-05-27 01:44:26.039 | INFO     | tools.trainer:train_loop:124 - Training cost: 16348.012781879981seconds
