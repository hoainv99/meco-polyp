2022-03-31 00:39:01.895 | INFO     | __main__:main:45 - Load config from configs/pvtv2-uperhead.yaml
2022-03-31 00:39:01.895 | INFO     | __main__:main:46 - {'dataset': {'data_path': '/home/admin_mcn/hungpv/polyps/dataset/KCECE', 'train_data_path': ['/home/admin_mcn/hungpv/polyps/dataset/KCECE/TrainDataset'], 'test_data_path': ['/home/admin_mcn/hungpv/polyps/dataset/KCECE/TestDataset/Kvasir'], 'val_data_path': ['/home/admin_mcn/hungpv/polyps/dataset/KCECE/TestDataset/CVC-300']}, 'model': {'num_classes': 1, 'save_dir': '/mnt/data/hungpv/polyps/checkpoint/KCECE/pvtv2-uperhead_v14', 'backbone': 'PVTv2-B3', 'head': 'UPerHead', 'pretrained': '/mnt/data/hungpv/polyps/pretrained-backbone/pvt_v2_b3.pth'}, 'optimizer': {'name': 'adam', 'lr': 0.0001, 'clip': 0.5, 'scheduler': 'cosine_warmup', 'loss': 'structure_loss'}, 'dev': 'cuda', 'train': {'start_from': 0, 'save_from': 78, 'num_epochs': 80, 'num_warmup_epoch': 10, 'is_val': False, 'size_rates': [0.75, 1, 1.25], 'dataloader': {'batchsize': 16, 'img_size': 352, 'shuffle': True, 'num_workers': 2, 'pin_memory': True, 'drop_last': True}, 'amp': False, 'ddp': False, 'augment': {'prob': 1, 'Flip_prob': 0.7, 'HueSaturationValue_prob': 0.7, 'RandomBrightnessContrast_prob': 0.5, 'crop_prob': 0.0, 'randomrotate90_prob': 0.7}}, 'test': {'dev': 'cuda', 'visualize': False, 'visualize_dir': '/mnt/data/hungpv/polyps/visualize', 'vis_x': 180, 'vis_overwrite': False, 'checkpoint_dir': '/mnt/data/hungpv/polyps/checkpoint/KCECE/pvtv2-uperhead_v12/PVTv2-B3-UPerHead_80.pth', 'dataloader': {'batchsize': 1, 'img_size': 352, 'shuffle': True, 'num_workers': 2, 'pin_memory': True, 'drop_last': True}, 'augment': {'prob': 1, 'Flip_prob': 0, 'HueSaturationValue_prob': 0, 'RandomBrightnessContrast_prob': 0, 'crop_prob': 0, 'randomrotate90_prob': 0, 'elastictransform_prob': 0, 'gridistortion_prob': 0, 'opticaldistortion_prob': 0, 'verticalflip_prob': 0, 'horizontalflip_prob': 0, 'randomgamma_prob': 0, 'CoarseDropout_prob': 0, 'RGBShift_prob': 0, 'MotionBlur_prob': 0, 'MedianBlur_prob': 0, 'GaussianBlur_prob': 0, 'GaussNoise_prob': 0, 'ChannelShuffle_prob': 0}}}
2022-03-31 00:39:01.895 | INFO     | __main__:main:47 - Getting datapath
2022-03-31 00:39:01.901 | INFO     | __main__:main:61 - There are 1450 images to train
2022-03-31 00:39:01.902 | INFO     | __main__:main:80 - Train model with no valid dataset
2022-03-31 00:39:01.902 | INFO     | __main__:main:82 - Loading data
2022-03-31 00:39:01.993 | INFO     | __main__:main:96 - 90 batches to train
2022-03-31 00:39:01.997 | INFO     | __main__:main:109 - Loading model
2022-03-31 00:39:01.997 | INFO     | __main__:main:126 - Loading checkpoint from /mnt/data/hungpv/polyps/pretrained-backbone/pvt_v2_b3.pth ...
2022-03-31 00:39:04.568 | INFO     | __main__:main:164 - Training with FP32 ...
2022-03-31 00:42:53.628 | INFO     | tools.trainer:train_loop:89 - Epoch: [1/ 80] | Train loss: [1.7544401632414923]
2022-03-31 00:46:42.157 | INFO     | tools.trainer:train_loop:89 - Epoch: [2/ 80] | Train loss: [0.7174165782001284]
2022-03-31 00:50:30.603 | INFO     | tools.trainer:train_loop:89 - Epoch: [3/ 80] | Train loss: [0.5442689157194561]
2022-03-31 00:50:30.814 | INFO     | tools.trainer:train_loop:104 - [Saving Snapshot:]/mnt/data/hungpv/polyps/checkpoint/KCECE/pvtv2-uperhead_v14/PVTv2-B3-UPerHead_3.pth
2022-03-31 00:54:19.369 | INFO     | tools.trainer:train_loop:89 - Epoch: [4/ 80] | Train loss: [0.42731906589534546]
2022-03-31 00:58:07.936 | INFO     | tools.trainer:train_loop:89 - Epoch: [5/ 80] | Train loss: [0.35603334191772673]
2022-03-31 01:01:56.643 | INFO     | tools.trainer:train_loop:89 - Epoch: [6/ 80] | Train loss: [0.3012519119514359]
2022-03-31 01:05:45.267 | INFO     | tools.trainer:train_loop:89 - Epoch: [7/ 80] | Train loss: [0.27028073254558777]
2022-03-31 01:09:33.834 | INFO     | tools.trainer:train_loop:89 - Epoch: [8/ 80] | Train loss: [0.25290896627638076]
2022-03-31 01:13:22.651 | INFO     | tools.trainer:train_loop:89 - Epoch: [9/ 80] | Train loss: [0.22701286094056236]
2022-03-31 01:17:11.260 | INFO     | tools.trainer:train_loop:89 - Epoch: [10/ 80] | Train loss: [0.21255670951472388]
2022-03-31 01:20:59.847 | INFO     | tools.trainer:train_loop:89 - Epoch: [11/ 80] | Train loss: [0.2022024111615287]
2022-03-31 01:24:48.581 | INFO     | tools.trainer:train_loop:89 - Epoch: [12/ 80] | Train loss: [0.20433701243665484]
2022-03-31 01:28:37.294 | INFO     | tools.trainer:train_loop:89 - Epoch: [13/ 80] | Train loss: [0.19736267452438672]
2022-03-31 01:32:26.037 | INFO     | tools.trainer:train_loop:89 - Epoch: [14/ 80] | Train loss: [0.17624375232391887]
2022-03-31 01:36:14.754 | INFO     | tools.trainer:train_loop:89 - Epoch: [15/ 80] | Train loss: [0.1794631778366036]
2022-03-31 01:40:03.384 | INFO     | tools.trainer:train_loop:89 - Epoch: [16/ 80] | Train loss: [0.1651701888276471]
2022-03-31 01:43:51.899 | INFO     | tools.trainer:train_loop:89 - Epoch: [17/ 80] | Train loss: [0.17036713270677462]
2022-03-31 01:47:40.563 | INFO     | tools.trainer:train_loop:89 - Epoch: [18/ 80] | Train loss: [0.16156803369522094]
2022-03-31 01:51:29.338 | INFO     | tools.trainer:train_loop:89 - Epoch: [19/ 80] | Train loss: [0.1509388058549828]
2022-03-31 01:55:18.141 | INFO     | tools.trainer:train_loop:89 - Epoch: [20/ 80] | Train loss: [0.15642552458577685]
2022-03-31 01:59:06.592 | INFO     | tools.trainer:train_loop:89 - Epoch: [21/ 80] | Train loss: [0.14567673421568342]
2022-03-31 02:02:55.325 | INFO     | tools.trainer:train_loop:89 - Epoch: [22/ 80] | Train loss: [0.13866613308588663]
2022-03-31 02:06:43.832 | INFO     | tools.trainer:train_loop:89 - Epoch: [23/ 80] | Train loss: [0.13343151302801237]
2022-03-31 02:10:32.478 | INFO     | tools.trainer:train_loop:89 - Epoch: [24/ 80] | Train loss: [0.13772616154617734]
2022-03-31 02:14:21.131 | INFO     | tools.trainer:train_loop:89 - Epoch: [25/ 80] | Train loss: [0.13535446110698912]
2022-03-31 02:18:09.674 | INFO     | tools.trainer:train_loop:89 - Epoch: [26/ 80] | Train loss: [0.13393893647525046]
2022-03-31 02:21:58.315 | INFO     | tools.trainer:train_loop:89 - Epoch: [27/ 80] | Train loss: [0.13823556693063843]
2022-03-31 02:25:46.841 | INFO     | tools.trainer:train_loop:89 - Epoch: [28/ 80] | Train loss: [0.13510682682196298]
2022-03-31 02:29:35.573 | INFO     | tools.trainer:train_loop:89 - Epoch: [29/ 80] | Train loss: [0.13278112635016442]
2022-03-31 02:33:24.125 | INFO     | tools.trainer:train_loop:89 - Epoch: [30/ 80] | Train loss: [0.12379807208975156]
2022-03-31 02:37:12.853 | INFO     | tools.trainer:train_loop:89 - Epoch: [31/ 80] | Train loss: [0.1213372405204508]
2022-03-31 02:41:01.515 | INFO     | tools.trainer:train_loop:89 - Epoch: [32/ 80] | Train loss: [0.11694228756758902]
2022-03-31 02:44:50.257 | INFO     | tools.trainer:train_loop:89 - Epoch: [33/ 80] | Train loss: [0.1282066230972608]
2022-03-31 02:48:38.818 | INFO     | tools.trainer:train_loop:89 - Epoch: [34/ 80] | Train loss: [0.11981206577685144]
2022-03-31 02:52:27.318 | INFO     | tools.trainer:train_loop:89 - Epoch: [35/ 80] | Train loss: [0.11898314754168192]
2022-03-31 02:56:15.980 | INFO     | tools.trainer:train_loop:89 - Epoch: [36/ 80] | Train loss: [0.11367751931150755]
2022-03-31 03:00:04.552 | INFO     | tools.trainer:train_loop:89 - Epoch: [37/ 80] | Train loss: [0.11052244868543414]
2022-03-31 03:03:53.374 | INFO     | tools.trainer:train_loop:89 - Epoch: [38/ 80] | Train loss: [0.10735389581984944]
2022-03-31 03:07:42.073 | INFO     | tools.trainer:train_loop:89 - Epoch: [39/ 80] | Train loss: [0.11041137278079986]
2022-03-31 03:11:30.629 | INFO     | tools.trainer:train_loop:89 - Epoch: [40/ 80] | Train loss: [0.10468552559614182]
2022-03-31 03:15:19.290 | INFO     | tools.trainer:train_loop:89 - Epoch: [41/ 80] | Train loss: [0.10352320356501474]
2022-03-31 03:19:08.094 | INFO     | tools.trainer:train_loop:89 - Epoch: [42/ 80] | Train loss: [0.10211323069201575]
2022-03-31 03:22:56.674 | INFO     | tools.trainer:train_loop:89 - Epoch: [43/ 80] | Train loss: [0.11187758727206124]
2022-03-31 03:26:45.454 | INFO     | tools.trainer:train_loop:89 - Epoch: [44/ 80] | Train loss: [0.10339898251824908]
2022-03-31 03:30:34.011 | INFO     | tools.trainer:train_loop:89 - Epoch: [45/ 80] | Train loss: [0.10159968137741089]
2022-03-31 03:34:22.637 | INFO     | tools.trainer:train_loop:89 - Epoch: [46/ 80] | Train loss: [0.0962379133535756]
2022-03-31 03:38:11.242 | INFO     | tools.trainer:train_loop:89 - Epoch: [47/ 80] | Train loss: [0.09582526774870025]
2022-03-31 03:41:59.928 | INFO     | tools.trainer:train_loop:89 - Epoch: [48/ 80] | Train loss: [0.0937723179658254]
2022-03-31 03:45:48.643 | INFO     | tools.trainer:train_loop:89 - Epoch: [49/ 80] | Train loss: [0.09212410805953873]
2022-03-31 03:49:37.354 | INFO     | tools.trainer:train_loop:89 - Epoch: [50/ 80] | Train loss: [0.09093708097934723]
2022-03-31 03:53:25.813 | INFO     | tools.trainer:train_loop:89 - Epoch: [51/ 80] | Train loss: [0.0912039024134477]
2022-03-31 03:57:14.458 | INFO     | tools.trainer:train_loop:89 - Epoch: [52/ 80] | Train loss: [0.09221456597248713]
2022-03-31 04:01:03.286 | INFO     | tools.trainer:train_loop:89 - Epoch: [53/ 80] | Train loss: [0.09239472796519597]
2022-03-31 04:04:51.923 | INFO     | tools.trainer:train_loop:89 - Epoch: [54/ 80] | Train loss: [0.08925746762090259]
2022-03-31 04:08:40.681 | INFO     | tools.trainer:train_loop:89 - Epoch: [55/ 80] | Train loss: [0.08802994729744064]
2022-03-31 04:12:29.356 | INFO     | tools.trainer:train_loop:89 - Epoch: [56/ 80] | Train loss: [0.08655291903350089]
2022-03-31 04:16:18.031 | INFO     | tools.trainer:train_loop:89 - Epoch: [57/ 80] | Train loss: [0.08358157616522577]
2022-03-31 04:20:06.523 | INFO     | tools.trainer:train_loop:89 - Epoch: [58/ 80] | Train loss: [0.0840095797346698]
2022-03-31 04:23:55.129 | INFO     | tools.trainer:train_loop:89 - Epoch: [59/ 80] | Train loss: [0.08186404920286602]
2022-03-31 04:27:43.737 | INFO     | tools.trainer:train_loop:89 - Epoch: [60/ 80] | Train loss: [0.08157379743125703]
2022-03-31 04:31:32.383 | INFO     | tools.trainer:train_loop:89 - Epoch: [61/ 80] | Train loss: [0.08109456822276115]
2022-03-31 04:35:20.891 | INFO     | tools.trainer:train_loop:89 - Epoch: [62/ 80] | Train loss: [0.07891454291012552]
2022-03-31 04:39:09.385 | INFO     | tools.trainer:train_loop:89 - Epoch: [63/ 80] | Train loss: [0.07715227239661747]
2022-03-31 04:42:57.794 | INFO     | tools.trainer:train_loop:89 - Epoch: [64/ 80] | Train loss: [0.07780493444038762]
2022-03-31 04:46:45.967 | INFO     | tools.trainer:train_loop:89 - Epoch: [65/ 80] | Train loss: [0.07707372415396903]
2022-03-31 04:50:34.587 | INFO     | tools.trainer:train_loop:89 - Epoch: [66/ 80] | Train loss: [0.07635062535603841]
2022-03-31 04:54:23.208 | INFO     | tools.trainer:train_loop:89 - Epoch: [67/ 80] | Train loss: [0.07595445869697465]
2022-03-31 04:58:11.842 | INFO     | tools.trainer:train_loop:89 - Epoch: [68/ 80] | Train loss: [0.07467205607228809]
2022-03-31 05:02:00.409 | INFO     | tools.trainer:train_loop:89 - Epoch: [69/ 80] | Train loss: [0.07476535733375285]
2022-03-31 05:05:49.070 | INFO     | tools.trainer:train_loop:89 - Epoch: [70/ 80] | Train loss: [0.07276679542329577]
2022-03-31 05:09:37.725 | INFO     | tools.trainer:train_loop:89 - Epoch: [71/ 80] | Train loss: [0.07261305244432556]
2022-03-31 05:13:26.440 | INFO     | tools.trainer:train_loop:89 - Epoch: [72/ 80] | Train loss: [0.07190132045911418]
2022-03-31 05:17:15.073 | INFO     | tools.trainer:train_loop:89 - Epoch: [73/ 80] | Train loss: [0.07186828048692809]
2022-03-31 05:21:03.763 | INFO     | tools.trainer:train_loop:89 - Epoch: [74/ 80] | Train loss: [0.07090407005614704]
2022-03-31 05:24:52.615 | INFO     | tools.trainer:train_loop:89 - Epoch: [75/ 80] | Train loss: [0.07009770394199424]
2022-03-31 05:28:41.274 | INFO     | tools.trainer:train_loop:89 - Epoch: [76/ 80] | Train loss: [0.07119356695976523]
2022-03-31 05:32:29.974 | INFO     | tools.trainer:train_loop:89 - Epoch: [77/ 80] | Train loss: [0.06983791171676583]
2022-03-31 05:36:18.611 | INFO     | tools.trainer:train_loop:89 - Epoch: [78/ 80] | Train loss: [0.06966748908162117]
2022-03-31 05:40:07.221 | INFO     | tools.trainer:train_loop:89 - Epoch: [79/ 80] | Train loss: [0.0687824664844407]
2022-03-31 05:40:07.425 | INFO     | tools.trainer:train_loop:104 - [Saving Snapshot:]/mnt/data/hungpv/polyps/checkpoint/KCECE/pvtv2-uperhead_v14/PVTv2-B3-UPerHead_79.pth
2022-03-31 05:43:56.023 | INFO     | tools.trainer:train_loop:89 - Epoch: [80/ 80] | Train loss: [0.068601230200794]
2022-03-31 05:43:56.243 | INFO     | tools.trainer:train_loop:104 - [Saving Snapshot:]/mnt/data/hungpv/polyps/checkpoint/KCECE/pvtv2-uperhead_v14/PVTv2-B3-UPerHead_80.pth
2022-03-31 05:43:56.243 | INFO     | tools.trainer:train_loop:110 - Training cost: 18290.692553778004seconds
