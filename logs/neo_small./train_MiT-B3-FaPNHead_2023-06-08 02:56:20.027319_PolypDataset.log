2023-06-08 02:56:20.031 | INFO     | __main__:main:57 - Load config from configs/neo_small.yaml
2023-06-08 02:56:20.031 | INFO     | __main__:main:58 - {'dataset': {'data_path': '/root/neo_code_reco_mb/bkai-igh-neopolyp', 'train_data_path': ['/root/neo_code_reco_mb/bkai-igh-neopolyp'], 'test_data_path': ['/root/neo_code_reco_mb/bkai-igh-neopolyp/test/test'], 'val_data_path': ['/root/neo_code_reco_mb/bkai-igh-neopolyp']}, 'model': {'num_classes': 3, 'save_dir': '/root/neo_code_reco_mb/configs/checkpoint0606', 'backbone': 'MiT-B3', 'head': 'FaPNHead', 'pretrained': 'mit_b3.pth'}, 'optimizer': {'name': 'adam', 'lr': 0.0001, 'clip': 0.5, 'scheduler': 'cosine_warmup', 'loss': 'multi_structure_loss'}, 'dev': 'cuda', 'train': {'start_from': 0, 'save_from': 99, 'num_epochs': 100, 'num_warmup_epoch': 8, 'is_val': False, 'size_rates': [0.75, 1, 1.25], 'dataloader': {'batchsize': 8, 'img_size': 384, 'shuffle': True, 'num_workers': 4, 'pin_memory': True, 'drop_last': True}, 'amp': False, 'ddp': False, 'augment': {'prob': 1, 'Flip_prob': 0.5, 'HueSaturationValue_prob': 0.5, 'RandomBrightnessContrast_prob': 0.5, 'crop_prob': 0.0, 'randomrotate90_prob': 0.5, 'ColorJitter_prob': 0.5}, 'augment_weak': {'prob': 1, 'Flip_prob': 0.5}}, 'val': {'dataloader': {'batchsize': 8, 'img_size': 384, 'shuffle': True, 'num_workers': 4, 'pin_memory': True, 'drop_last': False}}, 'test': {'dev': 'cuda', 'visualize': True, 'visualize_dir': '/root/neo_code_reco_mb/neo_visualize', 'vis_x': 180, 'vis_overwrite': False, 'checkpoint_dir': '/root/neo_code_reco_mb/configs/checkpoint0606/MiT-B3-FaPNHead_100_teacher.pth', 'dataloader': {'batchsize': 1, 'img_size': 384, 'shuffle': True, 'num_workers': 4, 'pin_memory': True, 'drop_last': False}, 'augment': {'prob': 1, 'Flip_prob': 0, 'HueSaturationValue_prob': 0, 'RandomBrightnessContrast_prob': 0, 'crop_prob': 0, 'randomrotate90_prob': 0, 'elastictransform_prob': 0, 'gridistortion_prob': 0, 'opticaldistortion_prob': 0, 'verticalflip_prob': 0, 'horizontalflip_prob': 0, 'randomgamma_prob': 0, 'CoarseDropout_prob': 0, 'RGBShift_prob': 0, 'MotionBlur_prob': 0, 'MedianBlur_prob': 0, 'GaussianBlur_prob': 0, 'GaussNoise_prob': 0, 'ChannelShuffle_prob': 0}}}
2023-06-08 02:56:20.032 | INFO     | __main__:main:59 - Getting datapath
2023-06-08 02:56:20.039 | INFO     | __main__:main:74 - There are 1000 images to train
2023-06-08 02:56:20.039 | INFO     | __main__:main:93 - Train model with no valid dataset
2023-06-08 02:56:20.039 | INFO     | __main__:main:95 - Loading data
2023-06-08 02:56:20.406 | INFO     | __main__:main:112 - 125 batches to train
2023-06-08 02:56:20.406 | INFO     | __main__:main:125 - Loading model
2023-06-08 02:56:20.406 | INFO     | __main__:main:146 - Loading checkpoint from mit_b3.pth ...
2023-06-08 02:56:25.974 | INFO     | __main__:main:190 - Training with FP32 ...
2023-06-08 03:01:43.212 | INFO     | trainer:train_loop:182 - Epoch: [1/ 100] | Train loss: [1.6183158864974976]
2023-06-08 03:07:02.485 | INFO     | trainer:train_loop:182 - Epoch: [2/ 100] | Train loss: [0.6780528655052185]
2023-06-08 03:12:20.962 | INFO     | trainer:train_loop:182 - Epoch: [3/ 100] | Train loss: [0.6045237061977387]
2023-06-08 03:17:40.046 | INFO     | trainer:train_loop:182 - Epoch: [4/ 100] | Train loss: [0.4771406372785568]
2023-06-08 03:22:58.475 | INFO     | trainer:train_loop:182 - Epoch: [5/ 100] | Train loss: [0.35896461641788485]
2023-06-08 03:28:19.004 | INFO     | trainer:train_loop:182 - Epoch: [6/ 100] | Train loss: [0.321166691839695]
2023-06-08 03:33:39.008 | INFO     | trainer:train_loop:182 - Epoch: [7/ 100] | Train loss: [0.29124919581413267]
2023-06-08 03:38:58.438 | INFO     | trainer:train_loop:182 - Epoch: [8/ 100] | Train loss: [0.2641829419732094]
2023-06-08 03:44:15.385 | INFO     | trainer:train_loop:182 - Epoch: [9/ 100] | Train loss: [0.24910028064250947]
2023-06-08 03:49:34.837 | INFO     | trainer:train_loop:182 - Epoch: [10/ 100] | Train loss: [0.2324591082930565]
2023-06-08 03:54:56.116 | INFO     | trainer:train_loop:182 - Epoch: [11/ 100] | Train loss: [0.21627104324102403]
2023-06-08 04:00:17.756 | INFO     | trainer:train_loop:182 - Epoch: [12/ 100] | Train loss: [0.2060031753182411]
2023-06-08 04:05:38.259 | INFO     | trainer:train_loop:182 - Epoch: [13/ 100] | Train loss: [0.18444490265846253]
2023-06-08 04:10:55.581 | INFO     | trainer:train_loop:182 - Epoch: [14/ 100] | Train loss: [0.17555865973234178]
2023-06-08 04:16:15.709 | INFO     | trainer:train_loop:182 - Epoch: [15/ 100] | Train loss: [0.1741911461353302]
2023-06-08 04:21:36.845 | INFO     | trainer:train_loop:182 - Epoch: [16/ 100] | Train loss: [0.16355757588148118]
2023-06-08 04:26:56.394 | INFO     | trainer:train_loop:182 - Epoch: [17/ 100] | Train loss: [0.16542705929279328]
2023-06-08 04:32:17.115 | INFO     | trainer:train_loop:182 - Epoch: [18/ 100] | Train loss: [0.1489662043750286]
2023-06-08 04:37:37.126 | INFO     | trainer:train_loop:182 - Epoch: [19/ 100] | Train loss: [0.15168469870090484]
2023-06-08 04:42:58.389 | INFO     | trainer:train_loop:182 - Epoch: [20/ 100] | Train loss: [0.17493402126431465]
2023-06-08 04:48:19.761 | INFO     | trainer:train_loop:182 - Epoch: [21/ 100] | Train loss: [0.15227849385142325]
2023-06-08 04:53:40.177 | INFO     | trainer:train_loop:182 - Epoch: [22/ 100] | Train loss: [0.11499424558877945]
2023-06-08 04:58:59.823 | INFO     | trainer:train_loop:182 - Epoch: [23/ 100] | Train loss: [0.11326670795679092]
2023-06-08 05:04:22.056 | INFO     | trainer:train_loop:182 - Epoch: [24/ 100] | Train loss: [0.10578965446352959]
2023-06-08 05:09:43.171 | INFO     | trainer:train_loop:182 - Epoch: [25/ 100] | Train loss: [0.09722989466786384]
2023-06-08 05:15:02.452 | INFO     | trainer:train_loop:182 - Epoch: [26/ 100] | Train loss: [0.10104700687527657]
2023-06-08 05:20:23.818 | INFO     | trainer:train_loop:182 - Epoch: [27/ 100] | Train loss: [0.09792498844861984]
2023-06-08 05:25:42.322 | INFO     | trainer:train_loop:182 - Epoch: [28/ 100] | Train loss: [0.10104358938336372]
2023-06-08 05:31:02.150 | INFO     | trainer:train_loop:182 - Epoch: [29/ 100] | Train loss: [0.11969403073191642]
2023-06-08 05:36:25.459 | INFO     | trainer:train_loop:182 - Epoch: [30/ 100] | Train loss: [0.09443893358111381]
2023-06-08 05:41:46.263 | INFO     | trainer:train_loop:182 - Epoch: [31/ 100] | Train loss: [0.084693349391222]
2023-06-08 05:47:08.406 | INFO     | trainer:train_loop:182 - Epoch: [32/ 100] | Train loss: [0.09364374278485775]
2023-06-08 05:52:28.750 | INFO     | trainer:train_loop:182 - Epoch: [33/ 100] | Train loss: [0.1003587352335453]
2023-06-08 05:57:47.536 | INFO     | trainer:train_loop:182 - Epoch: [34/ 100] | Train loss: [0.09473261496424674]
2023-06-08 06:03:06.956 | INFO     | trainer:train_loop:182 - Epoch: [35/ 100] | Train loss: [0.08671699774265289]
2023-06-08 06:08:26.563 | INFO     | trainer:train_loop:182 - Epoch: [36/ 100] | Train loss: [0.10601789066195488]
2023-06-08 06:13:47.225 | INFO     | trainer:train_loop:182 - Epoch: [37/ 100] | Train loss: [0.08825688940286637]
2023-06-08 06:19:07.464 | INFO     | trainer:train_loop:182 - Epoch: [38/ 100] | Train loss: [0.08574521428346633]
2023-06-08 06:24:29.738 | INFO     | trainer:train_loop:182 - Epoch: [39/ 100] | Train loss: [0.08409047661721707]
2023-06-08 06:29:48.966 | INFO     | trainer:train_loop:182 - Epoch: [40/ 100] | Train loss: [0.09516450537741185]
2023-06-08 06:35:11.330 | INFO     | trainer:train_loop:182 - Epoch: [41/ 100] | Train loss: [0.08213424964249134]
2023-06-08 06:40:36.204 | INFO     | trainer:train_loop:182 - Epoch: [42/ 100] | Train loss: [0.08185510951280593]
2023-06-08 06:45:57.937 | INFO     | trainer:train_loop:182 - Epoch: [43/ 100] | Train loss: [0.08393491795659065]
2023-06-08 06:51:18.274 | INFO     | trainer:train_loop:182 - Epoch: [44/ 100] | Train loss: [0.0683714267462492]
2023-06-08 06:56:39.579 | INFO     | trainer:train_loop:182 - Epoch: [45/ 100] | Train loss: [0.0723825835287571]
2023-06-08 07:02:01.114 | INFO     | trainer:train_loop:182 - Epoch: [46/ 100] | Train loss: [0.06793060240149498]
2023-06-08 07:07:23.542 | INFO     | trainer:train_loop:182 - Epoch: [47/ 100] | Train loss: [0.06518639761209488]
2023-06-08 07:12:44.947 | INFO     | trainer:train_loop:182 - Epoch: [48/ 100] | Train loss: [0.06288644248247147]
2023-06-08 07:18:03.940 | INFO     | trainer:train_loop:182 - Epoch: [49/ 100] | Train loss: [0.060937492534518245]
2023-06-08 07:23:25.575 | INFO     | trainer:train_loop:182 - Epoch: [50/ 100] | Train loss: [0.05729940335452557]
2023-06-08 07:28:47.078 | INFO     | trainer:train_loop:182 - Epoch: [51/ 100] | Train loss: [0.05868105255067348]
2023-06-08 07:34:07.555 | INFO     | trainer:train_loop:182 - Epoch: [52/ 100] | Train loss: [0.05761539424955845]
2023-06-08 07:39:30.007 | INFO     | trainer:train_loop:182 - Epoch: [53/ 100] | Train loss: [0.06492331504821777]
2023-06-08 07:44:51.758 | INFO     | trainer:train_loop:182 - Epoch: [54/ 100] | Train loss: [0.06525346386432648]
2023-06-08 07:50:14.200 | INFO     | trainer:train_loop:182 - Epoch: [55/ 100] | Train loss: [0.05857164081931114]
2023-06-08 07:55:34.175 | INFO     | trainer:train_loop:182 - Epoch: [56/ 100] | Train loss: [0.056455711647868154]
2023-06-08 08:00:54.783 | INFO     | trainer:train_loop:182 - Epoch: [57/ 100] | Train loss: [0.05395237851142883]
2023-06-08 08:06:15.962 | INFO     | trainer:train_loop:182 - Epoch: [58/ 100] | Train loss: [0.053212889552116394]
2023-06-08 08:11:37.963 | INFO     | trainer:train_loop:182 - Epoch: [59/ 100] | Train loss: [0.05161363145709038]
2023-06-08 08:16:58.254 | INFO     | trainer:train_loop:182 - Epoch: [60/ 100] | Train loss: [0.053604973778128624]
2023-06-08 08:22:19.251 | INFO     | trainer:train_loop:182 - Epoch: [61/ 100] | Train loss: [0.05303785765171051]
2023-06-08 08:27:38.942 | INFO     | trainer:train_loop:182 - Epoch: [62/ 100] | Train loss: [0.05398735882341862]
2023-06-08 08:32:59.478 | INFO     | trainer:train_loop:182 - Epoch: [63/ 100] | Train loss: [0.0496603534668684]
2023-06-08 08:38:21.828 | INFO     | trainer:train_loop:182 - Epoch: [64/ 100] | Train loss: [0.05389605854451656]
2023-06-08 08:43:41.616 | INFO     | trainer:train_loop:182 - Epoch: [65/ 100] | Train loss: [0.046688987240195275]
2023-06-08 08:49:02.804 | INFO     | trainer:train_loop:182 - Epoch: [66/ 100] | Train loss: [0.053617226794362066]
2023-06-08 08:54:20.799 | INFO     | trainer:train_loop:182 - Epoch: [67/ 100] | Train loss: [0.047271170809864996]
2023-06-08 08:59:42.289 | INFO     | trainer:train_loop:182 - Epoch: [68/ 100] | Train loss: [0.048002391546964646]
2023-06-08 09:05:04.107 | INFO     | trainer:train_loop:182 - Epoch: [69/ 100] | Train loss: [0.04679822698235512]
2023-06-08 09:10:24.386 | INFO     | trainer:train_loop:182 - Epoch: [70/ 100] | Train loss: [0.04556331530213356]
2023-06-08 09:15:46.362 | INFO     | trainer:train_loop:182 - Epoch: [71/ 100] | Train loss: [0.04656876645982266]
2023-06-08 09:21:05.102 | INFO     | trainer:train_loop:182 - Epoch: [72/ 100] | Train loss: [0.045556489795446395]
2023-06-08 09:26:25.468 | INFO     | trainer:train_loop:182 - Epoch: [73/ 100] | Train loss: [0.0443031604886055]
2023-06-08 09:31:46.900 | INFO     | trainer:train_loop:182 - Epoch: [74/ 100] | Train loss: [0.04389215277135372]
2023-06-08 09:37:07.210 | INFO     | trainer:train_loop:182 - Epoch: [75/ 100] | Train loss: [0.042542498230934145]
2023-06-08 09:42:30.451 | INFO     | trainer:train_loop:182 - Epoch: [76/ 100] | Train loss: [0.042459522604942325]
2023-06-08 09:47:51.127 | INFO     | trainer:train_loop:182 - Epoch: [77/ 100] | Train loss: [0.0435713492333889]
2023-06-08 09:53:12.941 | INFO     | trainer:train_loop:182 - Epoch: [78/ 100] | Train loss: [0.041838466763496396]
2023-06-08 09:58:32.160 | INFO     | trainer:train_loop:182 - Epoch: [79/ 100] | Train loss: [0.04271226853132248]
2023-06-08 10:03:55.456 | INFO     | trainer:train_loop:182 - Epoch: [80/ 100] | Train loss: [0.041298853024840355]
2023-06-08 10:09:16.427 | INFO     | trainer:train_loop:182 - Epoch: [81/ 100] | Train loss: [0.04582032795250416]
2023-06-08 10:14:35.641 | INFO     | trainer:train_loop:182 - Epoch: [82/ 100] | Train loss: [0.04263747079670429]
2023-06-08 10:19:57.034 | INFO     | trainer:train_loop:182 - Epoch: [83/ 100] | Train loss: [0.04084657515585423]
2023-06-08 10:25:16.723 | INFO     | trainer:train_loop:182 - Epoch: [84/ 100] | Train loss: [0.04203746324777603]
2023-06-08 10:30:38.029 | INFO     | trainer:train_loop:182 - Epoch: [85/ 100] | Train loss: [0.04115482103824616]
2023-06-08 10:36:00.052 | INFO     | trainer:train_loop:182 - Epoch: [86/ 100] | Train loss: [0.042937438011169435]
2023-06-08 10:41:22.931 | INFO     | trainer:train_loop:182 - Epoch: [87/ 100] | Train loss: [0.04197585693001747]
2023-06-08 10:46:41.529 | INFO     | trainer:train_loop:182 - Epoch: [88/ 100] | Train loss: [0.04082126395404339]
2023-06-08 10:52:02.525 | INFO     | trainer:train_loop:182 - Epoch: [89/ 100] | Train loss: [0.04048154228925705]
2023-06-08 10:57:22.029 | INFO     | trainer:train_loop:182 - Epoch: [90/ 100] | Train loss: [0.039744548171758654]
2023-06-08 11:02:42.279 | INFO     | trainer:train_loop:182 - Epoch: [91/ 100] | Train loss: [0.0394948533475399]
2023-06-08 11:08:06.289 | INFO     | trainer:train_loop:182 - Epoch: [92/ 100] | Train loss: [0.039118828609585765]
2023-06-08 11:13:30.251 | INFO     | trainer:train_loop:182 - Epoch: [93/ 100] | Train loss: [0.040517792716622356]
2023-06-08 11:18:52.414 | INFO     | trainer:train_loop:182 - Epoch: [94/ 100] | Train loss: [0.0384232040643692]
2023-06-08 11:24:14.415 | INFO     | trainer:train_loop:182 - Epoch: [95/ 100] | Train loss: [0.03935464711487293]
2023-06-08 11:29:33.811 | INFO     | trainer:train_loop:182 - Epoch: [96/ 100] | Train loss: [0.03850191774964332]
2023-06-08 11:34:55.372 | INFO     | trainer:train_loop:182 - Epoch: [97/ 100] | Train loss: [0.038457817494869234]
2023-06-08 11:40:13.944 | INFO     | trainer:train_loop:182 - Epoch: [98/ 100] | Train loss: [0.03874203805625439]
2023-06-08 11:45:30.869 | INFO     | trainer:train_loop:182 - Epoch: [99/ 100] | Train loss: [0.03890174940228462]
2023-06-08 11:50:50.085 | INFO     | trainer:train_loop:182 - Epoch: [100/ 100] | Train loss: [0.03951229339838028]
2023-06-08 11:50:50.975 | INFO     | trainer:train_loop:203 - [Saving Snapshot:]/root/neo_code_reco_mb/configs/checkpoint0606/MiT-B3-FaPNHead_100.pth
2023-06-08 11:50:50.976 | INFO     | trainer:train_loop:212 - Training cost: 32063.299915008247seconds
