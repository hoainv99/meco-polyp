2022-09-13 13:30:48.593 | INFO     | __main__:main:57 - Load config from configs/neo_small.yaml
2022-09-13 13:30:48.593 | INFO     | __main__:main:58 - {'dataset': {'data_path': '/home/s/hungpv/polyps/dataset', 'train_data_path': ['/home/s/hungpv/polyps/dataset/neo_small/train'], 'test_data_path': ['/home/s/hungpv/polyps/dataset/neo_small/test'], 'val_data_path': ['/home/s/hungpv/polyps/dataset/neo_small/test']}, 'model': {'num_classes': 3, 'save_dir': '/home/s/hungpv/polyps/checkpoint/neo/neo_small_v2', 'backbone': 'MiT-B3', 'head': 'FaPNHead', 'pretrained': '/home/s/hungpv/polyps/pretrained_models/mit_b3.pth'}, 'optimizer': {'name': 'adam', 'lr': 0.0001, 'clip': 0.5, 'scheduler': 'cosine_warmup', 'loss': 'multi_structure_loss'}, 'dev': 'cuda', 'train': {'start_from': 0, 'save_from': 59, 'num_epochs': 60, 'num_warmup_epoch': 4, 'is_val': False, 'size_rates': [0.75, 1, 1.25], 'dataloader': {'batchsize': 16, 'img_size': 384, 'shuffle': True, 'num_workers': 4, 'pin_memory': True, 'drop_last': True}, 'amp': False, 'ddp': False, 'augment': {'prob': 1, 'Flip_prob': 0.5, 'HueSaturationValue_prob': 0.5, 'RandomBrightnessContrast_prob': 0.5, 'crop_prob': 0.0, 'randomrotate90_prob': 0.5, 'ColorJitter_prob': 0.5}}, 'val': {'dataloader': {'batchsize': 8, 'img_size': 384, 'shuffle': True, 'num_workers': 4, 'pin_memory': True, 'drop_last': False}}, 'test': {'dev': 'cuda', 'visualize': True, 'visualize_dir': '/home/s/hungpv/polyps/neo_visualize', 'vis_x': 180, 'vis_overwrite': False, 'checkpoint_dir': '/home/s/hungpv/polyps/checkpoint/neo/neo_small_v2/MiT-B3-FaPNHead_60.pth', 'dataloader': {'batchsize': 1, 'img_size': 384, 'shuffle': True, 'num_workers': 4, 'pin_memory': True, 'drop_last': False}, 'augment': {'prob': 1, 'Flip_prob': 0, 'HueSaturationValue_prob': 0, 'RandomBrightnessContrast_prob': 0, 'crop_prob': 0, 'randomrotate90_prob': 0, 'elastictransform_prob': 0, 'gridistortion_prob': 0, 'opticaldistortion_prob': 0, 'verticalflip_prob': 0, 'horizontalflip_prob': 0, 'randomgamma_prob': 0, 'CoarseDropout_prob': 0, 'RGBShift_prob': 0, 'MotionBlur_prob': 0, 'MedianBlur_prob': 0, 'GaussianBlur_prob': 0, 'GaussNoise_prob': 0, 'ChannelShuffle_prob': 0}}}
2022-09-13 13:30:48.593 | INFO     | __main__:main:59 - Getting datapath
2022-09-13 13:30:48.598 | INFO     | __main__:main:74 - There are 1000 images to train
2022-09-13 13:30:48.600 | INFO     | __main__:main:93 - Train model with no valid dataset
2022-09-13 13:30:48.600 | INFO     | __main__:main:95 - Loading data
2022-09-13 13:30:48.687 | INFO     | __main__:main:109 - 62 batches to train
2022-09-13 13:30:48.687 | INFO     | __main__:main:122 - Loading model
2022-09-13 13:30:48.687 | INFO     | __main__:main:143 - Loading checkpoint from /home/s/hungpv/polyps/pretrained_models/mit_b3.pth ...
2022-09-13 13:30:52.123 | INFO     | __main__:main:187 - Training with FP32 ...
2022-09-13 13:32:24.765 | INFO     | tools.trainer:train_loop:126 - Epoch: [1/ 60] | Train loss: [2.2407389667726334]
2022-09-13 13:33:56.061 | INFO     | tools.trainer:train_loop:126 - Epoch: [2/ 60] | Train loss: [1.0150735868561653]
2022-09-13 13:35:27.476 | INFO     | tools.trainer:train_loop:126 - Epoch: [3/ 60] | Train loss: [0.7128570647008957]
2022-09-13 13:36:59.052 | INFO     | tools.trainer:train_loop:126 - Epoch: [4/ 60] | Train loss: [0.6027138800390305]
2022-09-13 13:38:31.540 | INFO     | tools.trainer:train_loop:126 - Epoch: [5/ 60] | Train loss: [0.5458803580653283]
2022-09-13 13:40:03.196 | INFO     | tools.trainer:train_loop:126 - Epoch: [6/ 60] | Train loss: [0.5172889886363861]
2022-09-13 13:41:36.031 | INFO     | tools.trainer:train_loop:126 - Epoch: [7/ 60] | Train loss: [0.4065348186319874]
2022-09-13 13:43:07.913 | INFO     | tools.trainer:train_loop:126 - Epoch: [8/ 60] | Train loss: [0.3193810707138431]
2022-09-13 13:44:41.335 | INFO     | tools.trainer:train_loop:126 - Epoch: [9/ 60] | Train loss: [0.3118761443803387]
2022-09-13 13:46:14.731 | INFO     | tools.trainer:train_loop:126 - Epoch: [10/ 60] | Train loss: [0.2677691525989963]
2022-09-13 13:47:46.770 | INFO     | tools.trainer:train_loop:126 - Epoch: [11/ 60] | Train loss: [0.26136023935771757]
2022-09-13 13:49:19.328 | INFO     | tools.trainer:train_loop:126 - Epoch: [12/ 60] | Train loss: [0.2337011043583193]
2022-09-13 13:50:52.997 | INFO     | tools.trainer:train_loop:126 - Epoch: [13/ 60] | Train loss: [0.24295834079384804]
2022-09-13 13:52:24.806 | INFO     | tools.trainer:train_loop:126 - Epoch: [14/ 60] | Train loss: [0.23350095700833104]
2022-09-13 13:53:57.695 | INFO     | tools.trainer:train_loop:126 - Epoch: [15/ 60] | Train loss: [0.2222124089396769]
2022-09-13 13:55:30.745 | INFO     | tools.trainer:train_loop:126 - Epoch: [16/ 60] | Train loss: [0.20220486759658782]
2022-09-13 13:57:02.559 | INFO     | tools.trainer:train_loop:126 - Epoch: [17/ 60] | Train loss: [0.1912491392464407]
2022-09-13 13:58:36.471 | INFO     | tools.trainer:train_loop:126 - Epoch: [18/ 60] | Train loss: [0.21936907366879524]
2022-09-13 14:00:08.650 | INFO     | tools.trainer:train_loop:126 - Epoch: [19/ 60] | Train loss: [0.21385630784976867]
2022-09-13 14:01:41.155 | INFO     | tools.trainer:train_loop:126 - Epoch: [20/ 60] | Train loss: [0.2039597671358816]
2022-09-13 14:03:13.156 | INFO     | tools.trainer:train_loop:126 - Epoch: [21/ 60] | Train loss: [0.16713059327054408]
2022-09-13 14:04:45.465 | INFO     | tools.trainer:train_loop:126 - Epoch: [22/ 60] | Train loss: [0.1773930520059601]
2022-09-13 14:06:17.193 | INFO     | tools.trainer:train_loop:126 - Epoch: [23/ 60] | Train loss: [0.1729496459086095]
2022-09-13 14:07:49.683 | INFO     | tools.trainer:train_loop:126 - Epoch: [24/ 60] | Train loss: [0.16771914088918316]
2022-09-13 14:09:21.556 | INFO     | tools.trainer:train_loop:126 - Epoch: [25/ 60] | Train loss: [0.15684404404413316]
2022-09-13 14:10:53.759 | INFO     | tools.trainer:train_loop:126 - Epoch: [26/ 60] | Train loss: [0.15753411255296199]
2022-09-13 14:12:26.170 | INFO     | tools.trainer:train_loop:126 - Epoch: [27/ 60] | Train loss: [0.15907812515093434]
2022-09-13 14:13:58.272 | INFO     | tools.trainer:train_loop:126 - Epoch: [28/ 60] | Train loss: [0.13688207922443266]
2022-09-13 14:15:31.319 | INFO     | tools.trainer:train_loop:126 - Epoch: [29/ 60] | Train loss: [0.13592284449165867]
2022-09-13 14:17:03.466 | INFO     | tools.trainer:train_loop:126 - Epoch: [30/ 60] | Train loss: [0.1252792201215221]
2022-09-13 14:18:35.210 | INFO     | tools.trainer:train_loop:126 - Epoch: [31/ 60] | Train loss: [0.15357564786268818]
2022-09-13 14:20:07.533 | INFO     | tools.trainer:train_loop:126 - Epoch: [32/ 60] | Train loss: [0.133911163275761]
2022-09-13 14:21:39.855 | INFO     | tools.trainer:train_loop:126 - Epoch: [33/ 60] | Train loss: [0.13475792704811018]
2022-09-13 14:23:12.031 | INFO     | tools.trainer:train_loop:126 - Epoch: [34/ 60] | Train loss: [0.1272744579060424]
2022-09-13 14:24:44.037 | INFO     | tools.trainer:train_loop:126 - Epoch: [35/ 60] | Train loss: [0.13202647846792975]
2022-09-13 14:26:17.393 | INFO     | tools.trainer:train_loop:126 - Epoch: [36/ 60] | Train loss: [0.10908360412764934]
2022-09-13 14:27:48.965 | INFO     | tools.trainer:train_loop:126 - Epoch: [37/ 60] | Train loss: [0.1095405226393092]
2022-09-13 14:29:21.781 | INFO     | tools.trainer:train_loop:126 - Epoch: [38/ 60] | Train loss: [0.11088193442311979]
2022-09-13 14:30:54.347 | INFO     | tools.trainer:train_loop:126 - Epoch: [39/ 60] | Train loss: [0.09529458016397492]
2022-09-13 14:32:26.319 | INFO     | tools.trainer:train_loop:126 - Epoch: [40/ 60] | Train loss: [0.09916080678662946]
2022-09-13 14:33:58.963 | INFO     | tools.trainer:train_loop:126 - Epoch: [41/ 60] | Train loss: [0.09324367849096175]
2022-09-13 14:35:30.980 | INFO     | tools.trainer:train_loop:126 - Epoch: [42/ 60] | Train loss: [0.09464629000473407]
2022-09-13 14:37:04.331 | INFO     | tools.trainer:train_loop:126 - Epoch: [43/ 60] | Train loss: [0.0867781663133252]
2022-09-13 14:38:35.819 | INFO     | tools.trainer:train_loop:126 - Epoch: [44/ 60] | Train loss: [0.09513661833179574]
2022-09-13 14:40:09.438 | INFO     | tools.trainer:train_loop:126 - Epoch: [45/ 60] | Train loss: [0.08625969681287965]
2022-09-13 14:41:41.329 | INFO     | tools.trainer:train_loop:126 - Epoch: [46/ 60] | Train loss: [0.08670091887395229]
2022-09-13 14:43:13.391 | INFO     | tools.trainer:train_loop:126 - Epoch: [47/ 60] | Train loss: [0.08517735619698802]
2022-09-13 14:44:45.866 | INFO     | tools.trainer:train_loop:126 - Epoch: [48/ 60] | Train loss: [0.08021201613929964]
2022-09-13 14:46:18.580 | INFO     | tools.trainer:train_loop:126 - Epoch: [49/ 60] | Train loss: [0.07623767269955527]
2022-09-13 14:47:51.031 | INFO     | tools.trainer:train_loop:126 - Epoch: [50/ 60] | Train loss: [0.07411610028676448]
2022-09-13 14:49:23.408 | INFO     | tools.trainer:train_loop:126 - Epoch: [51/ 60] | Train loss: [0.07235795896380179]
2022-09-13 14:50:56.532 | INFO     | tools.trainer:train_loop:126 - Epoch: [52/ 60] | Train loss: [0.07535182113849348]
2022-09-13 14:52:28.666 | INFO     | tools.trainer:train_loop:126 - Epoch: [53/ 60] | Train loss: [0.06961489721171317]
2022-09-13 14:54:01.720 | INFO     | tools.trainer:train_loop:126 - Epoch: [54/ 60] | Train loss: [0.07227622002603547]
2022-09-13 14:55:33.588 | INFO     | tools.trainer:train_loop:126 - Epoch: [55/ 60] | Train loss: [0.0704475199623454]
2022-09-13 14:57:06.210 | INFO     | tools.trainer:train_loop:126 - Epoch: [56/ 60] | Train loss: [0.07122609878499661]
2022-09-13 14:58:39.016 | INFO     | tools.trainer:train_loop:126 - Epoch: [57/ 60] | Train loss: [0.06519575194726067]
2022-09-13 15:00:10.582 | INFO     | tools.trainer:train_loop:126 - Epoch: [58/ 60] | Train loss: [0.0688667735385318]
2022-09-13 15:01:43.189 | INFO     | tools.trainer:train_loop:126 - Epoch: [59/ 60] | Train loss: [0.0638247151829062]
2022-09-13 15:03:15.307 | INFO     | tools.trainer:train_loop:126 - Epoch: [60/ 60] | Train loss: [0.06672549307827026]
2022-09-13 15:03:15.765 | INFO     | tools.trainer:train_loop:138 - [Saving Snapshot:]/home/s/hungpv/polyps/checkpoint/neo/neo_small_v2/MiT-B3-FaPNHead_60.pth
2022-09-13 15:03:15.765 | INFO     | tools.trainer:train_loop:147 - Training cost: 5542.64458901016seconds
